================================================================================
[001] RAIDの構築と運用 - 01 (RAID-0)
[002] RAIDの構築と運用 - 02 (RAID-1)
[003] RAIDの構築と運用 - 03 (RAID-4)
[004] RAIDの構築と運用 - 04 (RAID-5)
[005] RAIDの構築と運用 - 05
[006] RAIDの構築と運用 - 06
[007] LVMの調査
[008] LVMの作成
[009] LVMの管理 - 01 (ボリュームグループの拡張・縮小)
[010] LVMの管理 - 02 (論理ボリュームの拡張・縮小)
[011] LVMの管理 - 03 (スナップショット)
[012] ハードディスクの管理
[013] SSD
[014] iSCSI
================================================================================
[001]
  RAIDの構築と運用 - 01 (RAID-0)
  
[内容]
  ## 作業内容
    RAIDアレイ(RAID-0)の作成後にマウントする
  
  ## コマンド(mdadm) - 01
    mdadm --create(-C) XX                        : RAIDアレイ(XX)を作成
    mdadm --create(-C) XX --auto(-a)             : RAIDアレイ(XX)を作成、デバイスファイル自動作成
    mdadm --create(-C) XX --chunk(-c) YY         : RAIDアレイ(XX)を作成、チャンクサイズ(YY)
    mdadm --create(-C) XX --level(-l) YY         : RAIDアレイ(XX)を作成、RAIDレベル(YY)
    mdadm --create(-C) XX --raid-devices(-n) YY  : RAIDアレイ(XX)を作成、RAIDデバイス数(YY)
    mdadm --create(-C) XX --spare-devices(-x) YY : RAIDアレイ(XX)を作成、スペアデバイス数(YY)
  
  ## コマンド(mdadm) - 02
    mdadm --manage XX                 : RAIDアレイ(XX)をメンテ
    mdadm --manage XX --add(-a) YY    : RAIDアレイ(XX)をメンテ、デバイス(YY)を追加
    mdadm --manage XX --remove(-r) YY : RAIDアレイ(XX)をメンテ、デバイス(YY)を削除
    mdadm --manage XX --fail(-f) YY   : RAIDアレイ(XX)をメンテ、デバイス(YY)に不良マーク
  
  ## コマンド(mdadm) - 03
    mdadm --misc XX               : RAIDアレイ(XX)を問合せ
    mdadm --misc --query(-Q) XX   : RAIDアレイ(XX)を問合せ、RAIDアレイ(XX)を状態を表示
    mdadm --misc --detail(-D) XX  : RAIDアレイ(XX)を問合せ、RAIDアレイ(XX)を状態を表示
    mdadm --misc --examine(-E) XX : RAIDアレイ(XX)を問合せ、構成デバイスの状態を表示
    mdadm --misc --readonly XX    : RAIDアレイ(XX)を読み取り専用にする
    mdadm --misc --readwrite XX   : RAIDアレイ(XX)を書き込み可能にする
    mdadm --misc --stop XX        : RAIDアレイ(XX)を停止する
    mdadm --misc --stop --scan XX : RAIDアレイを停止する
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Wed Jun  7 12:29:59 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ dd if=/dev/zero of=image0.img bs=10M count=10
    vm11$ dd if=/dev/zero of=image1.img bs=10M count=10
    
    コマンドの実行結果
    --------------------------------------------------
    // image0.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.415416 s, 252 MB/s
    
    // image1.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.451671 s, 232 MB/s
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup /dev/loop0 image0.img
    vm11$ sudo losetup /dev/loop1 image1.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mdadm             // アレイ作成
        > --create /dev/md0      // アレイ名
        > --level 0              // レベル
        > --raid-devices 2       // デバイス数
        > /dev/loop0 /dev/loop1  // デバイス名
    
    コマンドの実行結果
    --------------------------------------------------
    mdadm: Defaulting to version 1.2 metadata
    mdadm: array /dev/md0 started.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ cat /proc/mdstat -> アレイ確認
    
    コマンドの実行結果
    --------------------------------------------------
    Personalities : [raid0] 
    md0 : active raid0 loop1[1] loop0[0]
          200704 blocks super 1.2 512k chunks      
    unused devices: <none>
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkfs -t xfs /dev/md0
    
    コマンドの実行結果
    --------------------------------------------------
    (省略)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mount -o defaults /dev/md0 /mnt
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo umount /mnt
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mdadm (--misc) --stop /dev/md0 -> アレイ停止
    
    コマンドの実行結果
    --------------------------------------------------
    mdadm: stopped /dev/md0
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup -D
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ rm -f image[0-1].img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[002]
  RAIDの構築と運用 - 02 (RAID-1)
  
[内容]
  ## 作業内容
    RAIDアレイ(RAID-1)の作成後にマウントする
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Wed Jun  7 12:33:47 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ dd if=/dev/zero of=image0.img bs=10M count=10
    vm11$ dd if=/dev/zero of=image1.img bs=10M count=10
    
    コマンドの実行結果
    --------------------------------------------------
    // image0.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.138058 s, 760 MB/s
    
    // image1.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.286048 s, 367 MB/s
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup /dev/loop0 image0.img
    vm11$ sudo losetup /dev/loop1 image1.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mdadm             // アレイ作成
        > --create /dev/md0      // アレイ名
        > --level 1              // レベル
        > --raid-devices 2       // デバイス数
        > /dev/loop0 /dev/loop1  // デバイス名
    
    コマンドの実行結果
    --------------------------------------------------
    mdadm: Defaulting to version 1.2 metadata
    mdadm: array /dev/md0 started.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ cat /proc/mdstat -> アレイ確認
    
    コマンドの実行結果
    --------------------------------------------------
    Personalities : [raid0] [raid1] 
    md0 : active raid1 loop1[1] loop0[0]
          101376 blocks super 1.2 [2/2] [UU]
    unused devices: <none>
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkfs -t xfs /dev/md0
    
    コマンドの実行結果
    --------------------------------------------------
    (省略)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mount -o defaults /dev/md0 /mnt
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo umount /mnt
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mdadm (--misc) --stop /dev/md0 -> アレイ停止
    
    コマンドの実行結果
    --------------------------------------------------
    mdadm: stopped /dev/md0
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup -D
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ rm -f image[0-1].img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[003]
  RAIDの構築と運用 - 03 (RAID-4)
  
[内容]
  ## 作業内容
    RAIDアレイ(RAID-4)の作成後にマウントする
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Wed Jun  7 14:01:25 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ dd if=/dev/zero of=image0.img bs=10M count=10
    vm11$ dd if=/dev/zero of=image1.img bs=10M count=10
    vm11$ dd if=/dev/zero of=image2.img bs=10M count=10
    
    コマンドの実行結果
    --------------------------------------------------
    // image0.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.12755 s, 822 MB/s
    
    // image1.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.442624 s, 237 MB/s
    
    // image2.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.635922 s, 165 MB/s
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup /dev/loop0 image0.img
    vm11$ sudo losetup /dev/loop1 image1.img
    vm11$ sudo losetup /dev/loop2 image2.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mdadm                        // アレイ作成
        > --create /dev/md0                 // アレイ名
        > --level 4                         // レベル
        > --raid-devices 3                  // デバイス数
        > /dev/loop0 /dev/loop1 /dev/loop2  // デバイス名
    
    コマンドの実行結果
    --------------------------------------------------
    mdadm: Defaulting to version 1.2 metadata
    mdadm: array /dev/md0 started.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ cat /proc/mdstat -> アレイ確認
    
    コマンドの実行結果
    --------------------------------------------------
    Personalities : [raid0] [raid1] [raid6] [raid5] [raid4] 
    md0 : active raid4 loop2[3] loop1[1] loop0[0]
          200704 blocks super 1.2 level 4, 512k chunk, algorithm 0 [3/3] [UUU]      
    unused devices: <none>
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkfs -t xfs /dev/md0
    
    コマンドの実行結果
    --------------------------------------------------
    (省略)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mount -o defaults /dev/md0 /mnt
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo umount /mnt
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mdadm (--misc) --stop /dev/md0 -> アレイ停止
    
    コマンドの実行結果
    --------------------------------------------------
    mdadm: stopped /dev/md0
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup -D
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ rm -f image[0-2].img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[004]
  RAIDの構築と運用 - 04 (RAID-5)
  
[内容]
  ## 作業内容
    RAIDアレイ(RAID-5)の作成後にマウントする
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Wed Jun  7 18:08:30 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ dd if=/dev/zero of=image0.img bs=10M count=10
    vm11$ dd if=/dev/zero of=image1.img bs=10M count=10
    vm11$ dd if=/dev/zero of=image2.img bs=10M count=10
    
    コマンドの実行結果
    --------------------------------------------------
    // image0.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.126731 s, 827 MB/s
    
    // image1.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.119279 s, 879 MB/s
    
    // image2.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.151261 s, 693 MB/s
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup /dev/loop0 image0.img
    vm11$ sudo losetup /dev/loop1 image1.img
    vm11$ sudo losetup /dev/loop2 image2.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mdadm                        // アレイ作成
        > --create /dev/md0                 // アレイ名
        > --level 5                         // レベル
        > --raid-devices 3                  // デバイス数
        > /dev/loop0 /dev/loop1 /dev/loop2  // デバイス名
    
    コマンドの実行結果
    --------------------------------------------------
    mdadm: Defaulting to version 1.2 metadata
    mdadm: array /dev/md0 started.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ cat /proc/mdstat -> アレイ確認
    
    コマンドの実行結果
    --------------------------------------------------
    Personalities : [raid0] [raid1] [raid6] [raid5] [raid4] 
    md0 : active raid5 loop2[3] loop1[1] loop0[0]
          200704 blocks super 1.2 level 5, 512k chunk, algorithm 2 [3/3] [UUU]      
    unused devices: <none>
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkfs -t xfs /dev/md0
    
    コマンドの実行結果
    --------------------------------------------------
    (省略)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mount -o defaults /dev/md0 /mnt
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo umount /mnt
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mdadm (--misc) --stop /dev/md0 -> アレイ停止
    
    コマンドの実行結果
    --------------------------------------------------
    mdadm: stopped /dev/md0
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup -D
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ rm -f image[0-2].img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[005]
  RAIDの構築と運用 - 05
  
[内容]
  ## 作業内容
    RAIDアレイ(RAID-5)に対して「--misc」で様々な問合せ
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Wed Jun  7 18:33:35 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ dd if=/dev/zero of=image0.img bs=10M count=10
    vm11$ dd if=/dev/zero of=image1.img bs=10M count=10
    vm11$ dd if=/dev/zero of=image2.img bs=10M count=10
    
    コマンドの実行結果
    --------------------------------------------------
    // image0.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.114007 s, 920 MB/s
    
    // image1.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.119548 s, 877 MB/s
    
    // image2.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.11592 s, 905 MB/s
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup /dev/loop0 image0.img
    vm11$ sudo losetup /dev/loop1 image1.img
    vm11$ sudo losetup /dev/loop2 image2.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mdadm                        // アレイ作成
        > --create /dev/md0                 // アレイ名
        > --level 5                         // レベル
        > --raid-devices 3                  // デバイス数
        > /dev/loop0 /dev/loop1 /dev/loop2  // デバイス名
    
    コマンドの実行結果
    --------------------------------------------------
    mdadm: Defaulting to version 1.2 metadata
    mdadm: array /dev/md0 started.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ cat /proc/mdstat -> アレイ確認
    
    コマンドの実行結果
    --------------------------------------------------
    Personalities : [raid0] [raid1] [raid6] [raid5] [raid4] 
    md0 : active raid5 loop2[3] loop1[1] loop0[0]
          200704 blocks super 1.2 level 5, 512k chunk, algorithm 2 [3/3] [UUU]      
    unused devices: <none>
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mdadm --misc -Q(--query) /dev/md0 -> アレイ状態
    
    コマンドの実行結果
    --------------------------------------------------
    /dev/md0: 196.00MiB raid5 3 devices, 0 spares. Use mdadm --detail for more detail
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mdadm --misc -D(--detail) /dev/md0 -> アレイ詳細
    
    コマンドの実行結果
    --------------------------------------------------
    /dev/md0:
      Version            : 1.2
      Creation Time      : Wed Jun  7 18:56:23 2023
      Raid Level         : raid5
      Array Size         : 200704 (196.00 MiB 205.52 MB)
      Used Dev Size      : 100352 (98.00 MiB 102.76 MB)
      Raid Devices       : 3
      Total Devices      : 3
      Persistence        : Superblock is persistent
      Update Time        : Wed Jun  7 18:56:25 2023
      State              : clean 
      Active Devices     : 3
      Working Devices    : 3
      Failed Devices     : 0
      Spare Devices      : 0
      Layout             : left-symmetric
      Chunk Size         : 512K
      Consistency Policy : resync
      Name               : vm11:0  (local to host vm11)
      UUID               : 66c8cf54:9efa9df9:a1453815:0db187a6
      Events             : 18
      
      Number   Major   Minor   RaidDevice   State
      0        7       0       0            active sync   /dev/loop0
      1        7       1       1            active sync   /dev/loop1
      3        7       2       2            active sync   /dev/loop2
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mdadm --misc -E(--examine) /dev/md0 -> アレイ状態
    
    コマンドの実行結果
    --------------------------------------------------
    mdadm: No md superblock detected on /dev/md0.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mdadm (--misc) --stop /dev/md0 -> アレイ停止
    
    コマンドの実行結果
    --------------------------------------------------
    mdadm: stopped /dev/md0
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup -D
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ rm -f image[0-2].img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[006]
  RAIDの構築と運用 - 06
  
[内容]
  ## 作業内容
    RAIDアレイ(RAID-5)に対して「--manage」で予備デバイス操作
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Wed Jun  7 18:48:59 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ dd if=/dev/zero of=image0.img bs=10M count=10
    vm11$ dd if=/dev/zero of=image1.img bs=10M count=10
    vm11$ dd if=/dev/zero of=image2.img bs=10M count=10
    vm11$ dd if=/dev/zero of=image3.img bs=10M count=10
    vm11$ dd if=/dev/zero of=image4.img bs=10M count=10
    
    コマンドの実行結果
    --------------------------------------------------
    // image0.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.133254 s, 787 MB/s
    
    // image1.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.144073 s, 728 MB/s
    
    // image2.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.127716 s, 821 MB/s
    
    // image3.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.390171 s, 269 MB/s
    
    // image4.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.429531 s, 244 MB/s
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup /dev/loop0 image0.img
    vm11$ sudo losetup /dev/loop1 image1.img
    vm11$ sudo losetup /dev/loop2 image2.img
    vm11$ sudo losetup /dev/loop3 image3.img
    vm11$ sudo losetup /dev/loop4 image4.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mdadm                                   // アレイ作成
        > --create /dev/md0                            // アレイ名
        > --level 5                                    // レベル
        > --raid-devices 3                             // デバイス数
        > --spare-devices 1                            // スペア数
        > /dev/loop0 /dev/loop1 /dev/loop2 /dev/loop3  // デバイス名
    
    コマンドの実行結果
    --------------------------------------------------
    mdadm: Defaulting to version 1.2 metadata
    mdadm: array /dev/md0 started.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ cat /proc/mdstat -> アレイ確認
    
    コマンドの実行結果
    --------------------------------------------------
    Personalities : [raid0] [raid1] [raid6] [raid5] [raid4] 
    md0 : active raid5 loop2[4] loop3[3](S) loop1[1] loop0[0]
          200704 blocks super 1.2 level 5, 512k chunk, algorithm 2 [3/3] [UUU]      
    unused devices: <none>
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mdadm --misc -Q(--query) /dev/md0 -> アレイ状態
    
    コマンドの実行結果
    --------------------------------------------------
    /dev/md0: 196.00MiB raid5 3 devices, 1 spare. Use mdadm --detail for more detail.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mdadm --misc -D(--detail) /dev/md0 -> アレイ詳細
    
    コマンドの実行結果
    --------------------------------------------------
    /dev/md0:
      Version            : 1.2
      Creation Time      : Wed Jun  7 20:05:24 2023
      Raid Level         : raid5
      Array Size         : 200704 (196.00 MiB 205.52 MB)
      Used Dev Size      : 100352 (98.00 MiB 102.76 MB)
      Raid Devices       : 3
      Total Devices      : 4
      Persistence        : Superblock is persistent
      Update Time        : Wed Jun  7 20:05:25 2023
      State              : clean 
      Active Devices     : 3
      Working Devices    : 4
      Failed Devices     : 0
      Spare Devices      : 1
      Layout             : left-symmetric
      Chunk Size         : 512K
      Consistency Policy : resync
      Name               : vm11:0  (local to host vm11)
      UUID               : e948e4a7:4fc31f3a:20b32de6:5fe42c7a
      Events             : 18
      
      Number   Major   Minor   RaidDevice   State
      0        7       0       0            active sync   /dev/loop0
      1        7       1       1            active sync   /dev/loop1
      4        7       2       2            active sync   /dev/loop2
      3        7       3       -            spare         /dev/loop3
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mdadm --manage /dev/md0 -f(--fail) /dev/loop0 -> 不良マーク
    
    コマンドの実行結果
    --------------------------------------------------
    mdadm: set /dev/loop0 faulty in /dev/md0
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mdadm --misc -D(--detail) /dev/md0 -> アレイ詳細
    
    コマンドの実行結果
    --------------------------------------------------
    /dev/md0:
      Version            : 1.2
      Creation Time      : Wed Jun  7 20:05:24 2023
      Raid Level         : raid5
      Array Size         : 200704 (196.00 MiB 205.52 MB)
      Used Dev Size      : 100352 (98.00 MiB 102.76 MB)
      Raid Devices       : 3
      Total Devices      : 4
      Persistence        : Superblock is persistent
      Update Time        : Wed Jun  7 20:22:09 2023
      State              : clean 
      Active Devices     : 3
      Working Devices    : 3
      Failed Devices     : 1
      Spare Devices      : 0
      Layout             : left-symmetric
      Chunk Size         : 512K
      Consistency Policy : resync
      Name               : vm11:0  (local to host vm11)
      UUID               : e948e4a7:4fc31f3a:20b32de6:5fe42c7a
      Events             : 37
      
      Number   Major   Minor   RaidDevice   State
      3        7       3       0            active sync   /dev/loop3  // スペアがアレイに組み込まれる
      1        7       1       1            active sync   /dev/loop1
      4        7       2       2            active sync   /dev/loop2
      0        7       0       -            faulty        /dev/loop0  // 不良マーク
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mdadm --manage /dev/md0 -r(--remove) /dev/loop0 -> 不良デバイス削除
    
    コマンドの実行結果
    --------------------------------------------------
    mdadm: hot removed /dev/loop0 from /dev/md0
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mdadm --misc -D(--detail) /dev/md0 -> アレイ詳細
    
    コマンドの実行結果
    --------------------------------------------------
    /dev/md0:
      Version            : 1.2
      Creation Time      : Wed Jun  7 20:05:24 2023
      Raid Level         : raid5
      Array Size         : 200704 (196.00 MiB 205.52 MB)
      Used Dev Size      : 100352 (98.00 MiB 102.76 MB)
      Raid Devices       : 3
      Total Devices      : 3
      Persistence        : Superblock is persistent
      Update Time        : Wed Jun  7 20:32:22 2023
      State              : clean 
      Active Devices     : 3
      Working Devices    : 3
      Failed Devices     : 0
      Spare Devices      : 0
      Layout             : left-symmetric
      Chunk Size         : 512K
      Consistency Policy : resync
      Name               : vm11:0  (local to host vm11)
      UUID               : e948e4a7:4fc31f3a:20b32de6:5fe42c7a
      Events             : 38
      
      Number   Major   Minor   RaidDevice   State
      3        7       3       0            active sync   /dev/loop3
      1        7       1       1            active sync   /dev/loop1
      4        7       2       2            active sync   /dev/loop2
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mdadm --manage /dev/md0 -a(--add) /dev/loop4 -> デバイス追加
    
    コマンドの実行結果
    --------------------------------------------------
    mdadm: added /dev/loop4
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mdadm --misc -D(--detail) /dev/md0 -> アレイ詳細
    
    コマンドの実行結果
    --------------------------------------------------
    /dev/md0:
      Version            : 1.2
      Creation Time      : Wed Jun  7 20:05:24 2023
      Raid Level         : raid5
      Array Size         : 200704 (196.00 MiB 205.52 MB)
      Used Dev Size      : 100352 (98.00 MiB 102.76 MB)
      Raid Devices       : 3
      Total Devices      : 4
      Persistence        : Superblock is persistent
      Update Time        : Wed Jun  7 20:46:23 2023
      State              : clean 
      Active Devices     : 3
      Working Devices    : 4
      Failed Devices     : 0
      Spare Devices      : 1
      Layout             : left-symmetric
      Chunk Size         : 512K
      Consistency Policy : resync
      Name               : vm11:0  (local to host vm11)
      UUID               : e948e4a7:4fc31f3a:20b32de6:5fe42c7a
      Events             : 39
      
      Number   Major   Minor   RaidDevice   State
      3        7       3       0            active sync   /dev/loop3
      1        7       1       1            active sync   /dev/loop1
      4        7       2       2            active sync   /dev/loop2
      5        7       4       -            spare         /dev/loop4  // 追加デバイス
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mdadm (--misc) --stop /dev/md0 -> アレイ停止
    
    コマンドの実行結果
    --------------------------------------------------
    mdadm: stopped /dev/md0
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup -D
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ rm -f image[0-4].img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[007]
  LVMの調査
  
[内容]
  ## 作業内容
    仮想マシンのLVMについて調査
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Wed Jun  7 20:01:11 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ lsblk
    
    コマンドの実行結果
    --------------------------------------------------
    NAME                    MAJ:MIN  RM  SIZE  RO  TYPE  MOUNTPOINT
    sr0                      11:0     1 1024M   0  rom   
    vda                     252:0     0   30G   0  disk  
     |-- vda1               252:1     0    1G   0  part  /boot
     |-- vda2               252:2     0   29G   0  part  
          |-- rl_vm11-root  253:0     0   26G   0  lvm   /
          |-- rl_vm11-swap  253:1     0    3G   0  lvm   [SWAP]
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ LANG=C sudo parted /dev/vda -s print -> パーティション情報
    
    コマンドの実行結果
    --------------------------------------------------
    Model: Virtio Block Device (virtblk)
    Disk /dev/vda: 32.2GB
    Sector size (logical/physical): 512B/512B
    Partition Table: msdos
    Disk Flags: 
    
    Number  Start   End     Size    Type     Filesystem  Flags
    1       1049kB  1075MB  1074MB  primary  xfs           boot
    2       1075MB  32.2GB  31.1GB  primary                lvm  // LVM が判明
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ LANG=C sudo parted /dev/vdb -s print -> パーティション情報
    
    コマンドの実行結果
    --------------------------------------------------
    Model: Virtio Block Device (virtblk)
    Disk /dev/vdb: 2097MB
    Sector size (logical/physical): 512B/512B
    Partition Table: msdos
    Disk Flags: 
    
    Number  Start   End     Size    Type     Filesystem  Flags
    1       1049kB  1049MB  1048MB  primary  ext4
    2       1070MB  2097MB  1028MB  primary  ext4
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ LANG=C sudo parted /dev/vdc -s print -> パーティション情報
    
    コマンドの実行結果
    --------------------------------------------------
    Model: Virtio Block Device (virtblk)
    Disk /dev/vdc: 2097MB
    Sector size (logical/physical): 512B/512B
    Partition Table: msdos
    Disk Flags: 
    
    Number  Start   End     Size    Type     Filesystem      Flags
    1       1049kB  1049MB  1048MB  primary  linux-swap(v1)
    2       1070MB  2097MB  1028MB  primary  linux-swap(v1)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo lvscan -> 論理ボリューム探査
    
    コマンドの実行結果
    --------------------------------------------------
    ACTIVE  '/dev/rl_vm11/swap' [3.00 GiB] inherit
    ACTIVE  '/dev/rl_vm11/root' [<26.00 GiB] inherit
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo vgscan -> ボリュームグループ探査
    
    コマンドの実行結果
    --------------------------------------------------
    Found volume group "rl_vm11" using metadata type lvm2
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo pvscan -> 物理ボリューム探査
    
    コマンドの実行結果
    --------------------------------------------------
    PV /dev/vda2   VG rl_vm11   lvm2 [<29.00 GiB / 0    free]
    Total: 1 [<29.00 GiB] / in use: 1 [<29.00 GiB] / in no VG: 0 [0   ]
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[008]
  LVMの作成
  
[内容]
  ## 作業内容
    論理ボリュームを作成後にマウントする
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Wed Jun  7 20:59:23 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ dd if=/dev/zero of=image0.img bs=10M count=10
    vm11$ dd if=/dev/zero of=image1.img bs=10M count=10
    
    コマンドの実行結果
    --------------------------------------------------
    // image0.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.178561 s, 587 MB/s
    
    // image1.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.153347 s, 684 MB/s
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup /dev/loop0 image0.img
    vm11$ sudo losetup /dev/loop1 image1.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo pvcreate /dev/loop0 /dev/loop1 -> 物理ボリュームの初期化
    
    コマンドの実行結果
    --------------------------------------------------
    Physical volume "/dev/loop0" successfully created.
    Physical volume "/dev/loop1" successfully created.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo vgcreate vg0 /dev/loop0 /dev/loop1 -> ボリュームグループの作成
    
    コマンドの実行結果
    --------------------------------------------------
    Volume group "vg0" successfully created
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo lvcreate -L 50M -n lv0 vg0 -> 論理ボリュームの作成
    vm11$ sudo lvcreate -L 50M -n lv1 vg0 -> 論理ボリュームの作成
    vm11$ sudo lvcreate -L 50M -n lv2 vg0 -> 論理ボリュームの作成
    
    コマンドの実行結果
    --------------------------------------------------
    // lv0
    Rounding up size to full physical extent 52.00 MiB
    Logical volume "lv0" created.
    
    // lv1
    Rounding up size to full physical extent 52.00 MiB
    Logical volume "lv1" created.
    
    // lv2
    Rounding up size to full physical extent 52.00 MiB
    Logical volume "lv2" created.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkfs -t xfs /dev/vg0/lv0
    vm11$ sudo mkfs -t xfs /dev/vg0/lv1
    vm11$ sudo mkfs -t xfs /dev/vg0/lv2
    
    コマンドの実行結果
    --------------------------------------------------
    (省略)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mount -o defaults /dev/vg0/lv0 /mnt/loop0
    vm11$ sudo mount -o defaults /dev/vg0/lv1 /mnt/loop1
    vm11$ sudo mount -o defaults /dev/vg0/lv2 /mnt/loop2
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo pvscan -> 物理ボリュームの表示
    
    コマンドの実行結果
    --------------------------------------------------
    PV /dev/vda2    VG rl_vm11         lvm2 [<29.00 GiB / 0         free]
    PV /dev/loop0   VG vg0             lvm2 [96.00 MiB  / 0         free]
    PV /dev/loop1   VG vg0             lvm2 [96.00 MiB  / 36.00 MiB free]
    Total: 3 [29.18 GiB] / in use: 3 [29.18 GiB] / in no VG: 0 [0   ]
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo pvdisplay /dev/loop0 -> 物理ボリュームの詳細を表示
    
    コマンドの実行結果
    --------------------------------------------------
    PV Name               /dev/loop0
    VG Name               vg0
    PV Size               100.00 MiB / not usable 4.00 MiB
    Allocatable           yes (but full)
    PE Size               4.00 MiB
    Total PE              24
    Free PE               0
    Allocated PE          24
    PV UUID               1i6wad-Ara0-jHaz-cNhd-P5TE-LqcU-FC7Day
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo pvdisplay /dev/loop1 -> 物理ボリュームの詳細を表示
    
    コマンドの実行結果
    --------------------------------------------------
    PV Name               /dev/loop1
    VG Name               vg0
    PV Size               100.00 MiB / not usable 4.00 MiB
    Allocatable           yes 
    PE Size               4.00 MiB
    Total PE              24
    Free PE               9
    Allocated PE          15
    PV UUID               7GXbXf-n7ps-pzq0-MbLv-r9lX-J4bq-wx4lOO
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo vgscan -> ボリュームグループの表示
    
    コマンドの実行結果
    --------------------------------------------------
    Found volume group "rl_vm11" using metadata type lvm2
    Found volume group "vg0" using metadata type lvm2
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo vgdisplay vg0 -> ボリュームグループの詳細を表示
    
    コマンドの実行結果
    --------------------------------------------------
    VG Name               vg0
    System ID             
    Format                lvm2
    Metadata Areas        2
    Metadata Sequence No  4
    VG Access             read/write
    VG Status             resizable
    MAX LV                0
    Cur LV                3
    Open LV               3
    Max PV                0
    Cur PV                2
    Act PV                2
    VG Size               192.00 MiB
    PE Size               4.00 MiB
    Total PE              48
    Alloc PE / Size       39 / 156.00 MiB
    Free  PE / Size       9 / 36.00 MiB
    VG UUID               MXjrfm-0zkC-lcPN-dKGL-5mY2-Neeh-ZXIw2v
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo lvscan -> 論理ボリュームの表示
    
    コマンドの実行結果
    --------------------------------------------------
    ACTIVE  '/dev/rl_vm11/swap' [3.00 GiB] inherit
    ACTIVE  '/dev/rl_vm11/root' [<26.00 GiB] inherit
    ACTIVE  '/dev/vg0/lv0' [52.00 MiB] inherit
    ACTIVE  '/dev/vg0/lv1' [52.00 MiB] inherit
    ACTIVE  '/dev/vg0/lv2' [52.00 MiB] inherit
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo lvdisplay /dev/vg0/lv0 -> 論理ボリュームの詳細を表示
    
    コマンドの実行結果
    --------------------------------------------------
    LV Path                /dev/vg0/lv0
    LV Name                lv0
    VG Name                vg0
    LV UUID                QlH5IY-ZJft-Or93-D5pV-TKSv-6Fw8-42bm4F
    LV Write Access        read/write
    LV Creation host, time vm11, 2023-06-07 22:30:58 +0900
    LV Status              available
    # open                 1
    LV Size                52.00 MiB
    Current LE             13
    Segments               1
    Allocation             inherit
    Read ahead sectors     auto
    - currently set to     8192
    Block device           253:2
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo lvdisplay /dev/vg0/lv1 -> 論理ボリュームの詳細を表示
    
    コマンドの実行結果
    --------------------------------------------------
    LV Path                /dev/vg0/lv1
    LV Name                lv1
    VG Name                vg0
    LV UUID                Z8jWxV-ddG2-1rQH-tkPi-TGVJ-Vk0s-EGAt1s
    LV Write Access        read/write
    LV Creation host, time vm11, 2023-06-07 22:42:36 +0900
    LV Status              available
    # open                 1
    LV Size                52.00 MiB
    Current LE             13
    Segments               1
    Allocation             inherit
    Read ahead sectors     auto
    - currently set to     8192
    Block device           253:3
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo lvdisplay /dev/vg0/lv2 -> 論理ボリュームの詳細を表示
    
    コマンドの実行結果
    --------------------------------------------------
    LV Path                /dev/vg0/lv2
    LV Name                lv2
    VG Name                vg0
    LV UUID                2qG8cQ-yu25-Jr0u-emRA-8oIV-U2Qv-9NzLQm
    LV Write Access        read/write
    LV Creation host, time vm11, 2023-06-07 22:43:02 +0900
    LV Status              available
    # open                 1
    LV Size                52.00 MiB
    Current LE             13
    Segments               2
    Allocation             inherit
    Read ahead sectors     auto
    - currently set to     8192
    Block device           253:4
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo umount /mnt/loop0
    vm11$ sudo umount /mnt/loop1
    vm11$ sudo umount /mnt/loop2
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo lvremove /dev/vg0/lv0 -> 論理ボリュームの削除
    vm11$ sudo lvremove /dev/vg0/lv1 -> 論理ボリュームの削除
    vm11$ sudo lvremove /dev/vg0/lv2 -> 論理ボリュームの削除
    
    コマンドの実行結果
    --------------------------------------------------
    // lv0
    Do you really want to remove active logical volume vg0/lv0? [y/n]: y
      Logical volume "lv0" successfully removed.
    
    // lv1
    Do you really want to remove active logical volume vg0/lv1? [y/n]: y
      Logical volume "lv1" successfully removed.
    
    // lv2
    Do you really want to remove active logical volume vg0/lv2? [y/n]: y
      Logical volume "lv2" successfully removed.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo vgremove vg0 -> ボリュームグループの削除
    
    コマンドの実行結果
    --------------------------------------------------
    Volume group "vg0" successfully removed
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo pvremove /dev/loop0 /dev/loop1 -> 物理ボリュームの削除
    
    コマンドの実行結果
    --------------------------------------------------
    Labels on physical volume "/dev/loop0" successfully wiped.
    Labels on physical volume "/dev/loop1" successfully wiped.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup -D
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ rm -f image[0-1].img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[009]
  LVMの管理 - 01 (ボリュームグループの拡張・縮小)
  
[内容]
  ## 作業内容
    論理ボリュームがマウント状態で、ボリュームグループの拡張・縮小を実験
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Wed Jun  7 22:28:26 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ dd if=/dev/zero of=image0.img bs=10M count=10
    vm11$ dd if=/dev/zero of=image1.img bs=10M count=10
    vm11$ dd if=/dev/zero of=image2.img bs=10M count=10
    
    コマンドの実行結果
    --------------------------------------------------
    // image0.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.964403 s, 109 MB/s
    
    // image1.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.603381 s, 174 MB/s
    
    // image2.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.633878 s, 165 MB/s
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup /dev/loop0 image0.img
    vm11$ sudo losetup /dev/loop1 image1.img
    vm11$ sudo losetup /dev/loop2 image2.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo pvcreate /dev/loop0 /dev/loop1 /dev/loop2
    
    コマンドの実行結果
    --------------------------------------------------
    Physical volume "/dev/loop0" successfully created.
    Physical volume "/dev/loop1" successfully created.
    Physical volume "/dev/loop2" successfully created.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo vgcreate vg0 /dev/loop0 /dev/loop1
    
    コマンドの実行結果
    --------------------------------------------------
    Volume group "vg0" successfully created
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo lvcreate -L 50M -n lv0 vg0
    vm11$ sudo lvcreate -L 50M -n lv1 vg0
    vm11$ sudo lvcreate -L 50M -n lv2 vg0
    
    コマンドの実行結果
    --------------------------------------------------
    // lv0
    Rounding up size to full physical extent 52.00 MiB
    Logical volume "lv0" created.
    
    // lv1
    Rounding up size to full physical extent 52.00 MiB
    Logical volume "lv1" created.
    
    // lv2
    Rounding up size to full physical extent 52.00 MiB
    Logical volume "lv2" created.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkfs -t xfs /dev/vg0/lv0
    vm11$ sudo mkfs -t xfs /dev/vg0/lv1
    vm11$ sudo mkfs -t xfs /dev/vg0/lv2
    
    コマンドの実行結果
    --------------------------------------------------
    (省略)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mount -o defaults /dev/vg0/lv0 /mnt/loop0
    vm11$ sudo mount -o defaults /dev/vg0/lv1 /mnt/loop1
    vm11$ sudo mount -o defaults /dev/vg0/lv2 /mnt/loop2
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo vgdisplay vg0
    
    コマンドの実行結果
    --------------------------------------------------
    VG Name               vg0
    System ID             
    Format                lvm2
    Metadata Areas        2
    Metadata Sequence No  4
    VG Access             read/write
    VG Status             resizable  // サイズ変更可能
    MAX LV                0          // 論理ボリューム数の上限なし
    Cur LV                3          // 現在の論理ボリューム数
    Open LV               3
    Max PV                0          // 論理ボリューム数の上限なし
    Cur PV                2          // 現在の物理ボリューム数
    Act PV                2
    VG Size               192.00 MiB
    PE Size               4.00 MiB
    Total PE              48
    Alloc PE / Size       39 / 156.00 MiB
    Free  PE / Size       9 / 36.00 MiB
    VG UUID               PVXMgQ-Fl53-ktzi-uxON-mUiY-LyFj-icuap3
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo pvdisplay /dev/loop0
    
    コマンドの実行結果
    --------------------------------------------------
    PV Name               /dev/loop0
    VG Name               vg0
    PV Size               100.00 MiB / not usable 4.00 MiB
    Allocatable           yes (but full)  // サイズ変更の余地がない
    PE Size               4.00 MiB
    Total PE              24              // 総エクステント数
    Free PE               0               // 空エクステント数
    Allocated PE          24              // エクステント割当数
    PV UUID               EEhp8D-7ZLz-ct63-arTf-R0M3-efw3-fU2d43
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo pvdisplay /dev/loop1
    
    コマンドの実行結果
    --------------------------------------------------
    PV Name               /dev/loop1
    VG Name               vg0
    PV Size               100.00 MiB / not usable 4.00 MiB
    Allocatable           yes             // サイズ変更の余地がある
    PE Size               4.00 MiB
    Total PE              24              // 総エクステント数
    Free PE               9               // 空エクステント数
    Allocated PE          15              // エクステント割当数
    PV UUID               uAeEO3-NGLq-opQB-0wkB-cqhG-nfhp-llApxR
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo vgreduce vg0 /dev/loop0 -> ボリュームグループの縮小
    
    コマンドの実行結果
    --------------------------------------------------
    Physical volume "/dev/loop0" still in use -> 物理ボリュームが使用中のためエラー
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo vgreduce vg0 /dev/loop1 -> ボリュームグループの縮小
    
    コマンドの実行結果
    --------------------------------------------------
    Physical volume "/dev/loop1" still in use -> 物理ボリュームが使用中のためエラー
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo vgextend vg0 /dev/loop2 -> ボリュームグループの拡張
    
    コマンドの実行結果
    --------------------------------------------------
    Volume group "vg0" successfully extended -> 空の物理ボリュームは追加可能
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo vgreduce vg0 /dev/loop2 -> ボリュームグループの縮小
    
    コマンドの実行結果
    --------------------------------------------------
    Removed "/dev/loop2" from volume group "vg0" -> 物理ボリュームが未使用のためボリュームグループから除去可能
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo umount /mnt/loop0
    vm11$ sudo umount /mnt/loop1
    vm11$ sudo umount /mnt/loop2
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo lvremove /dev/vg0/lv0
    vm11$ sudo lvremove /dev/vg0/lv1
    vm11$ sudo lvremove /dev/vg0/lv2
    
    コマンドの実行結果
    --------------------------------------------------
    // lv0
    Do you really want to remove active logical volume vg0/lv0? [y/n]: y
      Logical volume "lv0" successfully removed.
    
    // lv1
    Do you really want to remove active logical volume vg0/lv1? [y/n]: y
      Logical volume "lv1" successfully removed.
    
    // lv2
    Do you really want to remove active logical volume vg0/lv2? [y/n]: y
      Logical volume "lv2" successfully removed.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo vgremove vg0
    
    コマンドの実行結果
    --------------------------------------------------
    Volume group "vg0" successfully removed
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo pvremove /dev/loop0 /dev/loop1 /dev/loop2
    
    コマンドの実行結果
    --------------------------------------------------
    Labels on physical volume "/dev/loop0" successfully wiped.
    Labels on physical volume "/dev/loop1" successfully wiped.
    Labels on physical volume "/dev/loop2" successfully wiped.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup -D
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ rm -f image[0-2].img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[010]
  LVMの管理 - 02 (論理ボリュームの拡張・縮小)
  
[内容]
  ## 作業内容
    論理ボリュームがマウント状態で、論理ボリュームの拡張・縮小を実験
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Thu Jun  8 18:32:29 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ dd if=/dev/zero of=image0.img bs=10M count=10
    vm11$ dd if=/dev/zero of=image1.img bs=10M count=10
    vm11$ dd if=/dev/zero of=image2.img bs=10M count=10
    
    コマンドの実行結果
    --------------------------------------------------
    // image0.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.333639 s, 314 MB/s
    
    // image1.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.360866 s, 291 MB/s
    
    // image2.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.677358 s, 155 MB/s
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup /dev/loop0 image0.img
    vm11$ sudo losetup /dev/loop1 image1.img
    vm11$ sudo losetup /dev/loop2 image2.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo pvcreate /dev/loop0 /dev/loop1 /dev/loop2
    
    コマンドの実行結果
    --------------------------------------------------
    Physical volume "/dev/loop0" successfully created.
    Physical volume "/dev/loop1" successfully created.
    Physical volume "/dev/loop2" successfully created.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo vgcreate vg0 /dev/loop0 /dev/loop1 /dev/loop2
    
    コマンドの実行結果
    --------------------------------------------------
    Volume group "vg0" successfully created
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo lvcreate -L 50M -n lv0 vg0
    vm11$ sudo lvcreate -L 50M -n lv1 vg0
    vm11$ sudo lvcreate -L 50M -n lv2 vg0
    
    コマンドの実行結果
    --------------------------------------------------
    // lv0
    Rounding up size to full physical extent 52.00 MiB
    Logical volume "lv0" created.
    
    // lv1
    Rounding up size to full physical extent 52.00 MiB
    Logical volume "lv1" created.
    
    // lv2
    Rounding up size to full physical extent 52.00 MiB
    Logical volume "lv2" created.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkfs -t xfs /dev/vg0/lv0
    vm11$ sudo mkfs -t xfs /dev/vg0/lv1
    vm11$ sudo mkfs -t xfs /dev/vg0/lv2
    
    コマンドの実行結果
    --------------------------------------------------
    (省略)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mount -o defaults /dev/vg0/lv0 /mnt/loop0
    vm11$ sudo mount -o defaults /dev/vg0/lv1 /mnt/loop1
    vm11$ sudo mount -o defaults /dev/vg0/lv2 /mnt/loop2
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo pvdisplay /dev/loop0
    
    コマンドの実行結果
    --------------------------------------------------
    PV Name               /dev/loop0
    VG Name               vg0
    PV Size               100.00 MiB / not usable 4.00 MiB
    Allocatable           yes 
    PE Size               4.00 MiB
    Total PE              24
    Free PE               11  // 空きエクステントがある
    Allocated PE          13
    PV UUID               IP5Ii5-ZnE9-KPtW-9ysQ-On00-pqX4-tJlyss
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo pvdisplay /dev/loop1
    
    コマンドの実行結果
    --------------------------------------------------
    PV Name               /dev/loop1
    VG Name               vg0
    PV Size               100.00 MiB / not usable 4.00 MiB
    Allocatable           yes 
    PE Size               4.00 MiB
    Total PE              24
    Free PE               11  // 空きエクステントがある
    Allocated PE          13
    PV UUID               35KTdi-0dRS-AaGi-9NvC-eL57-BluJ-C1p0AN
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo pvdisplay /dev/loop2
    
    コマンドの実行結果
    --------------------------------------------------
    PV Name               /dev/loop2
    VG Name               vg0
    PV Size               100.00 MiB / not usable 4.00 MiB
    Allocatable           yes 
    PE Size               4.00 MiB
    Total PE              24
    Free PE               11  // 空きエクステントがある
    Allocated PE          13
    PV UUID               T23Nd2-t2cU-ABt1-qvpl-5FtF-3GMb-ajJFAV
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo vgdisplay vg0
    
    コマンドの実行結果
    --------------------------------------------------
    VG Name               vg0
    System ID             
    Format                lvm2
    Metadata Areas        3
    Metadata Sequence No  4
    VG Access             read/write
    VG Status             resizable  // サイズ変更可能
    MAX LV                0
    Cur LV                3
    Open LV               3
    Max PV                0
    Cur PV                3
    Act PV                3
    VG Size               288.00 MiB
    PE Size               4.00 MiB
    Total PE              72
    Alloc PE / Size       39 / 156.00 MiB
    Free  PE / Size       33 / 132.00 MiB
    VG UUID               h5YCEF-m1wl-lH20-wSJI-OrzE-6t41-LrBoiS
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo lvdisplay /dev/vg0/lv0
    
    コマンドの実行結果
    --------------------------------------------------
    LV Path                /dev/vg0/lv0
    LV Name                lv0
    VG Name                vg0
    LV UUID                m1Nzu9-fBvC-dnZ6-kU8V-OEwl-7LO4-2vELJc
    LV Write Access        read/write
    LV Creation host, time vm11, 2023-06-08 19:31:02 +0900
    LV Status              available
    # open                 1
    LV Size                52.00 MiB
    Current LE             13
    Segments               1
    Allocation             inherit
    Read ahead sectors     auto
    - currently set to     8192
    Block device           253:2
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo lvdisplay /dev/vg0/lv1
    
    コマンドの実行結果
    --------------------------------------------------
    LV Path                /dev/vg0/lv1
    LV Name                lv1
    VG Name                vg0
    LV UUID                S8Yaj3-Rje4-H69Q-Kyri-c9jw-qad4-ToJ3e1
    LV Write Access        read/write
    LV Creation host, time vm11, 2023-06-08 19:31:26 +0900
    LV Status              available
    # open                 1
    LV Size                52.00 MiB
    Current LE             13
    Segments               1
    Allocation             inherit
    Read ahead sectors     auto
    - currently set to     8192
    Block device           253:3
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo lvdisplay /dev/vg0/lv2
    
    コマンドの実行結果
    --------------------------------------------------
    LV Path                /dev/vg0/lv2
    LV Name                lv2
    VG Name                vg0
    LV UUID                mKcCIy-B7Kj-vETJ-6BBq-5ofx-dbIs-3CPB05
    LV Write Access        read/write
    LV Creation host, time vm11, 2023-06-08 19:31:49 +0900
    LV Status              available
    # open                 1
    LV Size                52.00 MiB
    Current LE             13
    Segments               1
    Allocation             inherit
    Read ahead sectors     auto
    - currently set to     8192
    Block device           253:4
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo lvreduce -L 40M /dev/vg0/lv0 -> 論理ボリュームの縮小
    
    コマンドの実行結果
    --------------------------------------------------
    WARNING: Reducing active and open logical volume to 40.00 MiB.
    THIS MAY DESTROY YOUR DATA (filesystem etc.)
    
    Do you really want to reduce vg0/lv0? [y/n]: y
    Size of logical volume vg0/lv0 changed from 52.00 MiB (13 extents) to 40.00 MiB (10 extents).
    Logical volume vg0/lv0 successfully resized.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo lvextend -L 60M /dev/vg0/lv1 -> 論理ボリュームの拡張
    
    コマンドの実行結果
    --------------------------------------------------
    Size of logical volume vg0/lv1 changed from 52.00 MiB (13 extents) to 60.00 MiB (15 extents).
    Logical volume vg0/lv1 successfully resized.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo umount /mnt/loop0
    vm11$ sudo umount /mnt/loop1
    vm11$ sudo umount /mnt/loop2
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo lvremove /dev/vg0/lv0
    vm11$ sudo lvremove /dev/vg0/lv1
    vm11$ sudo lvremove /dev/vg0/lv2
    
    コマンドの実行結果
    --------------------------------------------------
    // lv0
    Do you really want to remove active logical volume vg0/lv0? [y/n]: y
      Logical volume "lv0" successfully removed.
    
    // lv1
    Do you really want to remove active logical volume vg0/lv1? [y/n]: y
      Logical volume "lv1" successfully removed.
    
    // lv2
    Do you really want to remove active logical volume vg0/lv2? [y/n]: y
      Logical volume "lv2" successfully removed.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo vgremove vg0
    
    コマンドの実行結果
    --------------------------------------------------
    Volume group "vg0" successfully removed
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo pvremove /dev/loop0 /dev/loop1 /dev/loop2
    
    コマンドの実行結果
    --------------------------------------------------
    Labels on physical volume "/dev/loop0" successfully wiped.
    Labels on physical volume "/dev/loop1" successfully wiped.
    Labels on physical volume "/dev/loop2" successfully wiped.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup -D
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ rm -f image[0-2].img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[011]
  LVMの管理 - 03 (スナップショット)
  
[内容]
  ## 作業内容
    論理ボリュームがマウント状態で、スナップショットによる復元を実験
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Thu Jun  8 19:25:51 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ dd if=/dev/zero of=image0.img bs=10M count=10
    
    コマンドの実行結果
    --------------------------------------------------
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.421026 s, 249 MB/s
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup /dev/loop0 image0.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo pvcreate /dev/loop0
    
    コマンドの実行結果
    --------------------------------------------------
    Physical volume "/dev/loop0" successfully created.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo vgcreate vg0 /dev/loop0
    
    コマンドの実行結果
    --------------------------------------------------
    Volume group "vg0" successfully created
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo lvcreate -L 50M -n lv0 vg0
    
    コマンドの実行結果
    --------------------------------------------------
    Rounding up size to full physical extent 52.00 MiB
    Logical volume "lv0" created.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkfs -t xfs /dev/vg0/lv0
    
    コマンドの実行結果
    --------------------------------------------------
    (省略)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mount -o defaults /dev/vg0/lv0 /mnt/loop0
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo touch /mnt/loop0/sample1.txt
    vm11$ sudo touch /mnt/loop0/sample2.txt
    vm11$ sudo touch /mnt/loop0/sample3.txt
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo lvcreate -s -L 20M -n sp0 /dev/vg0/lv0 -> スナップショット作成
    
    コマンドの実行結果
    --------------------------------------------------
    Logical volume "sp0" created.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo lvscan | grep vg0
    
    コマンドの実行結果
    --------------------------------------------------
    ACTIVE   Original   '/dev/vg0/lv0'   [52.00 MiB]   inherit
    ACTIVE   Snapshot   '/dev/vg0/sp0'   [20.00 MiB]   inherit
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo lvdisplay /dev/vg0/lv0
    
    コマンドの実行結果
    --------------------------------------------------
    LV Path                /dev/vg0/lv0
    LV Name                lv0
    VG Name                vg0
    LV UUID                0Zxr97-74rS-OaME-Z9uu-op2w-zpVT-FPCpI6
    LV Write Access        read/write
    LV Creation host, time vm11, 2023-06-08 20:41:43 +0900
    LV snapshot status     source of sp0 [active]  // スナップショット元
    LV Status              available
    # open                 1
    LV Size                52.00 MiB
    Current LE             13
    Segments               1
    Allocation             inherit
    Read ahead sectors     auto
    - currently set to     8192
    Block device           253:2
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo lvdisplay /dev/vg0/sp0 -> スナップショットの詳細を表示
    
    コマンドの実行結果
    --------------------------------------------------
    LV Path                /dev/vg0/sp0
    LV Name                sp0
    VG Name                vg0
    LV UUID                hzLlHb-m1Qu-XXAQ-koiU-N8Nq-CdJu-8KzMW7
    LV Write Access        read/write
    LV Creation host, time vm11, 2023-06-08 20:45:10 +0900
    LV snapshot status     active destination for lv0  // 論理ボリューム(lv0)のスナップショット先
    LV Status              available
    # open                 0
    LV Size                52.00 MiB
    Current LE             13
    COW-table size         20.00 MiB
    COW-table LE           5
    Allocated to snapshot  0.08%
    Snapshot chunk size    4.00 KiB
    Segments               1
    Allocation             inherit
    Read ahead sectors     auto
    - currently set to     8192
    Block device           253:5
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo rm /mnt/loop0/sample2.txt
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo ls -lh /mnt/loop0
    
    コマンドの実行結果
    --------------------------------------------------
    -rw-r--r-- 1 root root 0  6月  8 20:43 sample1.txt
    -rw-r--r-- 1 root root 0  6月  8 20:43 sample3.txt
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo umount /mnt/loop0
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> マウント状態ではスナップショット操作はできない
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo lvconvert --merge /dev/vg0/sp0 -> スナップショットで論理ボリューム復元
    
    コマンドの実行結果
    --------------------------------------------------
    Merging of volume vg0/sp0 started.
    vg0/lv0: Merged: 99.94%
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mount -o defaults /dev/vg0/lv0 /mnt/loop0
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo ls -lh /mnt/loop0
    
    コマンドの実行結果
    --------------------------------------------------
    -rw-r--r-- 1 root root 0  6月  8 20:43 sample1.txt
    -rw-r--r-- 1 root root 0  6月  8 20:43 sample2.txt -> スナップショット作成前に戻る
    -rw-r--r-- 1 root root 0  6月  8 20:43 sample3.txt
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo lvscan | grep vg0
    
    コマンドの実行結果
    --------------------------------------------------
    // 作成直後
    ACTIVE   Original   '/dev/vg0/lv0'   [52.00 MiB]   inherit
    ACTIVE   Snapshot   '/dev/vg0/sp0'   [20.00 MiB]   inherit
    
    // 論理ボリュームと融合後
    ACTIVE              '/dev/vg0/lv0'   [52.00 MiB]   inherit
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo umount /mnt/loop0
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo lvremove /dev/vg0/lv0
    
    コマンドの実行結果
    --------------------------------------------------
    Do you really want to remove active logical volume vg0/lv0? [y/n]: y
      Logical volume "lv0" successfully removed.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo vgremove vg0
    
    コマンドの実行結果
    --------------------------------------------------
    Volume group "vg0" successfully removed
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo pvremove /dev/loop0
    
    コマンドの実行結果
    --------------------------------------------------
    Labels on physical volume "/dev/loop0" successfully wiped.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup -D
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ rm -f image0.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[012]
  ハードディスクの管理
  
[内容]
  ## 作業内容
    ハードディスクのパラメータ確認
  
  ## コマンド(sdparm)
    sdparm -q           : 冒頭プロファイル非表示
    sdparm -a(--all) XX : ハードディスク(XX)の全情報表示
  
[確認]
  $ cd $HOME
  $ lsblk
  
  コマンドの実行結果
  --------------------------------------------------
  NAME               MAJ:MIN  RM    SIZE  RO  TYPE  MOUNTPOINT
  sda                  8:0     0    477G   0  disk  (対象ハードディスク) -> sdparam を使用
   |-- sda1            8:1     0      1G   0  part  /boot
   |-- sda2            8:2     0    476G   0  part  
        |-- rl-root  253:0     0     70G   0  lvm   /
        |-- rl-swap  253:1     0    3.9G   0  lvm   [SWAP]
        |-- rl-home  253:2     0  402.1G   0  lvm   /home
  --------------------------------------------------
  
  $ cd $HOME
  $ sudo dnf -y install sdparm
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> エラー出力が無ければOK
  --------------------------------------------------
  
  $ cd $HOME
  $ sudo sdparm /dev/sda -> ハードディスクのパラメータ確認
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/sda: ATA  Crucial_CT512MX1  MU01 -> ATA規格のHDD

  Read write error recovery mode page:
    AWRE          1  [cha: n, def:  1]
    ARRE          0  [cha: n, def:  0]
    PER           0  [cha: n, def:  0]
  Caching (SBC) mode page:
    IC            0  [cha: n, def:  0]
    WCE           1  [cha: y, def:  1]
    RCD           0  [cha: n, def:  0]
  Control mode page:
    TST           0  [cha: n, def:  0]
    SWP           0  [cha: n, def:  0]
  --------------------------------------------------
  
  $ cd $HOME
  $ sudo sdparm -a /dev/sda -> 全パラメータ確認
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/sda: ATA  Crucial_CT512MX1  MU01

  Read write error recovery mode page:
    AWRE          1  [cha: n, def:  1]
    ARRE          0  [cha: n, def:  0]
    ...
  Caching (SBC) mode page:
    IC            0  [cha: n, def:  0]
    ABPF          0  [cha: n, def:  0]
    ...
  Control mode page:
    TST           0  [cha: n, def:  0]
    TMF_ONLY      0  [cha: n, def:  0]
    ...
  --------------------------------------------------
  
  $ cd $HOME
  $ sudo sdparm --command=capacity /dev/sda -> ブロック数・ブロックサイズ
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/sda: ATA  Crucial_CT512MX1  MU01

  blocks: 1000215216      // ブロック数
  block_length: 512       // ブロックサイズ
  capacity_mib: 488386.3  // 全容量(MB)
  --------------------------------------------------
  
  $ cd $HOME
  $ sudo sdparm --command=profile /dev/sda -> プロファイル表示
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/sda: ATA  Crucial_CT512MX1  MU01 -> 冒頭の情報が表示
  --------------------------------------------------
  
  $ cd $HOME
  $ sudo sdparm -q --command=ready /dev/sda -> 生死の確認
  
  コマンドの実行結果
  --------------------------------------------------
  Ready -> 稼働中  // 非稼動 -> Not-Ready
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[013]
  SSD
  
[内容]
  ## 作業内容
    記憶装置がHDDかSSDか確認する
  
[確認]
  $ cd $HOME
  $ lsblk
  
  コマンドの実行結果
  --------------------------------------------------
  NAME               MAJ:MIN  RM    SIZE  RO  TYPE  MOUNTPOINT
  sda                  8:0     0    477G   0  disk  (記憶装置)
   |-- sda1            8:1     0      1G   0  part  /boot
   |-- sda2            8:2     0    476G   0  part  
        |-- rl-root  253:0     0     70G   0  lvm   /
        |-- rl-swap  253:1     0    3.9G   0  lvm   [SWAP]
        |-- rl-home  253:2     0  402.1G   0  lvm   /home
  --------------------------------------------------
  
  $ cd $HOME
  $ cat /sys/block/sda/queue/rotational -> HDDかSSDか判別
  
  コマンドの実行結果
  --------------------------------------------------
  0 -> SSD  // 1 -> HDD
  --------------------------------------------------
  
  $ cd $HOME
  $ lsblk -o name,rota -> HDDかSSDか判別
  
  コマンドの実行結果
  --------------------------------------------------
  NAME               ROTA
  sda                0  // SDD
   |-- sda1          0
   |-- sda2          0
        |-- rl-root  0
        |-- rl-swap  0
        |-- rl-home  0
  --------------------------------------------------
  
  $ cd $HOME
  $ sudo hdparm -I /dev/sda | grep -i trim -> SSDがTrim対応か判定
  
  コマンドの実行結果
  --------------------------------------------------
  * Data Set Management TRIM supported (limit 8 blocks) -> SSDがTrim対応と判明
  * Deterministic read ZEROs after TRIM
  --------------------------------------------------
  
  $ cd $HOME
  $ mount | grep -i discard -> マウントオプションで自動Trimか判定
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし、自動でTrim実行する設定ではない
  --------------------------------------------------
  
  $ cd $HOME
  $ sudo fstrim -v /(ルートディレクトリ) -> コマンド(fstrim)で手動Trimを行う
  
  コマンドの実行結果
  --------------------------------------------------
  /: 59.7 GiB (64049324032 バイト) に切り揃えました
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[014]
  iSCSI
  
[内容]
  ## 作業内容
    論理ボリュームを「ターゲット」で公開、クライアントは「イニシエータ」でアクセス
  
[確認]
  $ cd $HOME
  $ sudo dnf -y install iscsi-initiator-utils
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 既にインストール済みの模様
  --------------------------------------------------
  
  $ cd $HOME
  $ cat /etc/iscsi/initiatorname.iscsi
  
  コマンドの実行結果
  --------------------------------------------------
  InitiatorName=iqn.1994-05.com.redhat:3da7d55861a
  --------------------------------------------------
  
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Thu Jun  8 20:28:49 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ dd if=/dev/zero of=image0.img bs=10M count=10
    vm11$ dd if=/dev/zero of=image1.img bs=10M count=10
    
    コマンドの実行結果
    --------------------------------------------------
    // image0.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.898396 s, 117 MB/s
    
    // image1.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.270659 s, 387 MB/s
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup /dev/loop0 image0.img
    vm11$ sudo losetup /dev/loop1 image1.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo pvcreate /dev/loop0 /dev/loop1
    
    コマンドの実行結果
    --------------------------------------------------
    Physical volume "/dev/loop0" successfully created.
    Physical volume "/dev/loop1" successfully created.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo vgcreate vg0 /dev/loop0 /dev/loop1
    
    コマンドの実行結果
    --------------------------------------------------
    Volume group "vg0" successfully created
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo lvcreate -L 150M -n lv0 vg0
    
    コマンドの実行結果
    --------------------------------------------------
    Rounding up size to full physical extent 152.00 MiB
    Logical volume "lv0" created.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkfs -t xfs /dev/vg0/lv0
    
    コマンドの実行結果
    --------------------------------------------------
    (省略)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo targetcli ls -> ターゲット設定項目
    
    コマンドの実行結果
    --------------------------------------------------
    Warning: Could not load preferences file /root/.targetcli/prefs.bin.
    o- / ..................................................................... [...]
      o- backstores .......................................................... [...]
      | o- block .............................................. [Storage Objects: 0]  // 公開ディスク
      | o- fileio ............................................. [Storage Objects: 0]
      | o- pscsi .............................................. [Storage Objects: 0]
      | o- ramdisk ............................................ [Storage Objects: 0]
      o- iscsi ........................................................ [Targets: 0]  // ターゲット識別名(IQN)
      o- loopback ..................................................... [Targets: 0]
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo targetcli     // コマンド本体
        > /backstores/block  // 規定の作成場所
        > create             // 作成モード
        > name=vm11-lv0      // ディスク名
        > dev=/dev/vg0/lv0   // デバイスに論理ボリューム指定
    
    コマンドの実行結果
    --------------------------------------------------
    Created block storage object vm11-lv0 using /dev/vg0/lv0.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo targetcli ls -> ターゲット設定項目
    
    コマンドの実行結果
    --------------------------------------------------
    o- / ..................................................................... [...]
      o- backstores .......................................................... [...]
      | o- block .............................................. [Storage Objects: 1]
      | | o- vm11-lv0 ............. [/dev/vg0/lv0 (152.0MiB) write-thru deactivated]  // 公開ディスク
      | |   o- alua ............................................... [ALUA Groups: 1]
      | |     o- default_tg_pt_gp ................... [ALUA state: Active/optimized]
      | o- fileio ............................................. [Storage Objects: 0]
      | o- pscsi .............................................. [Storage Objects: 0]
      | o- ramdisk ............................................ [Storage Objects: 0]
      o- iscsi ........................................................ [Targets: 0]
      o- loopback ..................................................... [Targets: 0]
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo targetcli                     // コマンド本体
        > /iscsi                             // 規定の作成場所
        > create                             // 作成モード
        > iqn.2023-06.com.test:vm11-share01  // ターゲット識別名(IQN)
    
    コマンドの実行結果
    --------------------------------------------------
    Created target iqn.2023-06.com.test:vm11-share01. // ターゲット識別名(IQN)
    Created TPG 1.
    Global pref auto_add_default_portal=true
    Created default portal listening on all IPs (0.0.0.0), port 3260.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo targetcli ls -> ターゲット設定項目
    
    コマンドの実行結果
    --------------------------------------------------
    o- / ..................................................................... [...]
      o- backstores .......................................................... [...]
      | o- block .............................................. [Storage Objects: 1]
      | | o- vm11-lv0 ............. [/dev/vg0/lv0 (152.0MiB) write-thru deactivated]  // 公開ディスク
      | |   o- alua ............................................... [ALUA Groups: 1]
      | |     o- default_tg_pt_gp ................... [ALUA state: Active/optimized]
      | o- fileio ............................................. [Storage Objects: 0]
      | o- pscsi .............................................. [Storage Objects: 0]
      | o- ramdisk ............................................ [Storage Objects: 0]
      o- iscsi ........................................................ [Targets: 1]
      | o- iqn.2023-06.com.test:vm11-share01 ............................. [TPGs: 1]  // ターゲット識別名(IQN)
      |   o- tpg1 ........................................... [no-gen-acls, no-auth]
      |     o- acls ...................................................... [ACLs: 0]
      |     o- luns ...................................................... [LUNs: 0]
      |     o- portals ................................................ [Portals: 1]
      |       o- 0.0.0.0:3260 ................................................. [OK]
      o- loopback ..................................................... [Targets: 0]
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo targetcli                                      // コマンド本体
        > /iscsi/iqn.2023-06.com.test:vm11-share01/tpg1/luns  // 規定の作成場所
        > create                                              // 作成モード
        > /backstores/block/vm11-lv0                          // 公開ディスク
    
    コマンドの実行結果
    --------------------------------------------------
    Created LUN 0.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo targetcli ls -> ターゲット設定項目
    
    コマンドの実行結果
    --------------------------------------------------
    o- / ..................................................................... [...]
      o- backstores .......................................................... [...]
      | o- block .............................................. [Storage Objects: 1]
      | | o- vm11-lv0 ............... [/dev/vg0/lv0 (152.0MiB) write-thru activated]  // 公開ディスク
      | |   o- alua ............................................... [ALUA Groups: 1]
      | |     o- default_tg_pt_gp ................... [ALUA state: Active/optimized]
      | o- fileio ............................................. [Storage Objects: 0]
      | o- pscsi .............................................. [Storage Objects: 0]
      | o- ramdisk ............................................ [Storage Objects: 0]
      o- iscsi ........................................................ [Targets: 1]
      | o- iqn.2023-06.com.test:vm11-share01 ............................. [TPGs: 1]  // ターゲット識別名(IQN)
      |   o- tpg1 ........................................... [no-gen-acls, no-auth]
      |     o- acls ...................................................... [ACLs: 0]
      |     o- luns ...................................................... [LUNs: 1]
      |     | o- lun0 ........... [block/vm11-lv0 (/dev/vg0/lv0) (default_tg_pt_gp)]  // 公開ディスクへのリンク
      |     o- portals ................................................ [Portals: 1]
      |       o- 0.0.0.0:3260 ................................................. [OK]
      o- loopback ..................................................... [Targets: 0]
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo targetcli                                      // コマンド本体
        > /iscsi/iqn.2023-06.com.test:vm11-share01/tpg1/acls  // 規定の作成場所
        > create                                              // 作成モード
        > iqn.1994-05.com.redhat:3da7d55861a                  // イニシエータ
    
    コマンドの実行結果
    --------------------------------------------------
    Created Node ACL for iqn.1994-05.com.redhat:3da7d55861a
    Created mapped LUN 0.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo targetcli ls -> ターゲット設定項目
    
    コマンドの実行結果
    --------------------------------------------------
    o- / ..................................................................... [...]
      o- backstores .......................................................... [...]
      | o- block .............................................. [Storage Objects: 1]
      | | o- vm11-lv0 ............... [/dev/vg0/lv0 (152.0MiB) write-thru activated]  // 公開ディスク
      | |   o- alua ............................................... [ALUA Groups: 1]
      | |     o- default_tg_pt_gp ................... [ALUA state: Active/optimized]
      | o- fileio ............................................. [Storage Objects: 0]
      | o- pscsi .............................................. [Storage Objects: 0]
      | o- ramdisk ............................................ [Storage Objects: 0]
      o- iscsi ........................................................ [Targets: 1]
      | o- iqn.2023-06.com.test:vm11-share01 ............................. [TPGs: 1]  // ターゲット識別名(IQN)
      |   o- tpg1 ........................................... [no-gen-acls, no-auth]
      |     o- acls ...................................................... [ACLs: 1]
      |     | o- iqn.1994-05.com.redhat:3da7d55861a ............... [Mapped LUNs: 1]  // イニシエータ名
      |     |   o- mapped_lun0 .......................... [lun0 block/vm11-lv0 (rw)]
      |     o- luns ...................................................... [LUNs: 1]
      |     | o- lun0 ........... [block/vm11-lv0 (/dev/vg0/lv0) (default_tg_pt_gp)]  // 公開ディスクへのリンク
      |     o- portals ................................................ [Portals: 1]
      |       o- 0.0.0.0:3260 ................................................. [OK]
      o- loopback ..................................................... [Targets: 0]
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo targetcli saveconfig -> ターゲット設定項目を保存
    
    コマンドの実行結果
    --------------------------------------------------
    Configuration saved to /etc/target/saveconfig.json
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo systemctl disable target
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 本格的に使用するつもりは無いので自動起動なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo systemctl restart target
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  $ cd $HOME
  $ sudo iscsiadm -m discovery -t sendtargets -p vm11 -> ターゲット検索
  
  コマンドの実行結果
  --------------------------------------------------
  192.168.122.11:3260,1 iqn.2023-06.com.test:vm11-share01
  --------------------------------------------------
  
  $ cd $HOME
  $ sudo iscsiadm -m node --login -> ターゲットへログイン
  
  コマンドの実行結果
  --------------------------------------------------
  Logging in to [iface: default, target: iqn.2023-06.com.test:vm11-share01, portal: 192.168.122.11,3260]
  Login to [iface: default, target: iqn.2023-06.com.test:vm11-share01, portal: 192.168.122.11,3260] successful.
  --------------------------------------------------
  
  $ cd $HOME
  $ lsblk
  
  コマンドの実行結果
  --------------------------------------------------
  NAME               MAJ:MIN  RM    SIZE  RO  TYPE  MOUNTPOINT
  sda                  8:0     0    477G   0  disk  
   |-- sda1            8:1     0      1G   0  part  /boot
   |-- sda2            8:2     0    476G   0  part  
        |-- rl-root  253:0     0     70G   0  lvm   /
        |-- rl-swap  253:1     0    3.9G   0  lvm   [SWAP]
        |-- rl-home  253:2     0  402.1G   0  lvm   /home
  sdb                  8:16    0    152M   0  disk  (ターゲットデバイス)
  --------------------------------------------------
  
  $ cd $HOME
  $ lsblk -S -> SCSIデバイスのみ表示
  
  コマンドの実行結果
  --------------------------------------------------
  NAME   HCTL      TYPE   VENDOR    MODEL              REV    TRAN
  sda    0:0:0:0   disk   ATA       Crucial_CT512MX1   MU01   sata
  sdb    6:0:0:0   disk   LIO-ORG   vm11-lv0           4.0    iscsi  // ターゲットデバイス
  --------------------------------------------------
  
  $ cd $HOME
  $ sudo mount -o defaults /dev/sdb /mnt
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  $ cd $HOME
  $ sudo umount /mnt
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  $ cd $HOME
  $ sudo iscsiadm -m node --logoutall=all -> ターゲットからログアウト
  
  コマンドの実行結果
  --------------------------------------------------
  Logging out of session [sid: 1, target: iqn.2023-06.com.test:vm11-share01, portal: 192.168.122.11,3260]
  Logout of [sid: 1, target: iqn.2023-06.com.test:vm11-share01, portal: 192.168.122.11,3260] successful.
  --------------------------------------------------
  
  $ cd $HOME
  $ sudo systemctl disable iscsi -> サービスの自動起動を無効化
  
  コマンドの実行結果
  --------------------------------------------------
  Removed /etc/systemd/system/remote-fs.target.wants/iscsi.service. -> 起動時のターゲット検索・ログイン処理を防ぐ
  --------------------------------------------------
  
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Fri Jun  9 08:30:20 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo targetcli clearconfig confirm=True -> ターゲット初期化
    
    コマンドの実行結果
    --------------------------------------------------
    All configuration cleared
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo systemctl stop target
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo lvremove /dev/vg0/lv0
    
    コマンドの実行結果
    --------------------------------------------------
    Do you really want to remove active logical volume vg0/lv0? [y/n]: y
      Logical volume "lv0" successfully removed.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo vgremove vg0
    
    コマンドの実行結果
    --------------------------------------------------
    Volume group "vg0" successfully removed
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo pvremove /dev/loop0 /dev/loop1
    
    コマンドの実行結果
    --------------------------------------------------
    Labels on physical volume "/dev/loop0" successfully wiped.
    Labels on physical volume "/dev/loop1" successfully wiped.
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup -D
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ rm -f image[0-1].img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
