================================================================================
[01] RAIDの構築と運用 - 01 (RAID 0)
[02] RAIDの構築と運用 - 02 (RAID 1)
[03] RAIDの構築と運用 - 03 (RAID 4)
[04] RAIDの構築と運用 - 04 (RAID 5)
[05] RAIDの構築と運用 - 05
[06] RAIDの構築と運用 - 06
[07] LVMの調査
[08] LVMの作成
[09] LVMの管理 - 01 (ボリュームグループの拡張・縮小)
[10] LVMの管理 - 02 (論理ボリュームの拡張・縮小)
[11] LVMの管理 - 03 (スナップショット)
[12] ハードディスクの管理
[13] SSD
[14] iSCSI
================================================================================
[01]
  RAIDの構築と運用 - 01 (RAID 0)
  
[内容]
  ## 作業内容
    RAIDアレイ(RAID 0)の作成後にマウントする
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン
  
  ## コマンド(mdadm) - 01
    mdadm -C XX        // RAIDアレイ(XX)を作成 -> -C = --create
    mdadm -C XX -a     // RAIDアレイ(XX)を作成、デバイスファイル自動作成
    mdadm -C XX -c YY  // RAIDアレイ(XX)を作成、チャンクサイズ(YY)
    mdadm -C XX -l YY  // RAIDアレイ(XX)を作成、RAIDレベル(YY) -> -l = --level
    mdadm -C XX -n YY  // RAIDアレイ(XX)を作成、RAIDデバイス数(YY) -> -n = --raid-devices
    mdadm -C XX -x YY  // RAIDアレイ(XX)を作成、スペアデバイス数(YY) -> -x == --spare-devices
  
  ## コマンド(mdadm) - 02
    mdadm --manage XX        // RAIDアレイ(XX)をメンテ
    mdadm --manage XX -a YY  // RAIDアレイ(XX)をメンテ、デバイス(YY)を追加 -> -a = --add
    mdadm --manage XX -r YY  // RAIDアレイ(XX)をメンテ、デバイス(YY)を削除 -> -r = --remove
    mdadm --manage XX -f YY  // RAIDアレイ(XX)をメンテ、デバイス(YY)に不良マーク -> -f = --fail
  
  ## コマンド(mdadm) - 03
    mdadm --misc XX                // RAIDアレイ(XX)を問合せ
    mdadm --misc -Q XX             // RAIDアレイ(XX)を問合せ、RAIDアレイ(XX)を状態を表示 -> -Q = --query
    mdadm --misc -D XX             // RAIDアレイ(XX)を問合せ、RAIDアレイ(XX)を状態を表示 -> -D = --detail
    mdadm --misc -E XX             // RAIDアレイ(XX)を問合せ、構成デバイスの状態を表示 -> -E = --examine
    mdadm --misc --readonly XX     // RAIDアレイ(XX)を読み取り専用にする
    mdadm --misc --readwrite XX    // RAIDアレイ(XX)を書き込み可能にする
    mdadm --misc --stop XX         // RAIDアレイ(XX)を停止する
    mdadm --misc --stop --scan XX  // 全てのRAIDアレイを停止する
  
[確認]
  vm12$ cd $HOME
  vm12$ sudo yum -y install mdadm
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> エラー出力が無ければOK
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=10M count=10
  vm12$ dd if=/dev/zero of=image1.img bs=10M count=10
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img
  vm12$ sudo losetup /dev/loop1 image1.img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mdadm -C /dev/md0 -l 0 -n 2 /dev/loop0 /dev/loop1 (RAIDアレイの作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ cat /proc/mdstat (RAIDアレイの確認)
  
  コマンドの実行結果
  --------------------------------------------------
  Personalities : [raid0]
  
  md0 : active raid0 loop1[1] loop0[0]
        200704 blocks super 1.2 512k chunks
  
  unused devices: <none>
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkfs -t xfs /dev/md0 (RAIDアレイにファイルシステム作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mount -o defaults -t xfs /dev/md0 /mnt (RAIDアレイのマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE  MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom   
  loop0                     7:0    0  100M  0 loop  
  └─md0                   9:0    0  196M  0 raid0 /mnt (RAIDアレイ)
  loop1                     7:1    0  100M  0 loop  
  └─md0                   9:0    0  196M  0 raid0 /mnt (RAIDアレイ)
  vda                     252:0    0   20G  0 disk  
  ├─vda2                252:2    0   19G  0 part  
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm   [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm   /
  └─vda1                252:1    0    1G  0 part  /boot
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt (RAIDアレイのアンマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mdadm (--misc) --stop /dev/md0 (RAIDアレイの停止)
  
  コマンドの実行結果
  --------------------------------------------------
  [31071.056750] md0: detected capacity change from 205520896 to 0
  [31071.059426] md: md0 stopped.
  mdadm: stopped /dev/md0
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f image[0-1].img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[02]
  RAIDの構築と運用 - 02 (RAID 1)
  
[内容]
  ## 作業内容
    RAIDアレイ(RAID 1)の作成後にマウントする
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン
  
[確認]
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=10M count=10
  vm12$ dd if=/dev/zero of=image1.img bs=10M count=10
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img
  vm12$ sudo losetup /dev/loop1 image1.img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mdadm -C /dev/md0 -l 1 -n 2 /dev/loop0 /dev/loop1 (RAIDアレイの作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ cat /proc/mdstat (RAIDアレイの確認)
  
  コマンドの実行結果
  --------------------------------------------------
  Personalities : [raid0] [raid1]
  
  md0 : active raid1 loop1[1] loop0[0]
        101376 blocks super 1.2 [2/2] [UU]
  
  unused devices: <none>
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkfs -t xfs /dev/md0 (RAIDアレイにファイルシステム作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mount -o defaults -t xfs /dev/md0 /mnt (RAIDアレイのマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE  MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom   
  loop0                     7:0    0  100M  0 loop  
  └─md0                   9:0    0  196M  0 raid1 /mnt (RAIDアレイ)
  loop1                     7:1    0  100M  0 loop  
  └─md0                   9:0    0  196M  0 raid1 /mnt (RAIDアレイ)
  vda                     252:0    0   20G  0 disk  
  ├─vda2                252:2    0   19G  0 part  
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm   [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm   /
  └─vda1                252:1    0    1G  0 part  /boot
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt (RAIDアレイのアンマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mdadm (--misc) --stop /dev/md0 (RAIDアレイの停止)
  
  コマンドの実行結果
  --------------------------------------------------
  [32725.335356] md0: detected capacity change from 103809024 to 0
  [32725.338421] md: md0 stopped.
  mdadm: stopped /dev/md0
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f image[0-1].img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[03]
  RAIDの構築と運用 - 03 (RAID 4)
  
[内容]
  ## 作業内容
    RAIDアレイ(RAID 4)の作成後にマウントする
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン
  
[確認]
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=10M count=10
  vm12$ dd if=/dev/zero of=image1.img bs=10M count=10
  vm12$ dd if=/dev/zero of=image2.img bs=10M count=10
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img
  vm12$ sudo losetup /dev/loop1 image1.img
  vm12$ sudo losetup /dev/loop2 image2.img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mdadm -C /dev/md0 -l 4 -n 3 /dev/loop0 /dev/loop1 /dev/loop2 (RAIDアレイの作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ cat /proc/mdstat (RAIDアレイの確認)
  
  コマンドの実行結果
  --------------------------------------------------
  Personalities : [raid0] [raid1] [raid6] [raid5] [raid4]
  
  md0 : active raid4 loop2[3] loop1[1] loop0[0]
        200704 blocks super 1.2 level 4, 512k chunk, algorithm 0 [3/3] [UUU]
  
  unused devices: <none>
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkfs -t xfs /dev/md0 (RAIDアレイにファイルシステム作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mount -o defaults -t xfs /dev/md0 /mnt (RAIDアレイのマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE  MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom   
  loop0                     7:0    0  100M  0 loop  
  └─md0                   9:0    0  196M  0 raid4 /mnt (RAIDアレイ)
  loop1                     7:1    0  100M  0 loop  
  └─md0                   9:0    0  196M  0 raid4 /mnt (RAIDアレイ)
  loop2                     7:2    0  100M  0 loop  
  └─md0                   9:0    0  196M  0 raid4 /mnt (RAIDアレイ)
  vda                     252:0    0   20G  0 disk  
  ├─vda2                252:2    0   19G  0 part  
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm   [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm   /
  └─vda1                252:1    0    1G  0 part  /boot
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt (RAIDアレイのアンマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mdadm (--misc) --stop /dev/md0 (RAIDアレイの停止)
  
  コマンドの実行結果
  --------------------------------------------------
  [35152.357976] md0: detected capacity change from 205520896 to 0
  [35152.361074] md: md0 stopped.
  mdadm: stopped /dev/md0
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f image[0-2].img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[04]
  RAIDの構築と運用 - 04 (RAID 5)
  
[内容]
  ## 作業内容
    RAIDアレイ(RAID 5)の作成後にマウントする
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン
  
[確認]
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=10M count=10
  vm12$ dd if=/dev/zero of=image1.img bs=10M count=10
  vm12$ dd if=/dev/zero of=image2.img bs=10M count=10
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img
  vm12$ sudo losetup /dev/loop1 image1.img
  vm12$ sudo losetup /dev/loop2 image2.img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mdadm -C /dev/md0 -l 5 -n 3 /dev/loop0 /dev/loop1 /dev/loop2 (RAIDアレイの作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ cat /proc/mdstat (RAIDアレイの確認)
  
  コマンドの実行結果
  --------------------------------------------------
  Personalities : [raid0] [raid1] [raid6] [raid5] [raid4]
  
  md0 : active raid5 loop2[3] loop1[1] loop0[0]
        200704 blocks super 1.2 level 5, 512k chunk, algorithm 2 [3/3] [UUU]
  
  unused devices: <none>
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkfs -t xfs /dev/md0 (RAIDアレイにファイルシステム作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mount -o defaults -t xfs /dev/md0 /mnt (RAIDアレイのマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE  MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom   
  loop0                     7:0    0  100M  0 loop  
  └─md0                   9:0    0  196M  0 raid5 /mnt (RAIDアレイ)
  loop1                     7:1    0  100M  0 loop  
  └─md0                   9:0    0  196M  0 raid5 /mnt (RAIDアレイ)
  loop2                     7:2    0  100M  0 loop  
  └─md0                   9:0    0  196M  0 raid5 /mnt (RAIDアレイ)
  vda                     252:0    0   20G  0 disk  
  ├─vda2                252:2    0   19G  0 part  
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm   [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm   /
  └─vda1                252:1    0    1G  0 part  /boot
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt (RAIDアレイのアンマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mdadm (--misc) --stop /dev/md0 (RAIDアレイの停止)
  
  コマンドの実行結果
  --------------------------------------------------
  [37414.053884] md0: detected capacity change from 205520896 to 0
  [37414.058113] md: md0 stopped.
  mdadm: stopped /dev/md0
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f image[0-2].img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[05]
  RAIDの構築と運用 - 05
  
[内容]
  ## 作業内容
    RAIDアレイ(RAID 5)に対して「--misc」で様々な問合せ
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン
  
[確認]
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=10M count=10
  vm12$ dd if=/dev/zero of=image1.img bs=10M count=10
  vm12$ dd if=/dev/zero of=image2.img bs=10M count=10
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img
  vm12$ sudo losetup /dev/loop1 image1.img
  vm12$ sudo losetup /dev/loop2 image2.img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mdadm -C /dev/md0 -l 5 -n 3 /dev/loop0 /dev/loop1 /dev/loop2 (RAIDアレイの作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ cat /proc/mdstat (RAIDアレイの確認)
  
  コマンドの実行結果
  --------------------------------------------------
  Personalities : [raid0] [raid1] [raid6] [raid5] [raid4]
  
  md0 : active raid5 loop2[3] loop1[1] loop0[0]
        200704 blocks super 1.2 level 5, 512k chunk, algorithm 2 [3/3] [UUU]
  
  unused devices: <none>
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mdadm --misc -Q(--query) /dev/md0 (RAIDアレイの状態)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/md0: 196.00MiB raid5 3 devices, 0 spares. Use mdadm --detail for more detail.
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mdadm --misc -D(--detail) /dev/md0 (RAIDアレイの状態を詳細表示)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/md0:
             Version : 1.2
       Creation Time : Thu Dec 30 20:16:50 2021
          Raid Level : raid5
          Array Size : 200704 (196.00 MiB 205.52 MB)  // 300MB -> RAID5 -> 200MB
       Used Dev Size : 100352 (98.00 MiB 102.76 MB)
        Raid Devices : 3
       Total Devices : 3
         Persistence : Superblock is persistent
         Update Time : Thu Dec 30 20:16:59 2021
               State : clean 
      Active Devices : 3
     Working Devices : 3
      Failed Devices : 0
       Spare Devices : 0
              Layout : left-symmetric
          Chunk Size : 512K
  Consistency Policy : resync
                Name : vm12:0  (local to host vm12)
                UUID : ed63d447:4b582e62:dddebaa4:09e10b7c
              Events : 18

  Number   Major   Minor   RaidDevice State
     0       7        0        0      active sync   /dev/loop0
     1       7        1        1      active sync   /dev/loop1
     3       7        2        2      active sync   /dev/loop2
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mdadm --misc -E(--examine) /dev/md0 (RAIDアレイの構成デバイスの状態)
  
  コマンドの実行結果
  --------------------------------------------------
  mdadm: No md superblock detected on /dev/md0.
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mdadm (--misc) --stop /dev/md0 (RAIDアレイの停止)
  
  コマンドの実行結果
  --------------------------------------------------
  [39057.126761] md0: detected capacity change from 205520896 to 0
  [39057.129506] md: md0 stopped.
  mdadm: stopped /dev/md0
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f image[0-2].img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[06]
  RAIDの構築と運用 - 06
  
[内容]
  ## 作業内容
    RAIDアレイ(RAID 5)に対して「--manage」で予備デバイス操作
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン
  
[確認]
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=10M count=10
  vm12$ dd if=/dev/zero of=image1.img bs=10M count=10
  vm12$ dd if=/dev/zero of=image2.img bs=10M count=10
  vm12$ dd if=/dev/zero of=image3.img bs=10M count=10
  vm12$ dd if=/dev/zero of=image4.img bs=10M count=10
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img
  vm12$ sudo losetup /dev/loop1 image1.img
  vm12$ sudo losetup /dev/loop2 image2.img
  vm12$ sudo losetup /dev/loop3 image3.img
  vm12$ sudo losetup /dev/loop4 image4.img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mdadm -C /dev/md0 -l 5 -n 3 -x 1 /dev/loop0 /dev/loop1 /dev/loop2 /dev/loop3 (RAIDアレイの作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ cat /proc/mdstat (RAIDアレイの確認)
  
  コマンドの実行結果
  --------------------------------------------------
  Personalities : [raid0] [raid1] [raid6] [raid5] [raid4] 

  md0 : active raid5 loop2[4] loop3[3](S) loop1[1] loop0[0]
        200704 blocks super 1.2 level 5, 512k chunk, algorithm 2 [3/3] [UUU]
  
  unused devices: <none>
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mdadm --misc -Q(--query) /dev/md0 (RAIDアレイの状態)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/md0: 196.00MiB raid5 3 devices, 1 spare. Use mdadm --detail for more detail.
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mdadm --misc -D(--detail) /dev/md0 (RAIDアレイの状態を詳細表示)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/md0:
             Version : 1.2
       Creation Time : Thu Dec 30 20:48:01 2021
          Raid Level : raid5
          Array Size : 200704 (196.00 MiB 205.52 MB)
       Used Dev Size : 100352 (98.00 MiB 102.76 MB)
        Raid Devices : 3
       Total Devices : 4
         Persistence : Superblock is persistent
         Update Time : Thu Dec 30 20:48:10 2021
               State : clean 
      Active Devices : 3
     Working Devices : 4
      Failed Devices : 0
       Spare Devices : 1
              Layout : left-symmetric
          Chunk Size : 512K
  Consistency Policy : resync
                Name : vm12:0  (local to host vm12)
                UUID : c2269194:66d72976:c85295a5:285702c8
              Events : 18
  
  Number   Major   Minor   RaidDevice State
     0       7        0        0      active sync   /dev/loop0
     1       7        1        1      active sync   /dev/loop1
     4       7        2        2      active sync   /dev/loop2
     3       7        3        -      spare         /dev/loop3
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mdadm --manage /dev/md0 -f(--fail) /dev/loop0 (RAIDアレイの構成デバイスに不良マーク)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mdadm --misc -D(--detail) /dev/md0 (RAIDアレイの状態を詳細表示)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/md0:
             Version : 1.2
       Creation Time : Thu Dec 30 20:48:01 2021
          Raid Level : raid5
          Array Size : 200704 (196.00 MiB 205.52 MB)
       Used Dev Size : 100352 (98.00 MiB 102.76 MB)
        Raid Devices : 3
       Total Devices : 4
         Persistence : Superblock is persistent
         Update Time : Thu Dec 30 20:55:29 2021
               State : clean 
      Active Devices : 3
     Working Devices : 3
      Failed Devices : 1
       Spare Devices : 0
              Layout : left-symmetric
          Chunk Size : 512K
  Consistency Policy : resync
                Name : vm12:0  (local to host vm12)
                UUID : c2269194:66d72976:c85295a5:285702c8
              Events : 37
  
  Number   Major   Minor   RaidDevice State
     3       7        3        0      active sync   /dev/loop3
     1       7        1        1      active sync   /dev/loop1
     4       7        2        2      active sync   /dev/loop2
     0       7        0        -      faulty        /dev/loop0
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mdadm --manage /dev/md0 -r(--remove) /dev/loop0 (RAIDアレイの構成デバイスから不良デバイスを削除)
  
  コマンドの実行結果
  --------------------------------------------------
  mdadm: hot removed /dev/loop0 from /dev/md0
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mdadm --misc -D(--detail) /dev/md0 (RAIDアレイの状態を詳細表示)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/md0:
             Version : 1.2
       Creation Time : Thu Dec 30 20:48:01 2021
          Raid Level : raid5
          Array Size : 200704 (196.00 MiB 205.52 MB)
       Used Dev Size : 100352 (98.00 MiB 102.76 MB)
        Raid Devices : 3
       Total Devices : 3
         Persistence : Superblock is persistent
         Update Time : Thu Dec 30 21:02:54 2021
               State : clean 
      Active Devices : 3
     Working Devices : 3
      Failed Devices : 0
       Spare Devices : 0
              Layout : left-symmetric
          Chunk Size : 512K
  Consistency Policy : resync
                Name : vm12:0  (local to host vm12)
                UUID : c2269194:66d72976:c85295a5:285702c8
              Events : 38
  
  Number   Major   Minor   RaidDevice State
     3       7        3        0      active sync   /dev/loop3
     1       7        1        1      active sync   /dev/loop1
     4       7        2        2      active sync   /dev/loop2
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mdadm --manage /dev/md0 -a(--add) /dev/loop4 (RAIDアレイの構成デバイスに新デバイスを追加)
  
  コマンドの実行結果
  --------------------------------------------------
  mdadm: added /dev/loop4
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mdadm --misc -D(--detail) /dev/md0 (RAIDアレイの状態を詳細表示)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/md0:
             Version : 1.2
       Creation Time : Thu Dec 30 20:48:01 2021
          Raid Level : raid5
          Array Size : 200704 (196.00 MiB 205.52 MB)
       Used Dev Size : 100352 (98.00 MiB 102.76 MB)
        Raid Devices : 3
       Total Devices : 4
         Persistence : Superblock is persistent
         Update Time : Thu Dec 30 21:06:01 2021
               State : clean 
      Active Devices : 3
     Working Devices : 4
      Failed Devices : 0
       Spare Devices : 1
              Layout : left-symmetric
          Chunk Size : 512K
  Consistency Policy : resync
                Name : vm12:0  (local to host vm12)
                UUID : c2269194:66d72976:c85295a5:285702c8
              Events : 39
  
  Number   Major   Minor   RaidDevice State
     3       7        3        0      active sync   /dev/loop3
     1       7        1        1      active sync   /dev/loop1
     4       7        2        2      active sync   /dev/loop2
     5       7        4        -      spare         /dev/loop4
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mdadm (--misc) --stop /dev/md0 (RAIDアレイの停止)
  
  コマンドの実行結果
  --------------------------------------------------
  [41681.078697] md0: detected capacity change from 205520896 to 0
  [41681.081032] md: md0 stopped.
  mdadm: stopped /dev/md0
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f image[0-4].img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[07]
  LVMの調査
  
[内容]
  ## 作業内容
    仮想マシンのLVMについて調査
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン
  
[確認]
  vm12$ cd $HOME
  vm12$ LANG=C sudo parted /dev/vda -s print (パーティション情報)
  
  コマンドの実行結果
  --------------------------------------------------
  Model: Virtio Block Device (virtblk)
  Disk /dev/vda: 26.8GB
  Sector size (logical/physical): 512B/512B
  Partition Table: msdos
  Disk Flags: 
  
  Number  Start   End     Size    Type     File system  Flags
  1       1049kB  1075MB  1074MB  primary  xfs          boot -> /boot
  2       1075MB  10.7GB  9663MB  primary               lvm  -> LVM を使用
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo lvscan (論理ボリューム探査)
  
  コマンドの実行結果
  --------------------------------------------------
  ACTIVE  '/dev/centos_vm11/swap' [1.00 GiB] inherit
  ACTIVE  '/dev/centos_vm11/root' [<8.00 GiB] inherit
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo vgscan (ボリュームグループ探査)
  
  コマンドの実行結果
  --------------------------------------------------
  Reading volume groups from cache.
  Found volume group "centos_vm11" using metadata type lvm2
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo pvscan (物理ボリューム探査)
  
  コマンドの実行結果
  --------------------------------------------------
  PV /dev/vda2   VG centos_vm11   lvm2 [<9.00 GiB / 0   free]
  ...(省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo pvdisplay /dev/vda2 (物理ボリューム詳細)
  
  コマンドの実行結果
  --------------------------------------------------
  PV Name               /dev/vda2 -> 元になったデバイスファイル名と同一
  VG Name               centos_vm11 -> ボリュームグループ名
  PV Size               <9.00 GiB / not usable 3.00 MiB
  Allocatable           yes (but full)
  PE Size               4.00 MiB
  Total PE              2303
  Free PE               0
  Allocated PE          2303
  PV UUID               YQHJ5V-PC6l-ZdEB-Xv6c-QeZs-23aK-rK4BYj
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[08]
  LVMの作成
  
[内容]
  ## 作業内容
    論理ボリュームの作成後にマウントする
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン
  
[確認]
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=10M count=10
  vm12$ dd if=/dev/zero of=image1.img bs=10M count=10
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img
  vm12$ sudo losetup /dev/loop1 image1.img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo pvcreate /dev/loop0 /dev/loop1 (物理ボリュームの初期化)
  
  コマンドの実行結果
  --------------------------------------------------
  Physical volume "/dev/loop0" successfully created.
  Physical volume "/dev/loop1" successfully created.
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo vgcreate vg0 /dev/loop0 /dev/loop1 (ボリュームグループの作成)
  
  コマンドの実行結果
  --------------------------------------------------
  Volume group "vg0" successfully created
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo lvcreate -L 50M -n lv0 vg0 (論理ボリュームの作成)
  vm12$ sudo lvcreate -L 50M -n lv1 vg0 (論理ボリュームの作成)
  vm12$ sudo lvcreate -L 50M -n lv2 vg0 (論理ボリュームの作成)
  
  コマンドの実行結果
  --------------------------------------------------
  Rounding up size to full physical extent 52.00 MiB
  Logical volume "lv[0-2])" created.
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkfs -t xfs /dev/vg0/lv0 (ファイルシステム作成)
  vm12$ sudo mkfs -t xfs /dev/vg0/lv1 (ファイルシステム作成)
  vm12$ sudo mkfs -t xfs /dev/vg0/lv2 (ファイルシステム作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mount -t xfs -o defaults /dev/vg0/lv0 /mnt/mp0 (論理ボリュームをマウント)
  vm12$ sudo mount -t xfs -o defaults /dev/vg0/lv1 /mnt/mp1 (論理ボリュームをマウント)
  vm12$ sudo mount -t xfs -o defaults /dev/vg0/lv2 /mnt/mp2 (論理ボリュームをマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom  
  loop0                     7:0    0  100M  0 loop 
  ├─vg0-lv0             253:2    0   52M  0 lvm  /mnt/mp0 (論理ボリューム)
  └─vg0-lv2             253:4    0   52M  0 lvm  /mnt/mp2 (論理ボリューム)
  loop1                     7:1    0  100M  0 loop 
  ├─vg0-lv1             253:3    0   52M  0 lvm  /mnt/mp1 (論理ボリューム)
  └─vg0-lv2             253:4    0   52M  0 lvm  /mnt/mp2 (論理ボリューム)
  vda                     252:0    0   20G  0 disk 
  ├─vda2                252:2    0   19G  0 part 
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm  [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm  /
  └─vda1                252:1    0    1G  0 part /boot
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo pvscan (物理ボリュームの表示)
  
  コマンドの実行結果
  --------------------------------------------------
  PV /dev/loop0   VG vg0             lvm2 [96.00 MiB / 0         free]
  PV /dev/loop1   VG vg0             lvm2 [96.00 MiB / 36.00 MiB free]
  PV /dev/vda2    VG centos_vm11     lvm2 [<19.00 GiB / 0    free]
  Total: 3 [19.18 GiB] / in use: 3 [19.18 GiB] / in no VG: 0 [0   ]
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo pvdisplay /dev/loop0 (物理ボリュームの詳細を表示)
  
  コマンドの実行結果
  --------------------------------------------------
  --- Physical volume ---
  PV Name               /dev/loop0
  VG Name               vg0
  PV Size               100.00 MiB / not usable 4.00 MiB
  Allocatable           yes (but full)
  PE Size               4.00 MiB
  Total PE              24
  Free PE               0
  Allocated PE          24
  PV UUID               IJ29N4-unyT-oNyf-asMk-eMqu-Pggt-ybN2hA
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo pvdisplay /dev/loop1 (物理ボリュームの詳細を表示)
  
  コマンドの実行結果
  --------------------------------------------------
  --- Physical volume ---
  PV Name               /dev/loop1
  VG Name               vg0
  PV Size               100.00 MiB / not usable 4.00 MiB
  Allocatable           yes 
  PE Size               4.00 MiB
  Total PE              24
  Free PE               9
  Allocated PE          15
  PV UUID               LHjwwp-oI0Q-QJYi-9Dk1-1fuH-4QqG-lPzPWi
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo vgscan (ボリュームグループの表示)
  
  コマンドの実行結果
  --------------------------------------------------
  Reading volume groups from cache.
  Found volume group "vg0" using metadata type lvm2
  Found volume group "centos_vm11" using metadata type lvm2
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo vgdisplay vg0 (ボリュームグループの詳細を表示)
  
  コマンドの実行結果
  --------------------------------------------------
  --- Volume group ---
  VG Name               vg0
  System ID             
  Format                lvm2
  Metadata Areas        2
  Metadata Sequence No  4
  VG Access             read/write
  VG Status             resizable
  MAX LV                0
  Cur LV                3
  Open LV               3
  Max PV                0
  Cur PV                2
  Act PV                2
  VG Size               192.00 MiB
  PE Size               4.00 MiB
  Total PE              48
  Alloc PE / Size       39 / 156.00 MiB
  Free  PE / Size       9 / 36.00 MiB
  VG UUID               cJyLdQ-mgAW-gL45-g8at-N9Wk-ygWM-zC2mJh
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo lvscan (論理ボリュームの表示)
  
  コマンドの実行結果
  --------------------------------------------------
  ACTIVE            '/dev/vg0/lv0' [52.00 MiB] inherit
  ACTIVE            '/dev/vg0/lv1' [52.00 MiB] inherit
  ACTIVE            '/dev/vg0/lv2' [52.00 MiB] inherit
  ACTIVE            '/dev/centos_vm11/swap' [2.00 GiB] inherit
  ACTIVE            '/dev/centos_vm11/root' [<17.00 GiB] inherit
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo lvdisplay /dev/vg0/lv0 (論理ボリュームの詳細を表示)
  
  コマンドの実行結果
  --------------------------------------------------
  --- Logical volume ---
  LV Path                /dev/vg0/lv0
  LV Name                lv0
  VG Name                vg0
  LV UUID                TPNFXd-lFc3-dQUy-l4uf-F3CD-jHHg-pOIdqV
  LV Write Access        read/write
  LV Creation host, time vm12, 2021-12-31 07:41:20 +0900
  LV Status              available
  # open                 1
  LV Size                52.00 MiB
  Current LE             13
  Segments               1
  Allocation             inherit
  Read ahead sectors     auto
  - currently set to     8192
  Block device           253:2
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo lvdisplay /dev/vg0/lv1 (論理ボリュームの詳細を表示)
  
  コマンドの実行結果
  --------------------------------------------------
  --- Logical volume ---
  LV Path                /dev/vg0/lv1
  LV Name                lv1
  VG Name                vg0
  LV UUID                JyFnhh-H72W-VlJ2-x8aK-OmMJ-a6WE-oG9iEI
  LV Write Access        read/write
  LV Creation host, time vm12, 2021-12-31 07:41:35 +0900
  LV Status              available
  # open                 1
  LV Size                52.00 MiB
  Current LE             13
  Segments               1
  Allocation             inherit
  Read ahead sectors     auto
  - currently set to     8192
  Block device           253:3
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo lvdisplay /dev/vg0/lv2 (論理ボリュームの詳細を表示)
  
  コマンドの実行結果
  --------------------------------------------------
  --- Logical volume ---
  LV Path                /dev/vg0/lv2
  LV Name                lv2
  VG Name                vg0
  LV UUID                2Ygyop-ciIa-4wgD-ns1T-mSTz-L0JK-vqDevD
  LV Write Access        read/write
  LV Creation host, time vm12, 2021-12-31 07:41:48 +0900
  LV Status              available
  # open                 1
  LV Size                52.00 MiB
  Current LE             13
  Segments               2
  Allocation             inherit
  Read ahead sectors     auto
  - currently set to     8192
  Block device           253:4
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt/mp0 (論理ボリュームのアンマウント)
  vm12$ sudo umount /mnt/mp1 (論理ボリュームのアンマウント)
  vm12$ sudo umount /mnt/mp2 (論理ボリュームのアンマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo lvremove /dev/vg0/lv0 (論理ボリュームの削除)
  vm12$ sudo lvremove /dev/vg0/lv1 (論理ボリュームの削除)
  vm12$ sudo lvremove /dev/vg0/lv2 (論理ボリュームの削除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo vgremove vg0 (ボリュームグループの削除)
  
  コマンドの実行結果
  --------------------------------------------------
  Volume group "vg0" successfully removed
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo pvremove /dev/loop0 /dev/loop1 (物理ボリュームの削除)
  
  コマンドの実行結果
  --------------------------------------------------
  Labels on physical volume "/dev/loop0" successfully wiped.
  Labels on physical volume "/dev/loop1" successfully wiped.
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f image[0-1].img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[09]
  LVMの管理 - 01 (ボリュームグループの拡張・縮小)
  
[内容]
  ## 作業内容
    論理ボリュームがマウント状態での、ボリュームグループの拡張・縮小を試してみる
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン
  
[確認]
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=10M count=10
  vm12$ dd if=/dev/zero of=image1.img bs=10M count=10
  vm12$ dd if=/dev/zero of=image2.img bs=10M count=10
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img
  vm12$ sudo losetup /dev/loop1 image1.img
  vm12$ sudo losetup /dev/loop2 image2.img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo pvcreate /dev/loop0 /dev/loop1 /dev/loop2 (物理ボリュームの初期化)
  
  コマンドの実行結果
  --------------------------------------------------
  Physical volume "/dev/loop0" successfully created.
  Physical volume "/dev/loop1" successfully created.
  Physical volume "/dev/loop2" successfully created.
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo vgcreate vg0 /dev/loop0 /dev/loop1 (ボリュームグループの作成)
  
  コマンドの実行結果
  --------------------------------------------------
  Volume group "vg0" successfully created
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo lvcreate -L 50M -n lv0 vg0 (論理ボリュームの作成)
  vm12$ sudo lvcreate -L 50M -n lv1 vg0 (論理ボリュームの作成)
  vm12$ sudo lvcreate -L 50M -n lv2 vg0 (論理ボリュームの作成)
  
  コマンドの実行結果
  --------------------------------------------------
  Rounding up size to full physical extent 52.00 MiB
  Logical volume "lv[0-2])" created.
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkfs -t xfs /dev/vg0/lv0 (ファイルシステム作成)
  vm12$ sudo mkfs -t xfs /dev/vg0/lv1 (ファイルシステム作成)
  vm12$ sudo mkfs -t xfs /dev/vg0/lv2 (ファイルシステム作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mount -t xfs -o defaults /dev/vg0/lv0 /mnt/mp0 (論理ボリュームをマウント)
  vm12$ sudo mount -t xfs -o defaults /dev/vg0/lv1 /mnt/mp1 (論理ボリュームをマウント)
  vm12$ sudo mount -t xfs -o defaults /dev/vg0/lv2 /mnt/mp2 (論理ボリュームをマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom  
  loop0                     7:0    0  100M  0 loop 
  ├─vg0-lv0             253:2    0   52M  0 lvm  /mnt/mp0 (論理ボリューム)
  └─vg0-lv2             253:4    0   52M  0 lvm  /mnt/mp2 (論理ボリューム)
  loop1                     7:1    0  100M  0 loop 
  ├─vg0-lv1             253:3    0   52M  0 lvm  /mnt/mp1 (論理ボリューム)
  └─vg0-lv2             253:4    0   52M  0 lvm  /mnt/mp2 (論理ボリューム)
  vda                     252:0    0   20G  0 disk 
  ├─vda2                252:2    0   19G  0 part 
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm  [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm  /
  └─vda1                252:1    0    1G  0 part /boot
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo vgreduce vg0 /dev/loop0 (ボリュームグループの縮小)
  
  コマンドの実行結果
  --------------------------------------------------
  Physical volume "/dev/loop0" still in use -> 使用中の物理ボリュームは削除不可
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo vgextend vg0 /dev/loop2 (ボリュームグループの拡張)
  
  コマンドの実行結果
  --------------------------------------------------
  Volume group "vg0" successfully extended
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo vgdisplay vg0 (ボリュームグループの詳細を表示)
  
  コマンドの実行結果
  --------------------------------------------------
  --- Volume group ---
  VG Name               vg0
  System ID             
  Format                lvm2
  Metadata Areas        3
  Metadata Sequence No  5
  VG Access             read/write
  VG Status             resizable
  MAX LV                0
  Cur LV                3
  Open LV               3
  Max PV                0
  Cur PV                3 -> /dev/loop0, /dev/loop1, /dev/loop2
  Act PV                3 -> /dev/loop0, /dev/loop1, /dev/loop2
  VG Size               288.00 MiB
  PE Size               4.00 MiB
  Total PE              72
  Alloc PE / Size       39 / 156.00 MiB
  Free  PE / Size       33 / 132.00 MiB
  VG UUID               lSbGFy-N0fQ-apEE-uXDy-LE9y-APQx-kqB10O
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt/mp0 (論理ボリュームのアンマウント)
  vm12$ sudo umount /mnt/mp1 (論理ボリュームのアンマウント)
  vm12$ sudo umount /mnt/mp2 (論理ボリュームのアンマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo lvremove /dev/vg0/lv0 (論理ボリュームの削除)
  vm12$ sudo lvremove /dev/vg0/lv1 (論理ボリュームの削除)
  vm12$ sudo lvremove /dev/vg0/lv2 (論理ボリュームの削除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo vgremove vg0 (ボリュームグループの削除)
  
  コマンドの実行結果
  --------------------------------------------------
  Volume group "vg0" successfully removed
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo pvremove /dev/loop0 /dev/loop1 /dev/loop2 (物理ボリュームの削除)
  
  コマンドの実行結果
  --------------------------------------------------
  Labels on physical volume "/dev/loop0" successfully wiped.
  Labels on physical volume "/dev/loop1" successfully wiped.
  Labels on physical volume "/dev/loop2" successfully wiped.
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f image[0-2].img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[10]
  LVMの管理 - 02 (論理ボリュームの拡張・縮小)
  
[内容]
  ## 作業内容
    論理ボリュームがマウント状態での、論理ボリュームの拡張・縮小を試してみる
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン
  
[確認]
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=10M count=10
  vm12$ dd if=/dev/zero of=image1.img bs=10M count=10
  vm12$ dd if=/dev/zero of=image2.img bs=10M count=10
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img
  vm12$ sudo losetup /dev/loop1 image1.img
  vm12$ sudo losetup /dev/loop2 image2.img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo pvcreate /dev/loop0 /dev/loop1 /dev/loop2 (物理ボリュームの初期化)
  
  コマンドの実行結果
  --------------------------------------------------
  Physical volume "/dev/loop0" successfully created.
  Physical volume "/dev/loop1" successfully created.
  Physical volume "/dev/loop2" successfully created.
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo vgcreate vg0 /dev/loop0 /dev/loop1 /dev/loop2 (ボリュームグループの作成)
  
  コマンドの実行結果
  --------------------------------------------------
  Volume group "vg0" successfully created
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo lvcreate -L 50M -n lv0 vg0 (論理ボリュームの作成)
  vm12$ sudo lvcreate -L 50M -n lv1 vg0 (論理ボリュームの作成)
  vm12$ sudo lvcreate -L 50M -n lv2 vg0 (論理ボリュームの作成)
  
  コマンドの実行結果
  --------------------------------------------------
  Rounding up size to full physical extent 52.00 MiB
  Logical volume "lv[0-2])" created.
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkfs -t xfs /dev/vg0/lv0 (ファイルシステム作成)
  vm12$ sudo mkfs -t xfs /dev/vg0/lv1 (ファイルシステム作成)
  vm12$ sudo mkfs -t xfs /dev/vg0/lv2 (ファイルシステム作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mount -t xfs -o defaults /dev/vg0/lv0 /mnt/mp0 (論理ボリュームをマウント)
  vm12$ sudo mount -t xfs -o defaults /dev/vg0/lv1 /mnt/mp1 (論理ボリュームをマウント)
  vm12$ sudo mount -t xfs -o defaults /dev/vg0/lv2 /mnt/mp2 (論理ボリュームをマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom  
  loop0                     7:0    0  100M  0 loop 
  └─vg0-lv0             253:2    0   52M  0 lvm  /mnt/mp0 (論理ボリューム)
  loop1                     7:1    0  100M  0 loop 
  └─vg0-lv1             253:3    0   52M  0 lvm  /mnt/mp1 (論理ボリューム)
  loop2                     7:2    0  100M  0 loop 
  └─vg0-lv2             253:4    0   52M  0 lvm  /mnt/mp2 (論理ボリューム)
  vda                     252:0    0   20G  0 disk 
  ├─vda2                252:2    0   19G  0 part 
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm  [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm  /
  └─vda1                252:1    0    1G  0 part /boot
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo lvreduce -L 20M /dev/vg0/lv0 (論理ボリュームの縮小)
  
  コマンドの実行結果
  --------------------------------------------------
  WARNING: Reducing active and open logical volume to 20.00 MiB.
  THIS MAY DESTROY YOUR DATA (filesystem etc.)
  Do you really want to reduce vg0/lv0? [y/n]: y  (マウント状態でも論理ボリュームのサイズ縮小は可能)
  Size of logical volume vg0/lv0 changed from 52.00 MiB (13 extents) to 20.00 MiB (5 extents).
  Logical volume vg0/lv0 successfully resized.
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo lvdisplay /dev/vg0/lv0 (論理ボリュームの詳細を表示)
  
  コマンドの実行結果
  --------------------------------------------------
  --- Logical volume ---
  LV Path                /dev/vg0/lv0
  LV Name                lv0
  VG Name                vg0
  LV UUID                n6zkj9-Rszr-cSjk-ViSI-ZFst-by7L-KCwhea
  LV Write Access        read/write
  LV Creation host, time vm12, 2021-12-31 12:05:25 +0900
  LV Status              available
  # open                 1
  LV Size                20.00 MiB (指定したサイズに縮小)
  Current LE             5
  Segments               1
  Allocation             inherit
  Read ahead sectors     auto
  - currently set to     8192
  Block device           253:2
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo lvextend -L 60M /dev/vg0/lv0 (論理ボリュームの拡張)
  
  コマンドの実行結果
  --------------------------------------------------
  Size of logical volume vg0/lv0 changed from 20.00 MiB (5 extents) to 60.00 MiB (15 extents).
  Logical volume vg0/lv0 successfully resized.
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo lvdisplay /dev/vg0/lv0 (論理ボリュームの詳細を表示)
  
  コマンドの実行結果
  --------------------------------------------------
  --- Logical volume ---
  LV Path                /dev/vg0/lv0
  LV Name                lv0
  VG Name                vg0
  LV UUID                n6zkj9-Rszr-cSjk-ViSI-ZFst-by7L-KCwhea
  LV Write Access        read/write
  LV Creation host, time vm12, 2021-12-31 12:05:25 +0900
  LV Status              available
  # open                 1
  LV Size                60.00 MiB (指定したサイズに拡張)
  Current LE             15
  Segments               1
  Allocation             inherit
  Read ahead sectors     auto
  - currently set to     8192
  Block device           253:2
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt/mp0 (論理ボリュームのアンマウント)
  vm12$ sudo umount /mnt/mp1 (論理ボリュームのアンマウント)
  vm12$ sudo umount /mnt/mp2 (論理ボリュームのアンマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo lvremove /dev/vg0/lv0 (論理ボリュームの削除)
  vm12$ sudo lvremove /dev/vg0/lv1 (論理ボリュームの削除)
  vm12$ sudo lvremove /dev/vg0/lv2 (論理ボリュームの削除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo vgremove vg0 (ボリュームグループの削除)
  
  コマンドの実行結果
  --------------------------------------------------
  Volume group "vg0" successfully removed
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo pvremove /dev/loop0 /dev/loop1 /dev/loop2 (物理ボリュームの削除)
  
  コマンドの実行結果
  --------------------------------------------------
  Labels on physical volume "/dev/loop0" successfully wiped.
  Labels on physical volume "/dev/loop1" successfully wiped.
  Labels on physical volume "/dev/loop2" successfully wiped.
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f image[0-2].img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[11]
  LVMの管理 - 03 (スナップショット)
  
[内容]
  ## 作業内容
    論理ボリュームがマウント状態での、スナップショット作成と復元を試してみる
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン
  
[確認]
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=10M count=10
  vm12$ dd if=/dev/zero of=image1.img bs=10M count=10
  vm12$ dd if=/dev/zero of=image2.img bs=10M count=10
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img
  vm12$ sudo losetup /dev/loop1 image1.img
  vm12$ sudo losetup /dev/loop2 image2.img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo pvcreate /dev/loop0 /dev/loop1 /dev/loop2 (物理ボリュームの初期化)
  
  コマンドの実行結果
  --------------------------------------------------
  Physical volume "/dev/loop0" successfully created.
  Physical volume "/dev/loop1" successfully created.
  Physical volume "/dev/loop2" successfully created.
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo vgcreate vg0 /dev/loop0 /dev/loop1 /dev/loop2 (ボリュームグループの作成)
  
  コマンドの実行結果
  --------------------------------------------------
  Volume group "vg0" successfully created
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo lvcreate -L 50M -n lv0 vg0 (論理ボリュームの作成)
  vm12$ sudo lvcreate -L 50M -n lv1 vg0 (論理ボリュームの作成)
  vm12$ sudo lvcreate -L 50M -n lv2 vg0 (論理ボリュームの作成)
  
  コマンドの実行結果
  --------------------------------------------------
  Rounding up size to full physical extent 52.00 MiB
  Logical volume "lv[0-2])" created.
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkfs -t xfs /dev/vg0/lv0 (ファイルシステム作成)
  vm12$ sudo mkfs -t xfs /dev/vg0/lv1 (ファイルシステム作成)
  vm12$ sudo mkfs -t xfs /dev/vg0/lv2 (ファイルシステム作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mount -t xfs -o defaults /dev/vg0/lv0 /mnt/mp0 (論理ボリュームをマウント)
  vm12$ sudo mount -t xfs -o defaults /dev/vg0/lv1 /mnt/mp1 (論理ボリュームをマウント)
  vm12$ sudo mount -t xfs -o defaults /dev/vg0/lv2 /mnt/mp2 (論理ボリュームをマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom  
  loop0                     7:0    0  100M  0 loop 
  └─vg0-lv0             253:2    0   52M  0 lvm  /mnt/mp0 (論理ボリューム)
  loop1                     7:1    0  100M  0 loop 
  └─vg0-lv1             253:3    0   52M  0 lvm  /mnt/mp1 (論理ボリューム)
  loop2                     7:2    0  100M  0 loop 
  └─vg0-lv2             253:4    0   52M  0 lvm  /mnt/mp2 (論理ボリューム)
  vda                     252:0    0   20G  0 disk 
  ├─vda2                252:2    0   19G  0 part 
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm  [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm  /
  └─vda1                252:1    0    1G  0 part /boot
  --------------------------------------------------
  
  vm12$ cd /mnt/mp0
  vm12$ sudo touch sample1.txt (論理ボリュームにファイル作成)
  vm12$ sudo touch sample2.txt (論理ボリュームにファイル作成)
  vm12$ sudo touch sample3.txt (論理ボリュームにファイル作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo lvcreate -s -L 20M -n sp0 /dev/vg0/lv0 (論理ボリュームのスナップショット作成)
  
  コマンドの実行結果
  --------------------------------------------------
  Logical volume "sp0" created.
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo lvscan (論理ボリュームとスナップショットの確認)
  
  コマンドの実行結果
  --------------------------------------------------
  ACTIVE   Original '/dev/vg0/lv0' [52.00 MiB] inherit (論理ボリューム)
  ACTIVE            '/dev/vg0/lv1' [52.00 MiB] inherit
  ACTIVE            '/dev/vg0/lv2' [52.00 MiB] inherit
  ACTIVE   Snapshot '/dev/vg0/sp0' [20.00 MiB] inherit (スナップショット)
  ACTIVE            '/dev/centos_vm11/swap' [2.00 GiB] inherit
  ACTIVE            '/dev/centos_vm11/root' [<17.00 GiB] inherit
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo lvdisplay /dev/vg0/lv0 (論理ボリュームの詳細を表示)
  
  コマンドの実行結果
  --------------------------------------------------
  --- Logical volume ---
  LV Path                /dev/vg0/lv0
  LV Name                lv0
  VG Name                vg0
  LV UUID                MmnyQX-cxHc-wkPH-zJXX-XaEy-QVae-j9fSOJ
  LV Write Access        read/write
  LV Creation host, time vm12, 2021-12-31 18:26:19 +0900
  LV snapshot status     source of
                         sp0 [active]
  LV Status              available
  # open                 1
  LV Size                52.00 MiB
  Current LE             13
  Segments               1
  Allocation             inherit
  Read ahead sectors     auto
  - currently set to     8192
  Block device           253:2
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo lvdisplay /dev/vg0/sp0 (スナップショットの詳細を表示)
  
  コマンドの実行結果
  --------------------------------------------------
  --- Logical volume ---
  LV Path                /dev/vg0/sp0
  LV Name                sp0
  VG Name                vg0
  LV UUID                h9ZVqx-axhE-kL7v-k8vi-rZgn-B1u7-MRmEeF
  LV Write Access        read/write
  LV Creation host, time vm12, 2021-12-31 18:30:05 +0900
  LV snapshot status     active destination for lv0
  LV Status              available
  # open                 0
  LV Size                52.00 MiB
  Current LE             13
  COW-table size         20.00 MiB
  COW-table LE           5
  Allocated to snapshot  0.10%
  Snapshot chunk size    4.00 KiB
  Segments               1
  Allocation             inherit
  Read ahead sectors     auto
  - currently set to     8192
  Block device           253:7
  --------------------------------------------------
  
  vm12$ cd /mnt/mp0
  vm12$ sudo rm sample2.txt (論理ボリュームからファイル削除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd /mnt/mp0
  vm12$ sudo ls -lh (論理ボリュームのファイル一覧)
  
  コマンドの実行結果
  --------------------------------------------------
  -rw-r--r--. 1 root root 0 12月 31 18:29 sample1.txt
  -rw-r--r--. 1 root root 0 12月 31 18:29 sample3.txt
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt/mp0 (スナップショットを作成した論理ボリュームのアンマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo lvconvert --merge /dev/vg0/sp0 (スナップショットを使用して論理ボリュームを復元)
  
  コマンドの実行結果
  --------------------------------------------------
  Merging of volume vg0/sp0 started.
  vg0/lv0: Merged: 100.00%
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mount -t xfs -o defaults /dev/vg0/lv0 /mnt/mp0 (論理ボリュームをマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd /mnt/mp0
  vm12$ sudo ls -lh (論理ボリュームのファイル一覧)
  
  コマンドの実行結果
  --------------------------------------------------
  -rw-r--r--. 1 root root 0 12月 31 18:29 sample1.txt
  -rw-r--r--. 1 root root 0 12月 31 18:29 sample2.txt  // 削除したファイルが復元
  -rw-r--r--. 1 root root 0 12月 31 18:29 sample3.txt
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo lvscan (論理ボリュームとスナップショットの確認)
  
  コマンドの実行結果
  --------------------------------------------------
  ACTIVE            '/dev/vg0/lv0' [52.00 MiB] inherit  // スナップショットは復元作業に使用され無くなっている
  ACTIVE            '/dev/vg0/lv1' [52.00 MiB] inherit
  ACTIVE            '/dev/vg0/lv2' [52.00 MiB] inherit
  ACTIVE            '/dev/centos_vm11/swap' [2.00 GiB] inherit
  ACTIVE            '/dev/centos_vm11/root' [<17.00 GiB] inherit
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt/mp0 (論理ボリュームのアンマウント)
  vm12$ sudo umount /mnt/mp1 (論理ボリュームのアンマウント)
  vm12$ sudo umount /mnt/mp2 (論理ボリュームのアンマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo lvremove /dev/vg0/lv0 (論理ボリュームの削除)
  vm12$ sudo lvremove /dev/vg0/lv1 (論理ボリュームの削除)
  vm12$ sudo lvremove /dev/vg0/lv2 (論理ボリュームの削除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo vgremove vg0 (ボリュームグループの削除)
  
  コマンドの実行結果
  --------------------------------------------------
  Volume group "vg0" successfully removed
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo pvremove /dev/loop0 /dev/loop1 /dev/loop2 (物理ボリュームの削除)
  
  コマンドの実行結果
  --------------------------------------------------
  Labels on physical volume "/dev/loop0" successfully wiped.
  Labels on physical volume "/dev/loop1" successfully wiped.
  Labels on physical volume "/dev/loop2" successfully wiped.
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f image[0-2].img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[12]
  ハードディスクの管理
  
[内容]
  ## 作業内容
    ハードディスクのパラメータ確認
  
  ## 使用マシン
    HOST : localhost
    IPV4 : 192.168.1.3
    MEMO : ホスト
  
  ## コマンド(sdparm)
    sdparm -q                        // 冒頭のプロファイル非表示
    sdparm -a(--all) XX              // ハードディスク(XX)の全情報表示
    sdparm -C=CMD(--command=CMD) XX  // ハードディスク(XX)にコマンド(CMD)実行
  
[確認]
  $ cd $HOME
  $ lsblk
  
  コマンドの実行結果
  --------------------------------------------------
  NAME              MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
  sda                 8:0    0 465.8G  0 disk (対象ハードディスク) -> /dev/sda なのでコマンド「sdparm」を使用
  ├─sda1            8:1    0     1G  0 part /boot
  └─sda2            8:2    0 464.8G  0 part 
    ├─centos-root 253:0    0    50G  0 lvm  /
    ├─centos-swap 253:1    0   3.6G  0 lvm  [SWAP]
    └─centos-home 253:2    0 411.1G  0 lvm  /home
  sr0                11:0    1  1024M  0 rom  
  loop0               7:0    0  99.4M  1 loop /var/lib/snapd/snap/core/11993
  loop1               7:1    0 104.6M  1 loop /var/lib/snapd/snap/brackets/138
  --------------------------------------------------
  
  $ cd $HOME
  $ sudo yum -y install sdparm (パッケージ追加)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> エラー出力が無ければOK
  --------------------------------------------------
  
  $ cd $HOME
  $ sudo sdparm -q /dev/sda (ハードディスクのパラメータ確認)
  
  コマンドの実行結果
  --------------------------------------------------
  Read write error recovery mode page:
    AWRE        1  [cha: n, def:  1]
    ARRE        0  [cha: n, def:  0]
    PER         0  [cha: n, def:  0]
  Caching (SBC) mode page:
    WCE         1  [cha: y, def:  1]
    RCD         0  [cha: n, def:  0]
  Control mode page:
    SWP         0  [cha: n, def:  0]
  --------------------------------------------------
  
  $ cd $HOME
  $ sudo sdparm -a /dev/sda (ハードディスクの全てのパラメータ確認)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/sda: ATA  WDC WD5000BEVT-2  1A01
  
  Read write error recovery mode page:
    AWRE        1  [cha: n, def:  1]
    ARRE        0  [cha: n, def:  0]
    TB          0  [cha: n, def:  0]
    RC          0  [cha: n, def:  0]
    EER         0  [cha: n, def:  0]
    PER         0  [cha: n, def:  0]
    DTE         0  [cha: n, def:  0]
    DCR         0  [cha: n, def:  0]
    RRC         0  [cha: n, def:  0]
    COR_S       0  [cha: n, def:  0]
    HOC         0  [cha: n, def:  0]
    DSOC        0  [cha: n, def:  0]
    LBPERE      0  [cha: n, def:  0]
    WRC         0  [cha: n, def:  0]
    RTL         0  [cha: n, def:  0]
  Caching (SBC) mode page:
    IC          0  [cha: n, def:  0]
    ABPF        0  [cha: n, def:  0]
    CAP         0  [cha: n, def:  0]
    DISC        0  [cha: n, def:  0]
    SIZE        0  [cha: n, def:  0]
    WCE         1  [cha: y, def:  1]
    MF          0  [cha: n, def:  0]
    RCD         0  [cha: n, def:  0]
    DRRP        0  [cha: n, def:  0]
    WRP         0  [cha: n, def:  0]
    DPTL        0  [cha: n, def:  0]
    MIPF        0  [cha: n, def:  0]
    MAPF        0  [cha: n, def:  0]
    MAPFC       0  [cha: n, def:  0]
    FSW         0  [cha: n, def:  0]
    LBCSS       0  [cha: n, def:  0]
    DRA         0  [cha: n, def:  0]
    SYNC_PROG   0  [cha: n, def:  0]
    NV_DIS      0  [cha: n, def:  0]
    NCS         0  [cha: n, def:  0]
    CSS         0  [cha: n, def:  0]
  Control mode page:
    TST         0  [cha: n, def:  0]
    TMF_ONLY    0  [cha: n, def:  0]
    DPICZ       0  [cha: n, def:  0]
    D_SENSE     0  [cha: n, def:  0]
    GLTSD       1  [cha: n, def:  1]
    RLEC        0  [cha: n, def:  0]
    QAM         0  [cha: n, def:  0]
    NUAR        0  [cha: n, def:  0]
    QERR        0  [cha: n, def:  0]
    RAC         0  [cha: n, def:  0]
    UA_INTLCK   0  [cha: n, def:  0]
    SWP         0  [cha: n, def:  0]
    ATO         0  [cha: n, def:  0]
    TAS         0  [cha: n, def:  0]
    ATMPE       0  [cha: n, def:  0]
    RWWP        0  [cha: n, def:  0]
    AUTOLOAD    0  [cha: n, def:  0]
    BTP        -1  [cha: n, def: -1]
    ESTCT      30  [cha: n, def: 30]
  --------------------------------------------------
  
  $ cd $HOME
  $ sudo sdparm --command=capacity /dev/sda (ハードディスクのブロック数・ブロックサイズを表示)
  
  コマンドの実行結果
  --------------------------------------------------
  blocks: 976773168       // ブロック数
  block_length: 512       // ブロックサイズ
  capacity_mib: 476940.0  // ブロックサイズ × ブロック数 (MB)
  --------------------------------------------------
  
  $ cd $HOME
  $ sudo sdparm --command=profile /dev/sda (ハードディスクのプロファイルを表示)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/sda: ATA  WDC WD5000BEVT-2  1A01
  --------------------------------------------------
  
  $ cd $HOME
  $ sudo sdparm -q --command=ready /dev/sda (ハードディスクの生死確認)
  
  コマンドの実行結果
  --------------------------------------------------
  Ready  // 稼働中 -> 非稼動は「Not Ready」
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[13]
  SSD
  
[内容]
  ## 作業内容
    ハードディスクがHDDかSSDか確認する
  
  ## 使用マシン
    HOST : localhost
    IPV4 : 192.168.1.3
    MEMO : ホスト
  
[確認]
  $ cd $HOME
  $ lsblk
  
  コマンドの実行結果
  --------------------------------------------------
  NAME              MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
  sda                 8:0    0 465.8G  0 disk (対象ハードディスク)
  ├─sda1            8:1    0     1G  0 part /boot
  └─sda2            8:2    0 464.8G  0 part 
    ├─centos-root 253:0    0    50G  0 lvm  /
    ├─centos-swap 253:1    0   3.6G  0 lvm  [SWAP]
    └─centos-home 253:2    0 411.1G  0 lvm  /home
  sr0                11:0    1  1024M  0 rom  
  loop0               7:0    0  99.4M  1 loop /var/lib/snapd/snap/core/11993
  loop1               7:1    0 104.6M  1 loop /var/lib/snapd/snap/brackets/138
  --------------------------------------------------
  
  $ cd $HOME
  $ cat /sys/block/sda/queue/rotational (ハードディスクがHDDかSSDか判別)
  
  コマンドの実行結果
  --------------------------------------------------
  1  // HDD -> (0 = SSD)
  --------------------------------------------------
  
  $ cd $HOME
  $ lsblk -o name,rota (ハードディスクがHDDかSSDか判別)
  
  コマンドの実行結果
  --------------------------------------------------
  NAME            ROTA
  sda                1 (HDD)
  ├─sda1           1
  └─sda2           1
    ├─centos-root  1
    ├─centos-swap  1
    └─centos-home  1
  sr0                1
  loop0              1
  loop1              1
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[14]
  iSCSI
  
[内容]
  ## 作業内容
    論理ボリュームを「ターゲット」で公開、クライアントは「イニシエータ」として論理ボリュームにアクセス
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン
  
  ## 使用マシン
    HOST : vm13
    IPV4 : 192.168.122.13
    MEMO : 仮想マシン
  
[確認]
  vm12$ cd $HOME
  vm12$ sudo yum -y install targetcli (パッケージ追加)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> エラー出力が無ければOK
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=10M count=10
  vm12$ dd if=/dev/zero of=image1.img bs=10M count=10
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img
  vm12$ sudo losetup /dev/loop1 image1.img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo pvcreate /dev/loop0 /dev/loop1 (物理ボリュームの初期化)
  
  コマンドの実行結果
  --------------------------------------------------
  Physical volume "/dev/loop0" successfully created.
  Physical volume "/dev/loop1" successfully created.
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo vgcreate vg0 /dev/loop0 /dev/loop1 (ボリュームグループの作成)
  
  コマンドの実行結果
  --------------------------------------------------
  Volume group "vg0" successfully created
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo lvcreate -L 150M -n lv0 vg0 (論理ボリュームの作成)
  
  コマンドの実行結果
  --------------------------------------------------
  Rounding up size to full physical extent 152.00 MiB
  Logical volume "lv0" created.
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkfs -t xfs /dev/vg0/lv0 (ファイルシステム作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom  
  loop0                     7:0    0  100M  0 loop 
  └─vg0-lv0             253:2    0  152M  0 lvm  (論理ボリューム) -> ターゲットで公開
  loop1                     7:1    0  100M  0 loop 
  └─vg0-lv0             253:2    0  152M  0 lvm  (論理ボリューム) -> ターゲットで公開
  vda                     252:0    0   20G  0 disk 
  ├─vda2                252:2    0   19G  0 part 
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm  [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm  /
  └─vda1                252:1    0    1G  0 part /boot
  --------------------------------------------------
    
    vm13$ cd $HOME
    vm13$ sudo yum -y install iscsi-initiator-utils (パッケージ追加)
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> エラー出力が無ければOK
    --------------------------------------------------
    
    vm13$ cd 4HOME
    vm13$ cat /etc/iscsi/initiatorname.iscsi
    
    コマンドの実行結果
    --------------------------------------------------
    InitiatorName=iqn.1994-05.com.redhat:c414cbf6048
    --------------------------------------------------
    
  vm12$ cd $HOME
  vm12$ sudo targetcli ls (ターゲット設定項目を確認)
  
  コマンドの実行結果
  --------------------------------------------------
  o- /  [...]
    o- backstores  [...]
    | o- block  [Storage Objects: 0]    // 公開ディスク -> 論理ボリュームを指定
    | o- fileio  [Storage Objects: 0]   // 不明
    | o- pscsi  [Storage Objects: 0]    // 不明
    | o- ramdisk  [Storage Objects: 0]  // 不明
    o- iscsi  [Targets: 0]              // ターゲット識別名(IQN)
    o- loopback  [Targets: 0]
  --------------------------------------------------
  
  設定項目
  ==================================================
  /backstores/block       // 公開ディスク
  /iscsi                  // ターゲット識別名(IQN)
  /iscsi/(IQN)/tpg1/luns  // IQNと公開ディスクの紐づけ
  /iscsi/(IQN)/tpg1/acls  // ACL
  ==================================================
  
  vm12$ cd $HOME
  vm12$ sudo targetcli /backstores/block create name=vm12-lv0 dev=/dev/vg0/lv0 (公開ディスクに論理ボリュームを指定)
  
  コマンドの実行結果
  --------------------------------------------------
  Created block storage object vm12-lv0 using /dev/vg0/lv0.
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo targetcli /iscsi create iqn.2022-01.com.test:vm12-share01 (ターゲット識別名(IQN)を指定)
  
  コマンドの実行結果
  --------------------------------------------------
  Created target iqn.2022-01.com.test:vm12-share01.
  Created TPG 1.
  Global pref auto_add_default_portal=true
  Created default portal listening on all IPs (0.0.0.0), port 3260.
  --------------------------------------------------
  
  vm12$ cd $HOME (公開ディスクとターゲット識別名(IQN)を紐付け)
  vm12$ sudo targetcli /iscsi/iqn.2022-01.com.test:vm12-share01/tpg1/luns create /backstores/block/vm12-lv0
  
  コマンドの実行結果
  --------------------------------------------------
  Created LUN 0.
  --------------------------------------------------
  
  vm12$ cd $HOME (アクセス可能なiSCSIイニシエータ名を登録)
  vm12$ sudo targetcli /iscsi/iqn.2022-01.com.test:vm12-share01/tpg1/acls create iqn.1994-05.com.redhat:c414cbf6048
  
  コマンドの実行結果
  --------------------------------------------------
  Created Node ACL for iqn.1994-05.com.redhat:c414cbf6048
  Created mapped LUN 0.
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo targetcli ls (ターゲット設定項目を確認)
  
  コマンドの実行結果
  --------------------------------------------------
  o- /  [...]
    o- backstores  [...]
    | o- block  [Storage Objects: 1]
    | | o- vm12-lv0  [/dev/vg0/lv0 (152.0MiB) write-thru activated]
    | |   o- alua  [ALUA Groups: 1]
    | |     o- default_tg_pt_gp  [ALUA state: Active/optimized]
    | o- fileio  [Storage Objects: 0]
    | o- pscsi  [Storage Objects: 0]
    | o- ramdisk  [Storage Objects: 0]
    o- iscsi  [Targets: 1]
    | o- iqn.2022-01.com.test:vm12-share01  [TPGs: 1]
    |   o- tpg1  [no-gen-acls, no-auth]
    |     o- acls  [ACLs: 1]
    |     | o- iqn.1994-05.com.redhat:c414cbf6048  [Mapped LUNs: 1]
    |     |   o- mapped_lun0  [lun0 block/vm12-lv0 (rw)]
    |     o- luns  [LUNs: 1]
    |     | o- lun0  [block/vm12-lv0 (/dev/vg0/lv0) (default_tg_pt_gp)]
    |     o- portals  [Portals: 1]
    |       o- 0.0.0.0:3260  [OK]
    o- loopback  [Targets: 0]
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo targetcli saveconfig (ターゲット設定項目を保存)
  
  コマンドの実行結果
  --------------------------------------------------
  Configuration saved to /etc/target/saveconfig.json
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo firewall-cmd --add-service=iscsi-target --permanent (ファイアーウォールにサービス追加)
  
  コマンドの実行結果
  --------------------------------------------------
  success
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo firewall-cmd --reload (ファイアーウォールに設定反映)
  
  コマンドの実行結果
  --------------------------------------------------
  sudo firewall-cmd --reload
  --------------------------------------------------

  vm12$ cd $HOME
  vm12$ sudo systemctl restart target (サービスの再起動)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
    
    vm13$ cd $HOME
    vm13$ sudo iscsiadm -m discovery -t sendtargets -p 192.168.122.12 (ターゲットの検索)
    
    コマンドの実行結果
    --------------------------------------------------
    192.168.122.12:3260,1 iqn.2022-01.com.test:vm12-share01
    --------------------------------------------------
    
    vm13$ cd $HOME
    vm13$ sudo iscsiadm -m node --login (ターゲットへログイン)
    
    コマンドの実行結果
    --------------------------------------------------
    Logging in to [iface: default, target: iqn.2022-01.com.test:vm12-share01, portal: 192.168.122.12,3260] (multiple)
    [ 1989.601720] scsi host3: iSCSI Initiator over TCP/IP
    [ 1989.624565] scsi 3:0:0:0: Direct-Access  LIO-ORG  vm12-lv0  4.0  PQ: 0 ANSI: 5
    [ 1989.634149] scsi 3:0:0:0: alua: supports implicit and explicit TPGS
    [ 1989.637647] scsi 3:0:0:0: alua: device naa.6001405048207d816dc4d1c8c3c583ca port group 0 rel port 1
    [ 1989.641837] scsi 3:0:0:0: alua: Attached
    [ 1989.650066] scsi 3:0:0:0: Attached scsi generic sg1 type 0

    Login to [iface: default, target: iqn.2022-01.com.test:vm12-share01, portal: 192.168.122.12,3260] successful.
    [ 1989.668595] scsi 3:0:0:0: alua: transition timeout set to 60 seconds
    [ 1989.671805] scsi 3:0:0:0: alua: port group 00 state A non-preferred supports TOlUSNA
    [ 1989.758311] sd 3:0:0:0: [sda] 311296 512-byte logical blocks: (159 MB/152 MiB)
    [ 1989.769250] sd 3:0:0:0: [sda] Write Protect is off
    [ 1989.779919] sd 3:0:0:0: [sda] Write cache: enabled, read cache: enabled, supports DPO and FUA
    [ 1989.802495] sd 3:0:0:0: [sda] Optimal transfer size 1310720 bytes
    [ 1989.821147] sd 3:0:0:0: [sda] Attached SCSI disk
    --------------------------------------------------
    
    vm13$ cd $HOME
    vm13$ lsblk (ターゲットのデバイスを確認)
    
    コマンドの実行結果
    --------------------------------------------------
    NAME                   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
    sda                      8:0    0  152M  0 disk (ターゲットのデバイス)
    sr0                     11:0    1 1024M  0 rom  
    vda                    252:0    0   20G  0 disk 
    ├─vda1               252:1    0    1G  0 part /boot
    └─vda2               252:2    0   19G  0 part 
      ├─centos_vm11-root 253:0    0   17G  0 lvm  /
      └─centos_vm11-swap 253:1    0    2G  0 lvm  [SWAP]
    --------------------------------------------------
    
    vm13$ cd $HOME
    vm13$ lsblk -S (SCSIデバイスのみ表示)
    
    コマンドの実行結果
    --------------------------------------------------
    NAME HCTL       TYPE VENDOR   MODEL            REV  TRAN
    sda  3:0:0:0    disk LIO-ORG  vm12-lv0         4.0  iscsi (ターゲットのデバイス)
    sr0  0:0:0:0    rom  QEMU     QEMU DVD-ROM     1.5. ata
    --------------------------------------------------
    
    vm13$ cd $HOME
    vm13$ sudo mount -o defaults -t xfs /dev/sda /mnt (ターゲットのデバイスをマウント)
    
    コマンドの実行結果
    --------------------------------------------------
    (省略)
    --------------------------------------------------
    
    vm13$ cd $HOME
    vm13$ lsblk (ターゲットのデバイスを確認)
    
    コマンドの実行結果
    --------------------------------------------------
    NAME                   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
    sda                      8:0    0  152M  0 disk /mnt (ターゲットのデバイス)
    sr0                     11:0    1 1024M  0 rom  
    vda                    252:0    0   20G  0 disk 
    ├─vda1               252:1    0    1G  0 part /boot
    └─vda2               252:2    0   19G  0 part 
      ├─centos_vm11-root 253:0    0   17G  0 lvm  /
      └─centos_vm11-swap 253:1    0    2G  0 lvm  [SWAP]
    --------------------------------------------------
    
    vm13$ cd /mnt
    vm13$ sudo touch sample1.txt (ターゲットのデバイスにファイル作成)
    vm13$ sudo touch sample2.txt (ターゲットのデバイスにファイル作成)
    vm13$ sudo touch sample3.txt (ターゲットのデバイスにファイル作成)
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm13$ cd $HOME
    vm13$ sudo umount /mnt (ターゲットのデバイスをアンマウント)
    
    コマンドの実行結果
    --------------------------------------------------
    (省略)
    --------------------------------------------------
    
    vm13$ cd $HOME
    vm13$ sudo iscsiadm -m node --logoutall=all (ターゲットからログアウト)
    
    コマンドの実行結果
    --------------------------------------------------
    Logging out of session [sid: 2, target: iqn.2022-01.com.test:vm12-share01, portal: 192.168.122.12,3260]
    [ 3168.662855] sd 3:0:0:0: alua: Detached
    [ 3168.674589] sd 3:0:0:0: [sda] Synchronizing SCSI cache
    Logout of [sid: 2, target: iqn.2022-01.com.test:vm12-share01, portal: 192.168.122.12,3260] successful.
    --------------------------------------------------
    
    vm13$ cd $HOME
    vm13$ sudo systemctl disable iscsi (サービスの自動起動を無効化)
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 無効化しないと起動時にターゲットへの検索・ログイン処理が実行される
    --------------------------------------------------
    
  vm12$ cd $HOME
  vm12$ sudo targetcli clearconfig confirm=True (ターゲットの初期化)
  
  コマンドの実行結果
  --------------------------------------------------
  All configuration cleared
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo systemctl stop target (サービスの停止)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mount -o defaults -t xfs /dev/vg0/lv0 /mnt (論理ボリュームのマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom  
  loop0                     7:0    0  100M  0 loop 
  └─vg0-lv0             253:2    0  152M  0 lvm  /mnt (論理ボリューム)
  loop1                     7:1    0  100M  0 loop 
  └─vg0-lv0             253:2    0  152M  0 lvm  /mnt (論理ボリューム)
  vda                     252:0    0   20G  0 disk 
  ├─vda2                252:2    0   19G  0 part 
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm  [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm  /
  └─vda1                252:1    0    1G  0 part /boot
  --------------------------------------------------
  
  vm12$ cd /mnt
  vm12$ ls -lh
  
  コマンドの実行結果
  --------------------------------------------------
  -rw-r--r--. 1 root root 0  1月  1 21:07 sample1.txt
  -rw-r--r--. 1 root root 0  1月  1 21:07 sample2.txt
  -rw-r--r--. 1 root root 0  1月  1 21:08 sample3.txt
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt (論理ボリュームのアンマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo lvremove /dev/vg0/lv0 (論理ボリュームの削除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo vgremove vg0 (ボリュームグループの削除)
  
  コマンドの実行結果
  --------------------------------------------------
  Volume group "vg0" successfully removed
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo pvremove /dev/loop0 /dev/loop1 (物理ボリュームの削除)
  
  コマンドの実行結果
  --------------------------------------------------
  Labels on physical volume "/dev/loop0" successfully wiped.
  Labels on physical volume "/dev/loop1" successfully wiped.
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f image[0-1].img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
