================================================================================
[01] ソースの展開 - 01 (tar-gzip)
[02] ソースの展開 - 02 (tar-bzip2)
[03] ソースの展開 - 03 (tar-xz)
[04] ソースの展開 - 04 (patch)
[05] コンパイルとインストール
[06] ローカルでのバックアップ - 01 (tar)
[07] ローカルでのバックアップ - 02 (cpio)
[08] ローカルでのバックアップ - 03 (dd)
[09] ローカルでのバックアップ - 04 (dump-restore)
[10] ローカルでのバックアップ - 05 (mt)
[11] ネットワーク経由でのバックアップ - 01
[12] ネットワーク経由でのバックアップ - 02
[13] ログイン前後のメッセージ - 01 (/etc/issue)
[14] ログイン前後のメッセージ - 02 (/etc/motd)
================================================================================
[01]
  ソースの展開 - 01 (tar-gzip)
  
[内容]
  ## ファイル(source)の展開
  
  ==========================================================
                          source
  ==========================================================
            |                                    |
            + tar -cf source.tar source          |
            |                                    |
  ======================                         |
       source.tar                                + tar zcf source.tar.gz source
  ======================                         |
            |                                    |
            + gzip source.tar                    |
            |                                    |
  ==========================================================
                      source.tar.gz
  ==========================================================
            |                                    |
            + gunzip source.tar.gz               |
            |  (gzip -d source.tar.gz)           |
  ======================                         |
       source.tar                                + tar zxf source.tar.gz
  ======================                         |
            |                                    |
            + tar xf source.tar                  |
            |                                    |
  ==========================================================
                          source
  ==========================================================
  
[確認]
  実機での確認なし
  
================================================================================
[02]
  ソースの展開 - 02 (tar-bzip2)
  
[内容]
  ## ファイル(source)の展開

  ==========================================================
                          source
  ==========================================================
            |                                    |
            + tar -cf source.tar source          |
            |                                    |
  ======================                         |
       source.tar                                + tar jcf source.tar.bz2 source
  ======================                         |
            |                                    |
            + bzip2 source.tar                   |
            |                                    |
  ==========================================================
                      source.tar.bz2
  ==========================================================
            |                                    |
            + bunzip2 source.tar.bz2             |
            |  (bzip2 -d source.tar.bz2)         |
  ======================                         |
       source.tar                                + tar jxf source.tar.bz2
  ======================                         |
            |                                    |
            + tar xf source.tar                  |
            |                                    |
  ==========================================================
                          source
  ==========================================================
  
[確認]
  実機での確認なし
  
================================================================================
[03]
  ソースの展開 - 03 (tar-xz)
  
[内容]
  ## ファイル(source)の展開
  
  ==========================================================
                          source
  ==========================================================
            |                                    |
            + tar -cf source.tar source          |
            |                                    |
  ======================                         |
       source.tar                                + tar Jcf source.tar.xz source
  ======================                         |
            |                                    |
            + xz source.tar                      |
            |                                    |
  ==========================================================
                      source.tar.xz
  ==========================================================
            |                                    |
            + unxz source.tar.xz                 |
            |  (xz -d source.tar.xz)             |
  ======================                         |
       source.tar                                + tar Jxf source.tar.xz
  ======================                         |
            |                                    |
            + tar xf source.tar                  |
            |                                    |
  ==========================================================
                          source
  ==========================================================
  
[確認]
  実機での確認なし
  
================================================================================
[04]
  ソースの展開 - 04 (patch)
  
[内容]
  ## 作業内容
    ソースの修正部分(パッチ)の反映をコマンド(patch)で行う
  
  ## 使用マシン
    HOST : vm11
    IPV4 : 192.168.1.11
    MEMO : 仮想マシン
  
  ## コマンド(patch)
    patch -R           : 処理内容を取り消して元に戻す
    patch -p0 XX < YY  : ファイル(XX)にパッチ(YY=patch/AAA)の差分を適用、パスを修正しない   -> patch/AAA
    patch -p1 XX < YY  : ファイル(XX)にパッチ(YY=patch/AAA)の差分を適用、最初の'/'まで削除  -> AAA
    
[確認]
  vm11$ cd $HOME
  vm11$ vi sample5/file1.txt
  
  コマンドの実行結果
  --------------------------------------------------
  AAA
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ cp -p sample5/file1.txt .(カレントディレクトリ)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ vi file1.txt
  
  コマンドの実行結果
  --------------------------------------------------
  AAA
  BBB (追加)
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ diff -u sample5/file1.txt(修正前) file1.txt(修正後) > patch1 -> パッチファイル作成
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ rm -f sample1.txt -> 修正後のファイル削除
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ cat patch1 -> パッチファイル確認
  
  コマンドの実行結果
  --------------------------------------------------
  --- sample5/file1.txt	2023-04-21 12:34:29.517289461 +0900  -> 修正前
  +++ file1.txt	2023-04-21 12:36:21.439895861 +0900 -> 修正後、おそらく処理中では参照されていない
  @@ -1 +1,2 @@
   AAA
  +BBB
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo yum -y install tree
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> エラー出力が無ければOK
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ tree
  
  コマンドの実行結果
  --------------------------------------------------
  |-- file1.txt -> 既に削除済だがあえて記述
  |-- patch1
  |-- sample5
       |-- file1.txt
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ patch -p0 < patch1 -> パッチ適用
  
  コマンドの実行結果
  --------------------------------------------------
  patching file sample5/file1.txt
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ cat sample5/file1.txt
  
  コマンドの実行結果
  --------------------------------------------------
  AAA
  BBB (反映)
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ patch -R -p0 < patch1 -> パッチ適用を取消
  
  コマンドの実行結果
  --------------------------------------------------
  patching file sample5/file1.txt
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ cat sample5/file1.txt
  
  コマンドの実行結果
  --------------------------------------------------
  AAA (修正前に戻った)
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ tree
  
  コマンドの実行結果
  --------------------------------------------------
  |-- file1.txt -> 既に削除済だがあえて記述
  |-- patch1
  |-- sample5
       |-- file1.txt
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ cat patch1
  
  コマンドの実行結果
  --------------------------------------------------
  --- sample5/file1.txt	2023-04-21 12:34:29.517289461 +0900  -> 修正前
  +++ file1.txt	2023-04-21 12:36:21.439895861 +0900 -> 修正後、おそらく処理中では参照されていない
  @@ -1 +1,2 @@
   AAA
  +BBB
  --------------------------------------------------
  
  vm11$ cd $HOME/sample5
  vm11$ patch -p1 < ../patch1 -> 修正前のパス「sample5/file1.txt」を「file1.txt」に変更
  
  コマンドの実行結果
  --------------------------------------------------
  patching file file1.txt
  --------------------------------------------------
  
  vm11$ cd $HOME/sample5
  vm11$ cat file1.txt
  
  コマンドの実行結果
  --------------------------------------------------
  AAA
  BBB (反映)
  --------------------------------------------------
  
  vm11$ cd $HOME/sample5
  vm11$ patch -R -p1 < ../patch1 -> パッチ適用を取消
  
  コマンドの実行結果
  --------------------------------------------------
  patching file file1.txt
  --------------------------------------------------
  
  vm11$ cd $HOME/sample5
  vm11$ cat file1.txt
  
  コマンドの実行結果
  --------------------------------------------------
  AAA (修正前に戻った)
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[05]
  コンパイルとインストール
  
[内容]
  ## 作業内容
    サンプル(GNU-Hello)のソース取得・Makefile作成・コンパイル・インストール・実行までを行う
  
  ## 使用マシン
    HOST : vm11
    IPV4 : 192.168.122.11
    MEMO : 仮想マシン
  
[確認]
  vm11$ cd $HOME
  vm11$ wget --no-check-certificate https://ftp.gnu.org/gnu/hello/hello-2.10.tar.gz
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 相手の証明書が期限切れだったのでリスクはあるが…証明書チェックをせずに続行した
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ tar zxf hello-2.10.tar.gz
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME/hello-2.10
  vm11$ ls
  
  コマンドの実行結果
  --------------------------------------------------
  ABOUT-NLS      GNUmakefile    README         aclocal.m4     contrib        maint.mk
  AUTHORS        INSTALL        README-dev     build-aux      doc            man
  COPYING        Makefile.am    README-release config.in      hello.1        po
  ChangeLog      Makefile.in    THANKS         configure      lib            src
  ChangeLog.O    NEWS           TODO           configure.ac   m4             tests
  --------------------------------------------------
  
  vm11$ cd $HOME/hello-2.10
  vm11$ cat README
  
  コマンドの実行結果
  --------------------------------------------------
  -- 省略 --

  // コンパイルとインストールはファイル(INSTALL*)を参照
  See the files ./INSTALL* for building and installation instructions.
  
  -- 省略 --
  --------------------------------------------------
  
  vm11$ cd $HOME/hello-2.10
  vm11$ cat INSTALL
  
  コマンドの実行結果
  --------------------------------------------------
  -- 省略 --
  
  // コンパイルとインストールの手順
  Briefly, the shell command `./configure && make && make install' should configure, build, and install this package.

  -- 省略 --
  --------------------------------------------------
  
  vm11$ cd $HOME/hello-2.10
  vm11$ ./configure
  
  コマンドの実行結果
  --------------------------------------------------
  checking for a BSD-compatible install... /bin/install -c
  checking whether build environment is sane... yes
  checking for a thread-safe mkdir -p... /bin/mkdir -p
  checking for gawk... gawk
  checking whether make sets $(MAKE)... yes
  checking whether make supports nested variables... yes
  checking for gcc... gcc
  checking whether the C compiler works... yes
  checking for C compiler default output file name... a.out
  checking for suffix of executables... 
  
  -- 省略 --
  
  checking where the gettext function comes from... libc
  checking that generated files are newer than configure... done
  configure: creating ./config.status
  config.status: creating Makefile  // Makefile作成
  config.status: creating po/Makefile.in
  config.status: creating config.h
  config.status: executing depfiles commands
  config.status: executing po-directories commands
  config.status: creating po/POTFILES
  config.status: creating po/Makefile
  --------------------------------------------------
  
  vm11$ cd $HOME/hello-2.10
  vm11$ grep -E '^clean:' Makefile -> ターゲット検索
  
  コマンドの実行結果
  --------------------------------------------------
  clean: clean-recursive
  --------------------------------------------------
  
  vm11$ cd $HOME/hello-2.10
  vm11$ grep -E '^uninstall:' Makefile -> ターゲット検索
  
  コマンドの実行結果
  --------------------------------------------------
  uninstall: uninstall-recursive
  --------------------------------------------------
  
  vm11$ cd $HOME/hello-2.10
  vm11$ make
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 実行ファイル「hello」が生成された
  --------------------------------------------------
  
  vm11$ cd $HOME/hello-2.10
  vm11$ sudo make install
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> root権限が必要な場所に書き込む場合もあるので「sudo」使用
  --------------------------------------------------
  
  vm11$ cd $HOME/hello-2.10
  vm11$ which hello
  
  コマンドの実行結果
  --------------------------------------------------
  /usr/local/bin/hello -> ディレクトリ「/usr/local/bin」配下はパスが通るためプロンプトに「hello」と入力して実行可能
  --------------------------------------------------
  
  vm11$ cd $HOME/hello-2.10
  vm11$ hello
  
  コマンドの実行結果
  --------------------------------------------------
  世界よ、こんにちは！ -> システム言語に合わせて出力
  --------------------------------------------------
  
  vm11$ cd $HOME/hello-2.10
  vm11$ make clean -> コンパイル時に生成された不要ファイル削除
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm11$ cd $HOME/hello-2.10
  vm11$ sudo make uninstall -> アンインストール
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm11$ cd $HOME/hello-2.10
  vm11$ which hello
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> hello が見つからないとエラー出力
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[06]
  ローカルでのバックアップ - 01 (tar)
  
[内容]
  ## 作業内容
    バックアップをコマンド(tar)で行う
  
  ## 使用マシン
    HOST : vm11
    IPV4 : 192.168.122.11
    MEMO : 仮想マシン
  
  ## コマンド(tar)
    tar -c  : アーカイブ作成
    tar -x  : アーカイブ展開
    tar -t  : アーカイブ内のファイル表示
    tar -f  : アーカイブ指定
    tar -z  : gzipによる圧縮と解凍
    tar -j  : bzip2による圧縮と解凍
    tar -J  : xzによる圧縮と解凍
    tar -v  : 詳細情報を表示
    tar -p  : パーミッション保持
    tar -u  : アーカイブ内のファイルより新しいファイルのみアーカイブに追加
    tar -r  : ファイルをアーカイブに追加
    tar -C  : 処理開始前に指定ディレクトリに移動
    tar -N  : 指定日付より新しいファイルのみ対象
    tar -M  : 複数デバイスへ分割
    tar -P  : パス先頭の「/」を削除しない
    tar -W  : アーカイブ書込後に照合
    tar --delete  : アーカイブからファイル削除
  
[確認]
  vm11$ cd $HOME
  vm11$ ls -lh hello -> 以前作成したファイル群
  
  コマンドの実行結果
  --------------------------------------------------
  -rw-rw-r--. 1 makoto makoto 265  4月 29 13:20 Makefile
  -rw-rw-r--. 1 makoto makoto 157  4月 29 13:19 hello.c
  -rw-rw-r--. 1 makoto makoto 134  4月 29 13:18 hello.h
  -rw-rw-r--. 1 makoto makoto 109  4月 29 13:19 main.c
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ tar -cvf hello.tar hello/* -> アーカイブ作成
  
  コマンドの実行結果
  --------------------------------------------------
  hello/Makefile
  hello/hello.c
  hello/hello.h
  hello/main.c
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ tar -tvf hello.tar -> アーカイブ内を閲覧
  
  コマンドの実行結果
  --------------------------------------------------
  -rw-rw-r-- makoto/makoto   265 2023-04-29 13:20 hello/Makefile
  -rw-rw-r-- makoto/makoto   157 2023-04-29 13:19 hello/hello.c
  -rw-rw-r-- makoto/makoto   134 2023-04-29 13:18 hello/hello.h
  -rw-rw-r-- makoto/makoto   109 2023-04-29 13:19 hello/main.c
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ tar -C hello -rvf hello.tar Makefile hello.h hello.c main.c -> ディレクトリ移動、アーカイブ追加
  
  コマンドの実行結果
  --------------------------------------------------
  Makefile
  hello.h
  hello.c
  main.c
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ tar -tvf hello.tar -> アーカイブ内を閲覧
  
  コマンドの実行結果
  --------------------------------------------------
  -rw-rw-r-- makoto/makoto   265 2023-04-29 13:20 hello/Makefile
  -rw-rw-r-- makoto/makoto   157 2023-04-29 13:19 hello/hello.c
  -rw-rw-r-- makoto/makoto   134 2023-04-29 13:18 hello/hello.h
  -rw-rw-r-- makoto/makoto   109 2023-04-29 13:19 hello/main.c
  -rw-rw-r-- makoto/makoto   265 2023-04-29 13:20 Makefile
  -rw-rw-r-- makoto/makoto   134 2023-04-29 13:18 hello.h
  -rw-rw-r-- makoto/makoto   157 2023-04-29 13:19 hello.c
  -rw-rw-r-- makoto/makoto   109 2023-04-29 13:19 main.c
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ tar --delete Makefile hello.h hello.c main.c -vf hello.tar -> アーカイブから削除
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ tar -tvf hello.tar -> アーカイブ内を閲覧
  
  コマンドの実行結果
  --------------------------------------------------
  -rw-rw-r-- makoto/makoto   265 2023-04-29 13:20 hello/Makefile
  -rw-rw-r-- makoto/makoto   157 2023-04-29 13:19 hello/hello.c
  -rw-rw-r-- makoto/makoto   134 2023-04-29 13:18 hello/hello.h
  -rw-rw-r-- makoto/makoto   109 2023-04-29 13:19 hello/main.c
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[07]
  ローカルでのバックアップ - 02 (cpio)
  
[内容]
  ## 作業内容
    バックアップをコマンド(cpio)で行う
  
  ## 使用マシン
    HOST : vm11
    IPV4 : 192.168.122.11
    MEMO : 仮想マシン
  
  ## コマンド(cpio)
    cpio -o : アーカイブを作成
    cpio -i : アーカイブからファイル抽出
    cpio -d : 必要ならばディレクトリ作成

    ls XX | cpio -o -v -F YY     : ファイル(XX)をアーカイブ(YY)にコピー
    ls XX | cpio -o -v -F YY -A  : ファイル(XX)をアーカイブ(YY)に追加

    cat XX | cpio -i    : アーカイブ(XX)からファイル抽出
    cat XX | cpio -i -t : アーカイブ(XX)からファイル抽出、内容を一覧表示
    cat XX | cpio -i -v : アーカイブ(XX)からファイル抽出、ファイル名を一覧表示
  
[確認]
  vm11$ cd $HOME
  vm11$ ls -lh hello -> 以前作成したファイル群
  
  コマンドの実行結果
  --------------------------------------------------
  -rw-rw-r--. 1 makoto makoto 265  4月 29 13:20 Makefile
  -rw-rw-r--. 1 makoto makoto 157  4月 29 13:19 hello.c
  -rw-rw-r--. 1 makoto makoto 134  4月 29 13:18 hello.h
  -rw-rw-r--. 1 makoto makoto 109  4月 29 13:19 main.c
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ ls hello/*.c | cpio -o -v -F hello.cpio -> アーカイブ作成、ファイル名を出力
  
  コマンドの実行結果
  --------------------------------------------------
  hello/hello.c
  hello/main.c
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ cat hello.cpio | cpio -i -t -> アーカイブ内のファイル確認
  
  コマンドの実行結果
  --------------------------------------------------
  hello/hello.c
  hello/main.c
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ ls hello/Makefile | cpio -o -v -F hello.cpio -A -> アーカイブにファイル追加
  vm11$ ls hello/hello.h | cpio -o -v -F hello.cpio -A -> アーカイブにファイル追加
  
  コマンドの実行結果
  --------------------------------------------------
  hello/Makefile
  hello/hello.h
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ cat hello.cpio | cpio -i -t -> アーカイブ内のファイル確認
  
  コマンドの実行結果
  --------------------------------------------------
  hello/hello.c
  hello/main.c
  hello/Makefile
  hello/hello.h
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ rm -rf hello
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ cat hello.cpio | cpio -i -d -> アーカイブからファイル抽出
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ ls -lh hello
  
  コマンドの実行結果
  --------------------------------------------------
  -rw-rw-r--. 1 makoto makoto 265  5月  3 10:53 Makefile
  -rw-rw-r--. 1 makoto makoto 157  5月  3 10:53 hello.c
  -rw-rw-r--. 1 makoto makoto 134  5月  3 10:53 hello.h
  -rw-rw-r--. 1 makoto makoto 109  5月  3 10:53 main.c
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ cat hello.cpio | cpio -i -t
  
  コマンドの実行結果
  --------------------------------------------------
  hello/hello.c
  hello/main.c
  hello/Makefile
  hello/hello.h
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[08]
  ローカルでのバックアップ - 03 (dd)
  
[内容]
  ## 作業内容
    バックアップをコマンド(dd)で行う
  
  ## 使用マシン
    HOST : vm11
    IPV4 : 192.168.122.11
    MEMO : 仮想マシン
  
  ## コマンド(dd)
    dd if=XX     : 入力側ファイル(XX : デフォルトは標準入力)
    dd of=XX     : 出力側ファイル(XX : デフォルトは標準出力)
    dd bs=XX     : 入出力ブロックサイズ(XX)
    dd count=XX  : 回数(XX)分のブロックをコピー
  
[確認]
  vm11$ cd $HOME/hello -> 以前作成したファイル群
  vm11$ ls -lh
  
  コマンドの実行結果
  --------------------------------------------------
  -rw-rw-r--. 1 makoto makoto 265  4月 16 07:42 Makefile
  -rw-rw-r--. 1 makoto makoto 123  4月 16 07:39 hello.c
  -rw-rw-r--. 1 makoto makoto  64  4月 16 07:34 hello.h
  -rw-rw-r--. 1 makoto makoto  75  4月 16 07:37 main.c
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ mkdir temp3
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ LANG=C dd if=hello/hello.c of=temp3/hello.c -> ファイル単位でコピー
  
  コマンドの実行結果
  --------------------------------------------------
  0+1 records in
  0+1 records out
  123 bytes (123 B) copied, 0.00350602 s, 35.1 kB/s
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ diff hello/hello.c temp3/hello.c
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[09]
  ローカルでのバックアップ - 04 (dump-restore)
  
[内容]
  ## 作業内容
    バックアップをコマンド(dump)で行い、リストアをコマンド(restore)で行う
  
  ## 使用マシン
    HOST : vm11
    IPV4 : 192.168.122.11
    MEMO : 仮想マシン
  
  ## コマンド(dump)
    dump -(0-9)  : ダンプレベル
    dump -u      : バックアップ時にファイル「/etc/dumpdates」更新
    dump -f XX   : デバイス(XX)を指定
  
  ## コマンド(restore)
    restore -r     : 全ファイルを取り出す
    restore -i     : 対話的にファイルを取り出す
    restore -f XX  : デバイス(XX)を指定
  
[確認]
  vm11$ cd $HOME
  vm11$ sudo yum -y install dump
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> エラー出力が無ければOK
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ LANG=C dd if=/dev/zero of=image0.img bs=10M count=5
  
  コマンドの実行結果
  --------------------------------------------------
  5+0 records in
  5+0 records out
  52428800 bytes (52 MB) copied, 0.0713719 s, 735 MB/s
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo losetup /dev/loop0 image0.img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo mkfs -t ext4 /dev/loop0
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo mount -o defaults -t ext4 /dev/loop0 /mnt
  
  コマンドの実行結果
  --------------------------------------------------
  [ 4058.290721] EXT4-fs (loop0): mounted filesystem with ordered data mode. Opts: (null)
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ lsblk
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                        MAJ:MIN  RM   SIZE  RO  TYPE  MOUNTPOINT
  vdb                         252:16    0     2G   0  disk  
   |-- vdb2                   252:18    0   975M   0  part  
   |-- vdb1                   252:17    0     1G   0  part  
  sr0                          11:0     1  1024M   0  rom   
  loop0                         7:0     0    50M   0  loop  /mnt -> マウントしたデバイス
  vda                         252:0     0    20G   0  disk  
   |-- vda1                   252:1     0     1G   0  part  /boot
   |-- vda2                   252:2     0    19G   0  part  
        |-- centos_vm11-root  253:0     0    17G   0  lvm   /
        |-- centos_vm11-swap  253:1     0     2G   0  lvm   [SWAP]
  --------------------------------------------------
  
  vm11$ cd /mnt
  vm11$ sudo touch sample1.txt
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo umount /mnt
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo dump -0 -u(記録ファイル更新) -f level0.dmp /dev/loop0 -> 全体バックアップ(レベル0)
  
  コマンドの実行結果
  --------------------------------------------------
  DUMP: Date of this level 0 dump: Fri Apr 21 18:40:12 2023
  DUMP: Dumping /dev/loop0 (an unlisted file system) to level0.dmp
  DUMP: Label: none
  DUMP: Writing 10 Kilobyte records
  DUMP: mapping (Pass I) [regular files]
  DUMP: mapping (Pass II) [directories]
  DUMP: estimated 26 blocks.
  DUMP: Volume 1 started with block 1 at: Fri Apr 21 18:40:12 2023
  DUMP: dumping (Pass III) [directories]
  DUMP: dumping (Pass IV) [regular files]
  DUMP: Closing level0.dmp
  DUMP: Volume 1 completed at: Fri Apr 21 18:40:12 2023
  DUMP: Volume 1 20 blocks (0.02MB)
  DUMP: 20 blocks (0.02MB) on 1 volume(s)
  DUMP: finished in less than a second
  DUMP: Date of this level 0 dump: Fri Apr 21 18:40:12 2023
  DUMP: Date this dump completed:  Fri Apr 21 18:40:12 2023
  DUMP: Average transfer rate: 0 kB/s
  DUMP: DUMP IS DONE
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ cat /etc/dumpdates -> 記録ファイル
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/loop0 0 Fri Apr 21 18:40:12 2023 +0900
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo mount -o defaults -t ext4 /dev/loop0 /mnt
  
  コマンドの実行結果
  --------------------------------------------------
  [ 5054.938781] EXT4-fs (loop0): mounted filesystem with ordered data mode. Opts: (null)
  --------------------------------------------------
  
  vm11$ cd /mnt
  vm11$ sudo touch sample2.txt
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo umount /mnt
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo dump -1 -u(記録ファイル更新) -f level1.dmp /dev/loop0 -> 増分バックアップ(レベル1)
  
  コマンドの実行結果
  --------------------------------------------------
  DUMP: Date of this level 1 dump: Fri Apr 21 18:50:28 2023
  DUMP: Date of last level 0 dump: Fri Apr 21 18:40:12 2023
  DUMP: Dumping /dev/loop0 (an unlisted file system) to level1.dmp
  DUMP: Label: none
  DUMP: Writing 10 Kilobyte records
  DUMP: mapping (Pass I) [regular files]
  DUMP: mapping (Pass II) [directories]
  DUMP: estimated 19 blocks.
  DUMP: Volume 1 started with block 1 at: Fri Apr 21 18:50:28 2023
  DUMP: dumping (Pass III) [directories]
  DUMP: dumping (Pass IV) [regular files]
  DUMP: Closing level1.dmp
  DUMP: Volume 1 completed at: Fri Apr 21 18:50:28 2023
  DUMP: Volume 1 20 blocks (0.02MB)
  DUMP: 20 blocks (0.02MB) on 1 volume(s)
  DUMP: finished in less than a second
  DUMP: Date of this level 1 dump: Fri Apr 21 18:50:28 2023
  DUMP: Date this dump completed:  Fri Apr 21 18:50:28 2023
  DUMP: Average transfer rate: 0 kB/s
  DUMP: DUMP IS DONE
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ cat /etc/dumpdates -> 記録ファイル
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/loop0 0 Fri Apr 21 18:40:12 2023 +0900
  /dev/loop0 1 Fri Apr 21 18:50:28 2023 +0900
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo mount -o defaults -t ext4 /dev/loop0 /mnt
  
  コマンドの実行結果
  --------------------------------------------------
  [ 5404.829147] EXT4-fs (loop0): mounted filesystem with ordered data mode. Opts: (null)
  --------------------------------------------------
  
  vm11$ cd /mnt
  vm11$ sudo touch sample3.txt
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo umount /mnt
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo dump -2 -u(記録ファイル更新) -f level2.dmp /dev/loop0 -> 増分バックアップ(レベル2)
  
  コマンドの実行結果
  --------------------------------------------------
  DUMP: Date of this level 2 dump: Fri Apr 21 18:55:53 2023
  DUMP: Date of last level 1 dump: Fri Apr 21 18:50:28 2023
  DUMP: Dumping /dev/loop0 (an unlisted file system) to level2.dmp
  DUMP: Label: none
  DUMP: Writing 10 Kilobyte records
  DUMP: mapping (Pass I) [regular files]
  DUMP: mapping (Pass II) [directories]
  DUMP: estimated 19 blocks.
  DUMP: Volume 1 started with block 1 at: Fri Apr 21 18:55:53 2023
  DUMP: dumping (Pass III) [directories]
  DUMP: dumping (Pass IV) [regular files]
  DUMP: Closing level2.dmp
  DUMP: Volume 1 completed at: Fri Apr 21 18:55:53 2023
  DUMP: Volume 1 20 blocks (0.02MB)
  DUMP: 20 blocks (0.02MB) on 1 volume(s)
  DUMP: finished in less than a second
  DUMP: Date of this level 2 dump: Fri Apr 21 18:55:53 2023
  DUMP: Date this dump completed:  Fri Apr 21 18:55:53 2023
  DUMP: Average transfer rate: 0 kB/s
  DUMP: DUMP IS DONE
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo mount -o defaults -t ext4 /dev/loop0 /mnt
  
  コマンドの実行結果
  --------------------------------------------------
  [ 5755.788234] EXT4-fs (loop0): mounted filesystem with ordered data mode. Opts: (null)
  --------------------------------------------------
  
  vm11$ cd /mnt
  vm11$ sudo rm sample[1-3].txt -> 誤ってファイルを全削除した設定
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd /mnt
  vm11$ sudo restore -r -f /home/makoto/level0.dmp -> 全体バックアップをレストア
  
  コマンドの実行結果
  --------------------------------------------------
  restore: ./lost+found: File exists -> 初回だけ出力される模様
  --------------------------------------------------
  
  vm11$ cd /mnt
  vm11$ ls -lh | grep sample -> レストア状況を確認
  
  コマンドの実行結果
  --------------------------------------------------
  -rw-r--r--. 1 root root   0  4月 21 18:37 sample1.txt
  --------------------------------------------------
  
  vm11$ cd /mnt
  vm11$ sudo restore -r -f /home/makoto/level1.dmp -> 増分バックアップをレストア
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd /mnt
  vm11$ ls -lh | grep sample -> レストア状況を確認
  
  コマンドの実行結果
  --------------------------------------------------
  -rw-r--r--. 1 root root   0  4月 21 18:37 sample1.txt
  -rw-r--r--. 1 root root   0  4月 21 18:46 sample2.txt
  --------------------------------------------------
  
  vm11$ cd /mnt
  vm11$ sudo restore -r -f /home/makoto/level2.dmp -> 増分バックアップをレストア
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd /mnt
  vm11$ ls -lh | grep sample -> レストア状況を確認
  
  コマンドの実行結果
  --------------------------------------------------
  -rw-r--r--. 1 root root   0  4月 21 18:37 sample1.txt
  -rw-r--r--. 1 root root   0  4月 21 18:46 sample2.txt
  -rw-r--r--. 1 root root   0  4月 21 18:54 sample3.txt
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo umount /mnt
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo losetup -D
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ rm -f image0.img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[10]
  ローカルでのバックアップ - 05 (mt)
  
[内容]
  ## 作業内容
    バックアップをコマンド(mt)で行う
  
  ## 使用マシン
    ある資料から内容を抜粋
  
  ## コマンド(mt)
    mt -f XX status         : テープ(XX)の状態表示
    mt -f XX tell           : テープ(XX)の現在位置表示
    mt -f XX rewind         : テープ(XX)を先頭に巻き戻し
    mt -f XX fsf YY         : テープ(XX)をYY個先のデータの先頭位置まで早送り
    mt -f XX bsf YY         : テープ(XX)をYY個先のデータの末尾位置まで巻き戻し
    mt -f XX compression 1  : ハードウェア圧縮
    mt -f XX compression 0  : ハードウェア圧縮を使用しない
  
  ## テープの構造
    BOT : テープの冒頭部分
    EOF : 各バックアップの終端マーク
    EOD : 最終バックアップの終端マーク(EOF)
    ### : 各バックアップの終端マークの直前部分
    
    File-Number=0       File-Number=1       File-Number=2       File-Number=3
    |                   |                   |                   |
    +-------------------+-------------------+-------------------+---------------
    |     backup_0   ###|     backup_1   ###|     backup_2   ###|     empty
    +-------------------+-------------------+-------------------+---------------
    |                   |                   |                   |
    BOT(Begin of Tape)  EOF(End of File)    EOF(End of File)    EOF(End of File) = EOD(End of Data)
  
[確認]
  # cd $HOME
  # yum -y install mt-st
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> エラー出力が無ければOK
  --------------------------------------------------
  
  # cd $HOME
  # ls /dev | grep st0 -> テープドライブ検索
  
  コマンドの実行結果
  --------------------------------------------------
  nst0 -> 書込完了後に次の書込位置にヘッド移動、逆にst0は書込完了後に自動的に巻き戻し
  --------------------------------------------------
  
  # cd $HOME
  # mt -f /dev/nst0 rewind -> テープ巻き戻し
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  # cd $HOME
  # mt -f /dev/nst0 status -> テープ確認
  
  コマンドの実行結果
  --------------------------------------------------
  SCSI 2 tape drive:
  File number=0, block number=0, partition=0.
  Tape block size 512 bytes. Density code 0x42 (no translation).
  Soft error count since last status=0
  General status bits on (41010000):
  BOT ONLINE IM_REP_EN
  --------------------------------------------------
  
    File-Number=0       File-Number=1       File-Number=2       File-Number=3
    |                   |                   |                   |
    +-------------------+-------------------+-------------------+---------------
    |     backup_0   ###|     backup_1   ###|     backup_2   ###|     empty
    +-------------------+-------------------+-------------------+---------------
    |                   |                   |                   |
    BOT(Begin of Tape)  EOF(End of File)    EOF(End of File)    EOF(End of File) = EOD(End of Data)
    ● Tape Head
  
  # cd $HOME
  # mt -f /dev/nst0 fsf 1 -> テープ早送り
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  # cd $HOME
  # mt -f /dev/nst0 status -> テープ確認
  
  コマンドの実行結果
  --------------------------------------------------
  SCSI 2 tape drive:
  File number=1, block number=0, partition=0.
  Tape block size 512 bytes. Density code 0x42 (no translation).
  Soft error count since last status=0
  General status bits on (81010000):
  EOF ONLINE IM_REP_EN
  --------------------------------------------------
  
    File-Number=0       File-Number=1       File-Number=2       File-Number=3
    |                   |                   |                   |
    +-------------------+-------------------+-------------------+---------------
    |     backup_0   ###|     backup_1   ###|     backup_2   ###|     empty
    +-------------------+-------------------+-------------------+---------------
    |                   |                   |                   |
    BOT(Begin of Tape)  EOF(End of File)    EOF(End of File)    EOF(End of File) = EOD(End of Data)
                        ● Tape Head
  
  # cd $HOME
  # tar xvf /dev/nst0 -> ファイル復元
  
  コマンドの実行結果
  --------------------------------------------------
  backup_1
  --------------------------------------------------
  
  # cd $HOME
  # mt -f /dev/nst0 status -> テープ確認
  
  コマンドの実行結果
  --------------------------------------------------
  SCSI 2 tape drive:
  File number=1, block number=20, partition=0.
  Tape block size 512 bytes. Density code 0x42 (no translation).
  Soft error count since last status=0
  General status bits on (1010000):
  ONLINE IM_REP_EN
  --------------------------------------------------
  
    File-Number=0       File-Number=1       File-Number=2       File-Number=3
    |                   |                   |                   |
    +-------------------+-------------------+-------------------+---------------
    |     backup_0   ###|     backup_1   ###|     backup_2   ###|     empty
    +-------------------+-------------------+-------------------+---------------
    |                   |                   |                   |
    BOT(Begin of Tape)  EOF(End of File)    EOF(End of File)    EOF(End of File) = EOD(End of Data)
                                         ● Tape Head -> EOF直前で停止
  
  # cd $HOME
  # mt -f /dev/nst0 fsf 1 -> テープ早送り
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  # cd $HOME
  # mt -f /dev/nst0 status -> テープ確認
  
  コマンドの実行結果
  --------------------------------------------------
  SCSI 2 tape drive:
  File number=2, block number=0, partition=0.
  Tape block size 512 bytes. Density code 0x42 (no translation).
  Soft error count since last status=0
  General status bits on (81010000):
  EOF ONLINE IM_REP_EN
  --------------------------------------------------
  
    File-Number=0       File-Number=1       File-Number=2       File-Number=3
    |                   |                   |                   |
    +-------------------+-------------------+-------------------+---------------
    |     backup_0   ###|     backup_1   ###|     backup_2   ###|     empty
    +-------------------+-------------------+-------------------+---------------
    |                   |                   |                   |
    BOT(Begin of Tape)  EOF(End of File)    EOF(End of File)    EOF(End of File) = EOD(End of Data)
                                            ● Tape Head
  
  # cd $HOME
  # mt -f /dev/nst0 eod -> テープ末尾へ早送り
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  # cd $HOME
  # mt -f /dev/nst0 status -> テープ確認
  
  コマンドの実行結果
  --------------------------------------------------
  SCSI 2 tape drive:
  File number=3, block number=0, partition=0.
  Tape block size 512 bytes. Density code 0x42 (no translation).
  Soft error count since last status=0
  General status bits on (89010000):
  EOF EOD ONLINE IM_REP_EN
  --------------------------------------------------
  
    File-Number=0       File-Number=1       File-Number=2       File-Number=3
    |                   |                   |                   |
    +-------------------+-------------------+-------------------+---------------
    |     backup_0   ###|     backup_1   ###|     backup_2   ###|     empty
    +-------------------+-------------------+-------------------+---------------
    |                   |                   |                   |
    BOT(Begin of Tape)  EOF(End of File)    EOF(End of File)    EOF(End of File) = EOD(End of Data)
                                                                ● Tape Head
  
  # cd $HOME
  # tar -cvf /dev/nst0 backup_3 -> テープ末尾から書き込み
  
  コマンドの実行結果
  --------------------------------------------------
  backup_3
  --------------------------------------------------
  
  # cd $HOME
  # mt -f /dev/nst0 status -> テープ確認
  
  コマンドの実行結果
  --------------------------------------------------
  SCSI 2 tape drive:
  File number=4, block number=0, partition=0.
  Tape block size 512 bytes. Density code 0x42 (no translation).
  Soft error count since last status=0
  General status bits on (81010000):
  EOF ONLINE IM_REP_EN
  --------------------------------------------------
  
    File-Number=0       File-Number=1       File-Number=2       File-Number=3       File-Number=4
    |                   |                   |                   |                   |
    +-------------------+-------------------+-------------------+-------------------+---------------
    |     backup_0   ###|     backup_1   ###|     backup_2   ###|     backup_3   ###|     empty
    +-------------------+-------------------+-------------------+-------------------+---------------
    |                   |                   |                   |                   |
    BOT(Begin of Tape)  EOF(End of File)    EOF(End of File)    EOF(End of File)    EOF(End of File) = EOD(End of Data)
                                                                                    ● Tape Head
  
  # cd $HOME
  # mt -f /dev/nst0 erase -> テープ消去
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 数時間はかかる処理らしい
  --------------------------------------------------
  
  # cd $HOME
  # mt -f /dev/nst0 eject -> テープ取出
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[11]
  ネットワーク経由でのバックアップ - 01
  
[内容]
  ## 作業内容
    バックアップをコマンド(rsync)で行う
  
  ## 使用マシン
    HOST : vm11
    IPV4 : 192.168.122.11
    MEMO : 仮想マシン
  
  ## コマンド(rsync)
    rsync -v        : コピー中のファイル表示
    rsync -a        : ファイルやディレクトリ属性をそのままコピー
    rsync -r        : ディレクトリ内を再帰的コピー
    rsync -u        : 変更または追加されたファイルのみコピー
    rsync -l        : シンボリックリンクをそのままコピー
    rsync -H        : ハードリンクをそのままコピー
    rsync -o        : 所有者を維持
    rsync -g        : 所有グループを維持
    rsync -t        : タイムスタンプを維持
    rsync -n        : 動作確認テスト
    rsync -z        : ファイル圧縮
    rsync -e XX     : 端末ソフト(XX)指定
    rsync --delete  : コピー元ファイル削除はコピー先でも削除
  
[確認]
  vm11$ cd $HOME
  vm11$ mkdir dirA dirB -> ディレクトリ作成
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME/dirA
  vm11$ echo 'AAA BBB CCC' > sample1.txt
  vm11$ echo 'AAA BBB CCC' > sample2.txt
  
  コマンドの実行結果
  --------------------------------------------------
  AAA BBB CCC
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ rsync
      > -a  // ファイル属性維持
      > -u  // ファイル変更反映
      > -v  // 反映ファイル表示
      > --delete     // ファイル削除反映
      > dirA/ dirB/  // 反映元 反映先
  
  コマンドの実行結果
  --------------------------------------------------
  sending incremental file list
  ./
  sample1.txt  // 反映ファイル表示
  sample2.txt  // 反映ファイル表示
  
  sent 224 bytes  received 57 bytes  562.00 bytes/sec
  total size is 24  speedup is 0.09
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ ls -lh dirA/ dirB/
  
  コマンドの実行結果
  --------------------------------------------------
  dirA/:
  合計 8.0K
  -rw-rw-r--. 1 makoto makoto 12  4月 22 12:11 sample1.txt
  -rw-rw-r--. 1 makoto makoto 12  4月 22 12:11 sample2.txt
  
  dirB/:
  合計 8.0K
  -rw-rw-r--. 1 makoto makoto 12  4月 22 12:11 sample1.txt
  -rw-rw-r--. 1 makoto makoto 12  4月 22 12:11 sample2.txt
  --------------------------------------------------
  
  vm11$ cd $HOME/dirA
  vm11$ vi sample1.txt
  
  コマンドの実行結果
  --------------------------------------------------
  AAA BBB CCC DDD(追加)
  --------------------------------------------------
  
  vm11$ cd $HOME/dirA
  vm11$ rm sample2.txt
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME/dirA
  vm11$ echo 'AAA BBB CCC' > sample3.txt
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ rsync
      > -a  // ファイル属性維持
      > -u  // ファイル変更反映
      > -v  // 反映ファイル表示
      > --delete     // ファイル削除反映
      > dirA/ dirB/  // 反映元 反映先
  
  コマンドの実行結果
  --------------------------------------------------
  sending incremental file list
  deleting sample2.txt  // ファイル削除反映メッセージ
  ./
  sample1.txt
  sample3.txt
  
  sent 228 bytes  received 72 bytes  600.00 bytes/sec
  total size is 28  speedup is 0.09
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ ls -lh dirA/ dirB/
  
  コマンドの実行結果
  --------------------------------------------------
  dirA/:
  合計 8.0K
  -rw-rw-r--. 1 makoto makoto 16  4月 22 12:21 sample1.txt
  -rw-rw-r--. 1 makoto makoto 12  4月 22 12:22 sample3.txt
  
  dirB/:
  合計 8.0K
  -rw-rw-r--. 1 makoto makoto 16  4月 22 12:21 sample1.txt
  -rw-rw-r--. 1 makoto makoto 12  4月 22 12:22 sample3.txt
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[12]
  ネットワーク経由でのバックアップ - 02
  
[内容]
  ## 作業内容
    バックアップをコマンド(rsync)で行う
  
  ## 使用マシン
    HOST : vm11
    IPV4 : 192.168.122.11
    MEMO : 仮想マシン
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン
  
  ## コマンド(rsync)
    rsync -v        : コピー中のファイル表示
    rsync -a        : ファイルやディレクトリ属性をそのままコピー
    rsync -r        : ディレクトリ内を再帰的コピー
    rsync -u        : 変更または追加されたファイルのみコピー
    rsync -l        : シンボリックリンクをそのままコピー
    rsync -H        : ハードリンクをそのままコピー
    rsync -o        : 所有者を維持
    rsync -g        : 所有グループを維持
    rsync -t        : タイムスタンプを維持
    rsync -n        : 動作確認テスト
    rsync -z        : ファイル圧縮
    rsync -e XX     : 端末ソフト(XX)指定
    rsync --delete  : コピー元ファイル削除はコピー先でも削除
  
[確認]
  vm11$ cd $HOME
  vm11$ mkdir dirC
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME/dirC
  vm11$ echo 'AAA BBB CCC' > sample1.txt
  vm11$ echo 'AAA BBB CCC' > sample2.txt
  
  コマンドの実行結果
  --------------------------------------------------
  AAA BBB CCC
  --------------------------------------------------
    
    vm12$ cd $HOME
    vm12$ sudo yum -y install rsync
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> エラー出力が無ければOK
    --------------------------------------------------
    
    vm12$ cd $HOME
    vm12$ mkdir dirC
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
  vm11$ cd $HOME
  vm11$ rsync
      > -a  // ファイル属性維持
      > -u  // ファイル変更反映
      > -v  // 反映ファイル表示
      > --delete                 // ファイル削除反映
      > -e ssh dirC/ vm12:dirC/  // ターミナルソフト
  
  コマンドの実行結果
  --------------------------------------------------
  makoto@vm12's password: (makoto@vm12のパスワード入力)
  sending incremental file list
  ./
  sample1.txt
  sample2.txt
  
  sent 228 bytes  received 57 bytes  38.00 bytes/sec
  total size is 24  speedup is 0.08
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ ls -lh dirC/
  
  コマンドの実行結果
  --------------------------------------------------
  -rw-rw-r--. 1 makoto makoto 12  4月 22 12:33 sample1.txt
  -rw-rw-r--. 1 makoto makoto 12  4月 22 12:34 sample2.txt
  --------------------------------------------------
    
    vm12$ cd $HOME
    vm12$ ls -lh dirC/
    
    コマンドの実行結果
    --------------------------------------------------
    -rw-rw-r--. 1 makoto makoto 12  4月 22 12:33 sample1.txt
    -rw-rw-r--. 1 makoto makoto 12  4月 22 12:34 sample2.txt
    --------------------------------------------------
    
  vm11$ cd $HOME/dirC
  vm11$ vi sample1.txt
  
  コマンドの実行結果
  --------------------------------------------------
  AAA BBB CCC DDD(追加)
  --------------------------------------------------
  
  vm11$ cd $HOME/dirC
  vm11$ rm sample2.txt
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME/dirC
  vm11$ echo 'AAA BBB CCC' > sample3.txt
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ rsync
      > -a  // ファイル属性維持
      > -u  // ファイル変更反映
      > -v  // 反映ファイル表示
      > --delete                 // ファイル削除反映
      > -e ssh dirC/ vm12:dirC/  // ターミナルソフト
  
  コマンドの実行結果
  --------------------------------------------------
  makoto@vm12's password: (makoto@vm12のパスワード入力)
  sending incremental file list
  deleting sample2.txt
  ./
  sample1.txt
  sample3.txt
  
  sent 232 bytes  received 78 bytes  36.47 bytes/sec
  total size is 28  speedup is 0.09
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ ls -lh dirC/
  
  コマンドの実行結果
  --------------------------------------------------
  -rw-rw-r--. 1 makoto makoto 16  4月 22 12:39 sample1.txt
  -rw-rw-r--. 1 makoto makoto 12  4月 22 12:39 sample3.txt
  --------------------------------------------------
    
    vm12$ cd $HOME
    vm12$ ls -lh dirC/
    
    コマンドの実行結果
    --------------------------------------------------
    -rw-rw-r--. 1 makoto makoto 16  4月 22 12:39 sample1.txt
    -rw-rw-r--. 1 makoto makoto 12  4月 22 12:39 sample3.txt
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[13]
  ログイン前後のメッセージ - 01 (/etc/issue)
  
[内容]
  ## 作業内容
    ログイン前のメッセージをファイル(/etc/issue)で設定する
  
  ## 使用マシン
    HOST : vm11
    IPV4 : 192.168.122.11
    MEMO : 仮想マシン
  
[確認]
  vm11$ cd $HOME
  vm11$ sudo vi /etc/issue
  
  コマンドの実行結果
  --------------------------------------------------
  System is \S         // 追加 \S = $(uname -s) = CentOS Linux 7 (Core)
  Kernel is \r         // 追加 \r = $(uname -r) = 4.15.3
  Architecture is \m   // 追加 \m = $(uname -m) = x86_64
  Host is \n           // 追加 \n = $(uname -n) = vm11
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo systemctl reboot
  
  コマンドの実行結果
  --------------------------------------------------
  System is CentOS Linux 7 (Core)
  Kernel is 4.15.3
  Architecture is x86_64
  Host is vm11
  vm11 login: ■ (ログインプロンプト)
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[14]
  ログイン前後のメッセージ - 02 (/etc/motd)
  
[内容]
  ## 作業内容
    ログイン後のメッセージをファイル(/etc/motd)で設定する
  
  ## 使用マシン
    HOST : vm11
    IPV4 : 192.168.122.11
    MEMO : 仮想マシン
  
[確認]
  vm11$ cd $HOME
  vm11$ sudo vi /etc/motd
  
  コマンドの実行結果
  --------------------------------------------------
  This machine is for LPIC 201.
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo systemctl reboot
  
  コマンドの実行結果
  --------------------------------------------------
  System is CentOS Linux 7 (Core)
  Kernel is 4.15.3
  Architecture is x86_64
  Host is vm11
  vm11 login: makoto (ユーザー名を入力)
  パスワード: (パスワードを入力)
  最終ログイン: Sat Apr 22 12:52:28  ttyS0 上
  This machine is for LPIC 201.  // ログイン後のメッセージ
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
