================================================================================
[001] ファイルシステムの情報 - 01 (cat /etc/fstab)
[002] ファイルシステムの情報 - 02 (blkid)
[003] ファイルシステムの情報 - 03 (cat /proc/filesystems)
[004] ファイルシステムの情報 - 04 (cat /etc/mtab)
[005] ファイルシステムの情報 - 05 (cat /proc/mounts)
[006] マウントとアンマウント - 01 (mount)
[007] マウントとアンマウント - 02 (umount)
[008] スワップ - 01 (mkswap)
[009] スワップ - 02 (swapon)
[010] スワップ - 03 (swapoff)
[011] ファイルシステム作成 - 01 (ext2)
[012] ファイルシステム作成 - 02 (ext3)
[013] ファイルシステム作成 - 03 (ext4)
[014] ファイルシステム作成 - 04 (ext3 -> ext4)
[015] ファイルシステム作成 - 05 (xfs)
[016] ファイルシステム作成 - 06 (btrfs)
[017] コマンド(mkfs)
[018] CD/DVD作成 - 01
[019] CD/DVD作成 - 02
[020] 暗号化デバイス
[021] スーパーブロック
[022] ファイルシステムチェック - 01 (fsck)
[023] ファイルシステムチェック - 02 (e2fsck)
[024] ファイルシステムチェック - 03 (xfs_repair)
[025] ファイルシステム管理(ext2,ext3,ext4) - 01 (tune2fs)
[026] ファイルシステム管理(ext2,ext3,ext4) - 02 (badblocks)
[027] ファイルシステム管理(ext2,ext3,ext4) - 03 (debugfs)
[028] S.M.A.R.T
[029] ファイルシステム管理(xfs) - 01 (xfs_admin)
[030] ファイルシステム管理(xfs) - 02 (xfs_info)
[031] ファイルシステム管理(xfs) - 03 (xfsdump)
[032] ファイルシステム管理(xfs) - 04 (xfsrestore)
[033] ファイルシステム管理(xfs) - 05 (xfs_repair)
[034] ファイルシステム管理(btrfs) - 01 (btrfs)
[035] ファイルシステム管理(btrfs) - 02 (btrfs-convert)
[036] オートマウント
================================================================================
[001]
  ファイルシステムの情報 - 01 (cat /etc/fstab)
  
[内容]
  ## 作業内容
    システムのファイルシステムの情報をコマンド(cat /etc/fstab)から確認
  
  ## 設定ファイルの書式
  --------------------------------------------------
  書式
    [デバイス名 or UUID or ラベル名]  [マウントポイント]  [ファイルシステム]  [オプション]  [DUMP対象]  [FSCK順序]
  
  設定例01
    /dev/sda1  /boot  xfs  defaults  0  0
    /dev/sda2  /      xfs  defaults  0  0
  
  設定例02
    UUID=1d5e0998-fe61-4a82-83be-96a01cfbbd31  /boot  xfs  defaults  0  0
    UUID=1d5e0998-fe61-4a82-83be-96a01cfbbd99  /      xfs  defaults  0  0
  
  設定例03
    LABEL=sda1  /boot  xfs  defaults  0  0
    LABEL=sda2  /      xfs  defaults  0  0
  
  i/o synchronization
    async     : 非同期
    sync      : 同期
  
  access time update
    atime     : 更新
    relatime  : 一定時間後に更新
    noatime   : 更新しない -> ディスクアクセス高速化
  
  auto mount
    auto      : コマンド(mount -a)でマウント
    noauto    : コマンド(mount -a)でマウントしない
  
  binary execution
    exec      : 許可
    noexec    : 禁止
  
  suid/sgid
    suid      : 許可
    nosuid    : 禁止
  
  read only
    ro        : 読取専用
    rw        : 書込可能
  
  mount operation
    user      : マウント許可、アンマウントは該当ユーザーのみ
    users     : マウント許可、アンマウントも該当ユーザー以外で許可
    nouser    : マウント禁止
    owner     : デバイス所有者のマウント許可
    group     : マウント許可 -> 条件がある
  
  others
    defaults  : その他  // async, auto, dev, exec, nouser, rw, suid
    dev       : その他  // ファイルシステム上のデバイスファイル使用可
    uid=UID   : その他  // 全ファイル所有者を指定UIDにする
    gid=GID   : その他  // 全ファイル所有グループを指定GIDにする
  
  dump
    0         : バックアップ対象外
    1-9       : バックアップ対象
  
  fsck sequence
    0         : チェック対象外
    1-9       : チェック順序(数字順)
  --------------------------------------------------
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Sun Jun  4 17:56:17 2023
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ lsblk
    
    コマンドの実行結果
    --------------------------------------------------
    NAME                    MAJ:MIN  RM   SIZE  RO  TYPE  MOUNTPOINT
    sr0                      11:0     1  1024M   0  rom   
    vda                     252:0     0    30G   0  disk  
     |-- vda1               252:1     0     1G   0  part  /boot
     |-- vda2               252:2     0    29G   0  part  
          |-- rl_vm11-root  253:0     0    26G   0  lvm   /
          |-- rl_vm11-swap  253:1     0     3G   0  lvm   [SWAP]
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ cat /etc/fstab | grep -vE '^#|^$' -> 仮想マシンの設定ファイル(/etc/fstab)を確認
    
    コマンドの実行結果
    --------------------------------------------------
    UUID=873bce14-6dd1-411a-a3bb-1fbd6dd99891  /boot  xfs   defaults  0  0
    /dev/mapper/rl_vm11-root                   /      xfs   defaults  0  0
    /dev/mapper/rl_vm11-swap                   none   swap  defaults  0  0
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo blkid -> デバイスのUUIDを確認
    
    コマンドの実行結果
    --------------------------------------------------
    /dev/vda1: UUID="873bce14-6dd1-411a-a3bb-1fbd6dd99891" BLOCK_SIZE="512" TYPE="xfs" PARTUUID="5081de8f-01"
    /dev/vda2: UUID="K9IrZo-7yT1-Ds2n-nl07-TNUz-LAbs-pGX06p" TYPE="LVM2_member" PARTUUID="5081de8f-02"
    /dev/mapper/rl_vm11-root: UUID="4c486f84-e596-4942-b15f-0eff6dc47d7c" BLOCK_SIZE="512" TYPE="xfs"
    /dev/mapper/rl_vm11-swap: UUID="d71a97bf-1173-477f-ae33-68e225855128" TYPE="swap" 
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ cat /proc/filesystems -> カーネルサポートのファイルシステム
    
    コマンドの実行結果
    --------------------------------------------------
    nodev  sysfs
    nodev  rootfs
    nodev  ramfs
    nodev  bdev
    nodev  proc
    nodev  cpuset
    nodev  cgroup
    nodev  cgroup2
    nodev  tmpfs
    nodev  devtmpfs
    nodev  configfs
    nodev  debugfs
    nodev  tracefs
    nodev  securityfs
    nodev  sockfs
    nodev  dax
    nodev  bpf
    nodev  pipefs
    nodev  hugetlbfs
    nodev  devpts
    nodev  autofs
    nodev  mqueue
    nodev  pstore
           xfs
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ cat /etc/mtab | grep xfs -> マウント済みのファイルシステムを表示
    
    コマンドの実行結果
    --------------------------------------------------
    /dev/mapper/rl_vm11-root  /      xfs  rw,relatime,attr2,inode64,noquota  0  0
    /dev/vda1                 /boot  xfs  rw,relatime,attr2,inode64,noquota  0  0
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ cat /proc/mounts | grep xfs -> マウント済みのファイルシステムを表示
    
    コマンドの実行結果
    --------------------------------------------------
    /dev/mapper/rl_vm11-root  /      xfs  rw,relatime,attr2,inode64,noquota  0  0
    /dev/vda1                 /boot  xfs  rw,relatime,attr2,inode64,noquota  0  0
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[002]
  ファイルシステムの情報 - 02 (blkid)
  
[内容]
  ## 作業内容
    デバイスのUUIDを確認
  
[確認]
  上記「01」を参照
  
================================================================================
[003]
  ファイルシステムの情報 - 03 (cat /proc/filesystems)
  
[内容]
  ## 作業内容
    カーネルサポートのファイルシステム
  
[確認]
  上記「01」を参照
  
================================================================================
[004]
  ファイルシステムの情報 - 04 (cat /etc/mtab)
  
[内容]
  ## 作業内容
    マウント済みのファイルシステムを表示
  
[確認]
  上記「01」を参照
  
================================================================================
[005]
  ファイルシステムの情報 - 05 (cat /proc/mounts)
  
[内容]
  ## 作業内容
    マウント済みのファイルシステムを表示
  
[確認]
  上記「01」を参照
  
================================================================================
[006]
  マウントとアンマウント - 01 (mount)
  
[内容]
  ## 作業内容
    指定ファイルシステムでデバイスマウント
  
  ## コマンド(mount)
    mount -a      : 設定ファイル(/etc/fstab)の全ファイルシステムをマウント
    mount -o XX   : マウントオプション(XX)を指定
    mount -U XX   : UUID(XX)を指定
    mount -n      : 設定ファイル(/etc/mtab)に書き込まない
    mount -r      : mount -o ro
    mount -w      : mount -o rw
    mount -t XX   : ファイルシステム種類(XX)を指定
  
[確認]
  $ cd $HOME
  $ sudo virsh destroy vm11 -> 仮想マシンの停止
  
  コマンドの実行結果
  --------------------------------------------------
  Domain 'vm11' destroyed
  --------------------------------------------------
  
  $ cd $HOME
  $ sudo dd if=/dev/zero of=/home/disk1.img bs=100M count=20 -> イメージファイル作成
  $ sudo dd if=/dev/zero of=/home/disk2.img bs=100M count=20
  
  コマンドの実行結果
  --------------------------------------------------
  // disk1.img
  20+0 レコード入力
  20+0 レコード出力
  2097152000 bytes (2.1 GB, 2.0 GiB) copied, 7.08418 s, 296 MB/s
  
  // disk2.img
  20+0 レコード入力
  20+0 レコード出力
  2097152000 bytes (2.1 GB, 2.0 GiB) copied, 7.0944 s, 296 MB/s
  --------------------------------------------------
  
  $ cd $HOME
  $ sudo vi /home/disk1.xml -> デバイスのXMLファイル作成
  $ sudo vi /home/disk2.xml
  
  コマンドの実行結果
  --------------------------------------------------
  // disk1.xml
  <disk type='file' device='disk'>
    <driver name='qemu' type='raw' cache='none'/>
    <source file='/home/disk1.img'/>
    <target dev='vdb'/>
  </disk>
  
  // disk2.xml
  <disk type='file' device='disk'>
    <driver name='qemu' type='raw' cache='none'/>
    <source file='/home/disk2.img'/>
    <target dev='vdc'/>
  </disk>
  --------------------------------------------------
  
  $ cd /home
  $ sudo virsh attach-device --config vm11 /home/disk1.xml -> 仮想マシンにデバイス追加
  $ sudo virsh attach-device --config vm11 /home/disk2.xml
  
  コマンドの実行結果
  --------------------------------------------------
  // disk1.xml
  デバイスが正常に接続されました
  
  // disk2.xml
  デバイスが正常に接続されました
  --------------------------------------------------
  
  $ cd $HOME
  $ sudo virsh start vm11 -> 仮想マシンの起動
  
  コマンドの実行結果
  --------------------------------------------------
  Domain 'vm11' started
  --------------------------------------------------
  
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Mon Jun  5 10:54:21 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ lsblk
    
    コマンドの実行結果
    --------------------------------------------------
    NAME                    MAJ:MIN  RM   SIZE  RO  TYPE  MOUNTPOINT
    sr0                      11:0     1  1024M   0  rom   
    vda                     252:0     0    30G   0  disk  
     |-- vda1               252:1     0     1G   0  part  /boot
     |-- vda2               252:2     0    29G   0  part  
          |-- rl_vm11-root  253:0     0    26G   0  lvm   /
          |-- rl_vm11-swap  253:1     0     3G   0  lvm   [SWAP]
    vdb                     252:16    0     2G   0  disk  (ディスク追加)
    vdc                     252:32    0     2G   0  disk  (ディスク追加)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ LANG=C sudo parted /dev/vdb -> ディスク上にパーティション作成
    
    コマンドの実行結果
    --------------------------------------------------
    GNU Parted 3.2
    Using /dev/vdb
    Welcome to GNU Parted! Type 'help' to view a list of commands.
    
    (parted) 
    (parted) print  // パーティション情報
    
    Error: /dev/vdb: unrecognised disk label  // 管理方式が不明
    Model: Virtio Block Device (virtblk)
    Disk /dev/vdb: 2097MB
    Sector size (logical/physical): 512B/512B
    Partition Table: unknown  // 管理方式が不明なのでパーティション情報もない
    Disk Flags: 
    
    (parted) 
    (parted) mklabel msdos  // 管理方式をmsdos(MBR方式)に設定
    
    (parted) 
    (parted) mkpart  // パーティション作成
    
    Partition type?  primary/extended? (primaryを入力)
    File system type?  [ext2]? (ext4を入力)
    Start? (0%を入力)  // 開始セクタはディスクの最初から
    End? (50%を入力)   // 終了セクタはディスクの半分まで
    
    (parted) 
    (parted) mkpart
    
    Partition type?  primary/extended? (primaryを入力)
    File system type?  [ext2]? (ext4を入力)
    Start? (51%を入力)  // 開始セクタはディスクの半分から
    End? (100%を入力)   // 終了セクタはディスクの最後まで
    
    (parted) 
    (parted) print
    
    Model: Virtio Block Device (virtblk)
    Disk /dev/vdb: 2097MB
    Sector size (logical/physical): 512B/512B
    Partition Table: msdos
    Disk Flags: 
    
    Number  Start   End     Size    Type     File system  Flags
    1       1049kB  1049MB  1048MB  primary  ext4         lba
    2       1070MB  2097MB  1028MB  primary  ext4         lba
    
    (parted) 
    (parted) quit  // 対話モード終了
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ LANG=C sudo parted /dev/vdc -> ディスク上にパーティション作成
    
    コマンドの実行結果
    --------------------------------------------------
    GNU Parted 3.2
    Using /dev/vdc
    Welcome to GNU Parted! Type 'help' to view a list of commands.
    
    (parted) 
    (parted) print
    
    Error: /dev/vdc: unrecognised disk label
    Model: Virtio Block Device (virtblk)
    Disk /dev/vdb: 2097MB
    Sector size (logical/physical): 512B/512B
    Partition Table: unknown
    Disk Flags: 
    
    (parted) 
    (parted) mklabel msdos
    
    (parted) 
    (parted) mkpart
    
    Partition type?  primary/extended? (primaryを入力)
    File system type?  [ext2]? (ext4を入力)
    Start? (0%を入力)
    End? (50%を入力)
    
    (parted) 
    (parted) mkpart
    
    Partition type?  primary/extended? (primaryを入力)
    File system type?  [ext2]? (ext4を入力)
    Start? (51%を入力)
    End? (100%を入力)
    
    (parted) 
    (parted) print
    
    Model: Virtio Block Device (virtblk)
    Disk /dev/vdc: 2097MB
    Sector size (logical/physical): 512B/512B
    Partition Table: msdos
    Disk Flags: 
    
    Number  Start   End     Size    Type     File system  Flags
    1       1049kB  1049MB  1048MB  primary  ext4         lba
    2       1070MB  2097MB  1028MB  primary  ext4         lba
    
    (parted) 
    (parted) quit
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ lsblk
    
    コマンドの実行結果
    --------------------------------------------------
    NAME                    MAJ:MIN  RM   SIZE  RO  TYPE  MOUNTPOINT
    sr0                      11:0     1  1024M   0  rom   
    vda                     252:0     0    30G   0  disk  
     |-- vda1               252:1     0     1G   0  part  /boot
     |-- vda2               252:2     0    29G   0  part  
          |-- rl_vm11-root  253:0     0    26G   0  lvm   /
          |-- rl_vm11-swap  253:1     0     3G   0  lvm   [SWAP]
    vdb                     252:16    0     2G   0  disk  
     |-- vdb1               252:17    0   999M   0  part  (パーティション作成)
     |-- vdb2               252:18    0   980M   0  part  (パーティション作成)
    vdc                     252:32    0     2G   0  disk  
     |-- vdc1               252:33    0   999M   0  part  (パーティション作成)
     |-- vdc2               252:34    0   980M   0  part  (パーティション作成)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkdir -p /mnt/mp1 -> マウントポイント作成
    vm11$ sudo mkdir -p /mnt/mp2
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkfs -t ext4 /dev/vdb1 -> ファイルシステム作成
    vm11$ sudo mkfs -t ext4 /dev/vdb2
    
    コマンドの実行結果
    --------------------------------------------------
    (省略)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkswap /dev/vdc1 -> スワップ領域を作成
    vm11$ sudo mkswap /dev/vdc2
  
    コマンドの実行結果
    --------------------------------------------------
    // vdc1
    スワップ空間バージョン 1 を設定します。サイズ = 999 MiB (1047523328 バイト)
    ラベルはありません, UUID=92f57769-d249-4ccd-ad8c-fb207f271367
    
    // vdc2
    スワップ空間バージョン 1 を設定します。サイズ = 980 MiB (1027600384 バイト)
    ラベルはありません, UUID=1c99c611-6e12-44d7-994a-018eb5d4038a
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo swapon /dev/vdc1 -> スワップ領域を有効化
    vm11$ sudo swapon /dev/vdc2
    
    コマンドの実行結果
    --------------------------------------------------
    // vdc1
    (省略) -> 出力なし
    
    // vdc2
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ LANG=C swapon -s -> 有効なスワップ領域を表示
    
    コマンドの実行結果
    --------------------------------------------------
    Filename   Type       Size     Used  Priority
    /dev/dm-1  partition  3145724  0     -2
    /dev/vdc1  partition  1022972  0     -3
    /dev/vdc2  partition  1003516  0     -4
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ cat /proc/swaps -> 有効なスワップ領域を表示
    
    コマンドの実行結果
    --------------------------------------------------
    Filename   Type       Size     Used  Priority
    /dev/dm-1  partition  3145724  0     -2
    /dev/vdc1  partition  1022972  0     -3
    /dev/vdc2  partition  1003516  0     -4
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo vi /etc/fstab -> 設定ファイル(/etc/fstab)を編集
    
    コマンドの実行結果
    --------------------------------------------------
    UUID=873bce14-6dd1-411a-a3bb-1fbd6dd99891  /boot     xfs   defaults  0  0
    /dev/mapper/rl_vm11-root                   /         xfs   defaults  0  0
    /dev/mapper/rl_vm11-swap                   none      swap  defaults  0  0
    /dev/vdb1                                  /mnt/mp1  ext4  defaults  0  0  (追加)
    /dev/vdb2                                  /mnt/mp2  ext4  defaults  0  0  (追加)
    /dev/vdc1                                  none      swap  defaults  0  0  (追加)
    /dev/vdc2                                  none      swap  defaults  0  0  (追加)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo systemctl daemon-reload -> 設定ファイル(/etc/fstab)の変更をシステムへ通知
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mount -at ext4 -> 設定ファイル(/etc/fstab)上のファイルシステム(ext4)をマウント
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ lsblk
    
    コマンドの実行結果
    --------------------------------------------------
    NAME                    MAJ:MIN  RM   SIZE  RO  TYPE  MOUNTPOINT
    sr0                      11:0     1  1024M   0  rom   
    vda                     252:0     0    30G   0  disk  
     |-- vda1               252:1     0     1G   0  part  /boot
     |-- vda2               252:2     0    29G   0  part  
          |-- rl_vm11-root  253:0     0    26G   0  lvm   /
          |-- rl_vm11-swap  253:1     0     3G   0  lvm   [SWAP]
    vdb                     252:16    0     2G   0  disk  
     |-- vdb1               252:17    0   999M   0  part  /mnt/mp1
     |-- vdb2               252:18    0   980M   0  part  /mnt/mp2
    vdc                     252:32    0     2G   0  disk  
     |-- vdc1               252:33    0   999M   0  part  [SWAP]
     |-- vdc2               252:34    0   980M   0  part  [SWAP]
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo umount -at ext4 -> 設定ファイル(/etc/fstab)上のファイルシステム(ext4)をアンマウント
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo swapoff /dev/vdc1 -> スワップ領域の無効化
    vm11$ sudo swapoff /dev/vdc2
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ lsblk
    
    コマンドの実行結果
    --------------------------------------------------
    NAME                    MAJ:MIN  RM   SIZE  RO  TYPE  MOUNTPOINT
    sr0                      11:0     1  1024M   0  rom   
    vda                     252:0     0    30G   0  disk  
     |-- vda1               252:1     0     1G   0  part  /boot
     |-- vda2               252:2     0    29G   0  part  
          |-- rl_vm11-root  253:0     0    26G   0  lvm   /
          |-- rl_vm11-swap  253:1     0     3G   0  lvm   [SWAP]
    vdb                     252:16    0     2G   0  disk  
     |-- vdb1               252:17    0   999M   0  part  (アンマウント)
     |-- vdb2               252:18    0   980M   0  part  (アンマウント)
    vdc                     252:32    0     2G   0  disk  
     |-- vdc1               252:33    0   999M   0  part  (無効化)
     |-- vdc2               252:34    0   980M   0  part  (無効化)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo vi /etc/fstab -> 設定ファイル(/etc/fstab)を編集
    
    コマンドの実行結果
    --------------------------------------------------
    UUID=873bce14-6dd1-411a-a3bb-1fbd6dd99891  /boot     xfs   defaults  0  0
    /dev/mapper/rl_vm11-root                   /         xfs   defaults  0  0
    /dev/mapper/rl_vm11-swap                   none      swap  defaults  0  0
    # /dev/vdb1                                /mnt/mp1  ext4  defaults  0  0  (コメントアウト)
    # /dev/vdb2                                /mnt/mp2  ext4  defaults  0  0  (コメントアウト)
    # /dev/vdc1                                none      swap  defaults  0  0  (コメントアウト)
    # /dev/vdc2                                none      swap  defaults  0  0  (コメントアウト)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  $ cd $HOME
  $ sudo virsh destroy vm11 -> 仮想マシンの停止
  
  コマンドの実行結果
  --------------------------------------------------
  Domain 'vm11' destroyed
  --------------------------------------------------
  
  $ cd /home
  $ sudo virsh detach-device --config vm11 /home/disk1.xml -> 仮想マシンからデバイス削除
  $ sudo virsh detach-device --config vm11 /home/disk2.xml
  
  コマンドの実行結果
  --------------------------------------------------
  // disk1.xml
  デバイスが正常に切断されました
  
  // disk2.xml
  デバイスが正常に切断されました
  --------------------------------------------------
  
  $ cd $HOME
  $ sudo virsh start vm11 -> 仮想マシンの起動
  
  コマンドの実行結果
  --------------------------------------------------
  Domain 'vm11' started
  --------------------------------------------------
  
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Mon Jun  5 10:54:21 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ lsblk
    
    コマンドの実行結果
    --------------------------------------------------
    NAME                    MAJ:MIN  RM   SIZE  RO  TYPE  MOUNTPOINT
    sr0                      11:0     1  1024M   0  rom   
    vda                     252:0     0    30G   0  disk  
     |-- vda1               252:1     0     1G   0  part  /boot
     |-- vda2               252:2     0    29G   0  part  
          |-- rl_vm11-root  253:0     0    26G   0  lvm   /
          |-- rl_vm11-swap  253:1     0     3G   0  lvm   [SWAP]
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[007]
  マウントとアンマウント - 02 (umount)
  
[内容]
  ## 作業内容
    指定ファイルシステムでデバイスマウント
  
  ## コマンド(umount)
    umount -a     : 設定ファイル(/etc/mtab)の全ファイルシステムをアンマウント
    umount -t XX  : ファイルシステム種類(XX)を指定
  
[確認]
  上記の「06」を参照
  
================================================================================
[008]
  スワップ - 01 (mkswap)
  
[内容]
  ## 作業内容
    指定デバイスをスワップ領域化する
  
  ## コマンド(mkswap)
    mkswap XX     : スワップ領域(XX)を作成
    mkswap -c     : 不良ブロックをチェック
    mkswap -L XX  : ラベル(XX)を付与
  
[確認]
  上記の「06」を参照
  
================================================================================
[009]
  スワップ - 02 (swapon)
  
[内容]
  ## 作業内容
    指定デバイスをスワップ領域化する
  
  ## コマンド(swapon)
    swapon XX  : スワップ領域(XX)を有効化
    swapon -a  : 設定ファイル(/etc/fstab)の全スワップ領域を有効化
    swapon -s  : 有効なスワップ領域を表示
  
[確認]
  上記の「06」を参照
  
================================================================================
[010]
  スワップ - 03 (swapoff)
  
[内容]
  ## 作業内容
    指定デバイスのスワップ領域化を解除する
  
  ## コマンド(swapoff)
    swapoff XX  : スワップ領域(XX)を無効化
    swapoff -a  : 設定ファイル(/etc/fstab)の全スワップ領域を無効化
  
[確認]
  上記の「06」を参照
  
================================================================================
[011]
  ファイルシステム作成 - 01 (ext2)
  
[内容]
  ## 作業内容
    ファイルシステム(ext2)をコマンド(mke2fs)で作成してマウント
  
  ## コマンド(mke2fs)
    mke2fs -b XX    : ブロックサイズ(XX)
    mke2fs -c       : 不良チェック
    mke2fs -L XX    : ボリュームラベル(XX)
    mke2fs -i XX    : iノードあたりのバイト数
    mke2fs -j       : ファイルシステム(ext3)を作成
    mke2fs -m XX %  : 管理領域の割合(XX)%
    mke2fs -n       : 動作のシミュレートのみ
    mke2fs -t XX    : ファイルシステムの種類(ext2,ext3,ext4)
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Mon Jun  5 13:27:31 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ dd if=/dev/zero of=image0.img bs=10M count=10 -> ext2
    vm11$ dd if=/dev/zero of=image1.img bs=10M count=10 -> ext3
    vm11$ dd if=/dev/zero of=image2.img bs=10M count=10 -> ext4
    vm11$ dd if=/dev/zero of=image3.img bs=10M count=10 -> xfs
    
    コマンドの実行結果
    --------------------------------------------------
    // image0.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 1.83849 s, 57.0 MB/s
    
    // image1.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 1.61971 s, 64.7 MB/s
    
    // image2.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 1.36738 s, 76.7 MB/s
    
    // image3.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 1.31447 s, 79.8 MB/s
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup -f
    
    コマンドの実行結果
    --------------------------------------------------
    /dev/loop0
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup /dev/loop0 image0.img -> ext2
    vm11$ sudo losetup /dev/loop1 image1.img -> ext3
    vm11$ sudo losetup /dev/loop2 image2.img -> ext4
    vm11$ sudo losetup /dev/loop3 image3.img -> xfs
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkdir -p /mnt/loop0 -> ext2
    vm11$ sudo mkdir -p /mnt/loop1 -> ext3
    vm11$ sudo mkdir -p /mnt/loop2 -> ext4
    vm11$ sudo mkdir -p /mnt/loop3 -> xfs
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mke2fs
        > -b 4096      // ブロックサイズ
        > -c           // 不良チェック
        > -L myLoop0   // ラベル指定
        > -m 1         // 管理領域
        > /dev/loop0   // デバイス
    
    コマンドの実行結果
    --------------------------------------------------
    mke2fs 1.45.6 (20-Mar-2020)
    Discarding device blocks: done
    Creating filesystem with 25600 4k blocks and 25600 inodes
    
    Checking for bad blocks (read-only test): 0.00% done, 0:00 elapsed.
    Allocating group tables: done
    Writing inode tables: done
    Writing superblocks and filesystem accounting information: done
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mount -o defaults /dev/loop0 /mnt/loop0
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mke2fs
        > -b 4096      // ブロックサイズ
        > -j           // ext3
        > -c           // 不良チェック
        > -L myLoop1   // ラベル
        > -m 1         // 管理領域
        > /dev/loop1   // デバイス
    
    コマンドの実行結果
    --------------------------------------------------
    mke2fs 1.45.6 (20-Mar-2020)
    Discarding device blocks: done                            
    Creating filesystem with 25600 4k blocks and 25600 inodes
    
    Checking for bad blocks (read-only test): 0.00% done, 0:00 elapsed.
    Allocating group tables: done
    Writing inode tables: done
    Creating journal (1024 blocks): done
    Writing superblocks and filesystem accounting information: done
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mount -o defaults /dev/loop1 /mnt/loop1
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mke2fs
        > -b 4096      // ブロックサイズ
        > -t ext4      // ext4
        > -c           // 不良チェック
        > -L myLoop2   // ラベル
        > -m 1         // 管理領域
        > /dev/loop2   // デバイス
    
    コマンドの実行結果
    --------------------------------------------------
    mke2fs 1.45.6 (20-Mar-2020)
    Discarding device blocks: done                            
    Creating filesystem with 25600 4k blocks and 25600 inodes
    
    Checking for bad blocks (read-only test): 0.00% done, 0:00 elapsed.
    Allocating group tables: done                            
    Writing inode tables: done                            
    Creating journal (1024 blocks): done
    Writing superblocks and filesystem accounting information: done
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mount -o defaults /dev/loop2 /mnt/loop2
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkfs -t xfs /dev/loop3
    
    コマンドの実行結果
    --------------------------------------------------
    meta-data = /dev/loop3     isize=512    agcount=4, agsize=6400 blks
              =                sectsz=512   attr=2, projid32bit=1
              =                crc=1        finobt=1, sparse=1, rmapbt=0
              =                reflink=1    bigtime=0 inobtcount=0
    data      =                bsize=4096   blocks=25600, imaxpct=25
              =                sunit=0      swidth=0 blks
    naming    = version 2      bsize=4096   ascii-ci=0, ftype=1
    log       = internal log   bsize=4096   blocks=1368, version=2
              =                sectsz=512   sunit=0 blks, lazy-count=1
    realtime  = none           extsz=4096   blocks=0, rtextents=0
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mount -o defaults /dev/loop3 /mnt/loop3
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ lsblk
    
    コマンドの実行結果
    --------------------------------------------------
    NAME                    MAJ:MIN  RM   SIZE  RO  TYPE  MOUNTPOINT
    loop0                     7:0     0   100M   0  loop  /mnt/loop0 -> ext2
    loop1                     7:1     0   100M   0  loop  /mnt/loop1 -> ext3
    loop2                     7:2     0   100M   0  loop  /mnt/loop2 -> ext4
    loop3                     7:3     0   100M   0  loop  /mnt/loop3 -> xfs
    sr0                      11:0     1  1024M   0  rom   
    vda                     252:0     0    30G   0  disk  
     |-- vda1               252:1     0     1G   0  part  /boot
     |-- vda2               252:2     0    29G   0  part  
          |-- rl_vm11-root  253:0     0    26G   0  lvm   /
          |-- rl_vm11-swap  253:1     0     3G   0  lvm   [SWAP]
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ LANG=C df -mHT
    
    コマンドの実行結果
    --------------------------------------------------
    Filesystem                Type      Size  Used  Avail  Use%  Mounted on
    devtmpfs                  devtmpfs  769M     0   769M    0%  /dev
    tmpfs                     tmpfs     807M     0   807M    0%  /dev/shm
    tmpfs                     tmpfs     807M  537k   807M    1%  /run
    tmpfs                     tmpfs     807M     0   807M    0%  /sys/fs/cgroup
    /dev/mapper/rl_vm11-root  xfs        28G  9.2G    19G   33%  /
    /dev/vda1                 xfs       1.1G  283M   782M   27%  /boot
    tmpfs                     tmpfs     162M     0   162M    0%  /run/user/1000
    /dev/loop0                ext2      102M   50k   101M    1%  /mnt/loop0
    /dev/loop1                ext3       98M   54k    97M    1%  /mnt/loop1
    /dev/loop2                ext4       98M   74k    95M    1%  /mnt/loop2
    /dev/loop3                xfs       100M  6.3M    93M    7%  /mnt/loop3
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ mount | grep loop[0-3]
    
    コマンドの実行結果
    --------------------------------------------------
    /dev/loop0 on /mnt/loop0 type ext2 (rw,relatime,block_validity,barrier,user_xattr,acl)
    /dev/loop1 on /mnt/loop1 type ext3 (rw,relatime)
    /dev/loop2 on /mnt/loop2 type ext4 (rw,relatime)
    /dev/loop3 on /mnt/loop3 type xfs  (rw,relatime,attr2,inode64,noquota)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ cat /etc/mtab | grep loop[0-3]
    
    コマンドの実行結果
    --------------------------------------------------
    /dev/loop0 /mnt/loop0 ext2 rw,relatime,block_validity,barrier,user_xattr,acl 0 0
    /dev/loop1 /mnt/loop1 ext3 rw,relatime 0 0
    /dev/loop2 /mnt/loop2 ext4 rw,relatime 0 0
    /dev/loop3 /mnt/loop3 xfs  rw,relatime,attr2,inode64,noquota 0 0
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ cat /proc/mounts | grep loop[0-3]
    
    コマンドの実行結果
    --------------------------------------------------
    /dev/loop0 /mnt/loop0 ext2 rw,relatime,block_validity,barrier,user_xattr,acl 0 0
    /dev/loop1 /mnt/loop1 ext3 rw,relatime 0 0
    /dev/loop2 /mnt/loop2 ext4 rw,relatime 0 0
    /dev/loop3 /mnt/loop3 xfs  rw,relatime,attr2,inode64,noquota 0 0
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo umount /mnt/loop0 /mnt/loop1 /mnt/loop2 /mnt/loop3
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup -D
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ rm -f image[0-3].img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[012]
  ファイルシステム作成 - 02 (ext3)
  
[内容]
  ## 作業内容
    ファイルシステム(ext3)をコマンド(mke2fs)で作成してマウント
  
[確認]
  上記の「11」を参照
  
================================================================================
[013]
  ファイルシステム作成 - 03 (ext4)
  
[内容]
  ## 作業内容
    ファイルシステム(ext4)をコマンド(mke2fs)で作成してマウント
  
[確認]
  上記の「11」を参照
  
================================================================================
[014]
  ファイルシステム作成 - 04 (ext2 -> ext3)
  
[内容]
  ## 作業内容
    ファイルシステムをアップグレード(ext2 -> ext3)する
  
  ## コマンド(tune2fs)
    tune2fs -c XX  : 最大マウント回数(XX)に達したらファイルシステムチェック
    tune2fs -C XX  : 現在のマウント回数を設定
    tune2fs -i XX  : ファイルシステムチェック間隔(XX日)
    tune2fs -j     : ext2 -> ext3
    tune2fs -O     : ext3 -> ext4
    tune2fs -m XX  : root用予約領域(XX%)
    tune2fs -l     : スーパーブロック内容を表示
    tune2fs -L XX  : ファイルシステムのボリュームラベル(XX)
    tune2fs -U XX  : UUID(XX)
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Mon Jun  5 20:26:47 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ dd if=/dev/zero of=image0.img bs=10M count=10
    
    コマンドの実行結果
    --------------------------------------------------
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.681053 s, 154 MB/s
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup /dev/loop0 image0.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mke2fs
        > -b 4096      // ブロックサイズ
        > -c           // 不良チェック
        > -L myLoop0   // ラベル指定
        > -m 1         // 管理領域
        > /dev/loop0   // デバイス
    
    コマンドの実行結果
    --------------------------------------------------
    mke2fs 1.45.6 (20-Mar-2020)
    Discarding device blocks: done                            
    Creating filesystem with 25600 4k blocks and 25600 inodes
    
    Checking for bad blocks (read-only test):   0.00% done, 0:00 elapsed. (0/0/0 errdone                                                 
    Allocating group tables: done                            
    Writing inode tables: done                            
    Writing superblocks and filesystem accounting information: done
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo tune2fs -j /dev/loop0 -> ファイルシステムをアップグレード
    
    コマンドの実行結果
    --------------------------------------------------
    tune2fs 1.45.6 (20-Mar-2020)
    Creating journal inode: done
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup -D
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ rm -f image0.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[015]
  ファイルシステム作成 - 05 (xfs)
  
[内容]
  ## 作業内容
    ファイルシステム(xfs)を作成後にマウント
  
[確認]
  上記の「11」を参照
  
================================================================================
[016]
  ファイルシステム作成 - 06 (btrfs)
  
[内容]
  ## 作業内容
    ファイルシステム(btrfs)を作成後にマウント
  
[確認]
  コマンド(mkfs.btrfs)が削除され確認できない
  
================================================================================
[017]
  コマンド(mkfs)
  
[内容]
  ## 作業内容
    コマンド(mkfs)で指定ファイルシステムを作成後にマウント
  
  ## コマンド(mkfs)
    mkfs -t XX  : ファイルシステム(XX)を指定
    mkfs -c     : 不良ブロックをチェック
  
[確認]
  上記の「11」を参照
  
================================================================================
[018]
  CD/DVD作成 - 01
  
[内容]
  ## 作業内容
    CD-ROM用のISOイメージ作成を行い、システムにマウント後にチェックする
  
  ## コマンド(mkisofs)
    mkisofs -b     : ブート可能CD
    mkisofs -o XX  : イメージファイル(XX)を指定
    mkisofs -J     : Windows
    mkisofs -r(R)  : UNIX(LongName)
    mkisofs -udf   : DVD
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Mon Jun  5 21:49:56 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ mkdir history
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ vi history/1234567890.12345
    
    コマンドの実行結果
    --------------------------------------------------
    1582年 本能寺の変
    1600年 関ヶ原の戦い
    1615年 大坂夏の陣
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ mkisofs -o history-cdrom1.iso history -> ISOイメージ(CD-ROM)を作成
    
    コマンドの実行結果
    --------------------------------------------------
    I: -input-charset not specified, using utf-8 (detected in locale settings)
    Total translation table size: 0
    Total rockridge attributes bytes: 0
    Total directory bytes: 0
    Path table size(bytes): 10
    Max brk space used 0
    175 extents written (0 MB)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ mkisofs -o history-cdrom2.iso -r(-R) history -> ISOイメージ(LongName, CD-ROM)を作成
    
    コマンドの実行結果
    --------------------------------------------------
    I: -input-charset not specified, using utf-8 (detected in locale settings)
    Total translation table size: 0
    Total rockridge attributes bytes: 257
    Total directory bytes: 0
    Path table size(bytes): 10
    Max brk space used 0
    176 extents written (0 MB)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkdir -p /mnt/cdrom1
    vm11$ sudo mkdir -p /mnt/cdrom2
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mount -r -t iso9660 history-cdrom1.iso /mnt/cdrom1 -> 読取専用でマウント
    vm11$ sudo mount -r -t iso9660 history-cdrom2.iso /mnt/cdrom2
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ lsblk
    
    コマンドの実行結果
    --------------------------------------------------
    NAME                    MAJ:MIN  RM   SIZE  RO  TYPE  MOUNTPOINT
    loop0                     7:0     0   350K   1  loop  /mnt/cdrom1
    loop1                     7:1     0   352K   1  loop  /mnt/cdrom2
    sr0                      11:0     1  1024M   0  rom   
    vda                     252:0     0    30G   0  disk  
     |-- vda1               252:1     0     1G   0  part  /boot
     |-- vda2               252:2     0    29G   0  part  
          |-- rl_vm11-root  253:0     0    26G   0  lvm   /
          |-- rl_vm11-swap  253:1     0     3G   0  lvm   [SWAP]
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ LANG=C df -mHT
    
    コマンドの実行結果
    --------------------------------------------------
    Filesystem                Type      Size  Used  Avail  Use%  Mounted on
    devtmpfs                  devtmpfs  769M     0  769M     0%  /dev
    tmpfs                     tmpfs     807M     0  807M     0%  /dev/shm
    tmpfs                     tmpfs     807M  537k  807M     1%  /run
    tmpfs                     tmpfs     807M     0  807M     0%  /sys/fs/cgroup
    tmpfs                     tmpfs     162M     0  162M     0%  /run/user/1000
    /dev/mapper/rl_vm11-root  xfs        28G  9.1G   19G    33%  /
    /dev/vda1                 xfs       1.1G  283M  782M    27%  /boot
    /dev/loop0                iso9660   359k  359k     0   100%  /mnt/cdrom1
    /dev/loop1                iso9660   361k  361k     0   100%  /mnt/cdrom2
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ ls -lh /mnt/cdrom[1-2] -> イメージ内を確認
    
    コマンドの実行結果
    --------------------------------------------------
    // cdrom1 -> ファイル名が「8.3」形式に制限
    -r-xr-xr-x 1 root root 75  6月  5 22:09 12345678.123
    
    // cdrom2
    -r--r--r-- 1 root root 75  6月  5 22:09 1234567890.12345
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ cat /mnt/cdrom[1-2]/* -> ファイル内容を確認
    
    コマンドの実行結果
    --------------------------------------------------
    // 12345678.123
    1582年 本能寺の変
    1600年 関ヶ原の戦い
    1615年 大坂夏の陣
    
    // 1234567890.12345
    1582年 本能寺の変
    1600年 関ヶ原の戦い
    1615年 大坂夏の陣
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo umount /mnt/cdrom1 /mnt/cdrom2
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ rm -f history-cdrom[1-2].iso
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[019]
  CD/DVD作成 - 02
  
[内容]
  ## 作業内容
    DVD-ROM用のISOイメージ作成を行い、システムにマウント後にチェックする
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Mon Jun  5 22:08:14 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ mkisofs -udf -o history-dvdrom1.iso history -> ISOイメージ(DVD-ROM)を作成
    
    コマンドの実行結果
    --------------------------------------------------
    I: -input-charset not specified, using utf-8 (detected in locale settings)
    Total translation table size: 0
    Total rockridge attributes bytes: 0
    Total directory bytes: 0
    Path table size(bytes): 10
    Max brk space used 0
    419 extents written (0 MB)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ mkisofs -udf -o history-dvdrom2.iso -r(-R) history -> ISOイメージ(LongName, DVD-ROM)を作成
    
    コマンドの実行結果
    --------------------------------------------------
    I: -input-charset not specified, using utf-8 (detected in locale settings)
    Total translation table size: 0
    Total rockridge attributes bytes: 257
    Total directory bytes: 0
    Path table size(bytes): 10
    Max brk space used 0
    420 extents written (0 MB)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkdir -p /mnt/dvdrom1 -> マウントポイント作成
    vm11$ sudo mkdir -p /mnt/dvdrom2
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mount -r -t iso9660 history-dvdrom1.iso /mnt/dvdrom1 -> 読取専用でマウント
    vm11$ sudo mount -r -t iso9660 history-dvdrom2.iso /mnt/dvdrom2
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ lsblk
    
    コマンドの実行結果
    --------------------------------------------------
    NAME                    MAJ:MIN  RM   SIZE  RO  TYPE  MOUNTPOINT
    loop0                     7:0     0   838K   1  loop  /mnt/dvdrom1
    loop1                     7:1     0   840K   1  loop  /mnt/dvdrom2
    sr0                      11:0     1  1024M   0  rom   
    vda                     252:0     0    30G   0  disk  
     |-- vda1               252:1     0     1G   0  part  /boot
     |-- vda2               252:2     0    29G   0  part  
          |-- rl_vm11-root  253:0     0    26G   0  lvm   /
          |-- rl_vm11-swap  253:1     0     3G   0  lvm   [SWAP]
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ LANG=C df -mHT
    
    コマンドの実行結果
    --------------------------------------------------
    Filesystem                Type      Size  Used  Avail  Use%  Mounted on
    devtmpfs                  devtmpfs  769M     0   769M    0%  /dev
    tmpfs                     tmpfs     807M     0   807M    0%  /dev/shm
    tmpfs                     tmpfs     807M  537k   807M    1%  /run
    tmpfs                     tmpfs     807M     0   807M    0%  /sys/fs/cgroup
    tmpfs                     tmpfs     162M     0   162M    0%  /run/user/1000
    /dev/mapper/rl_vm11-root  xfs        28G  9.1G    19G   33%  /
    /dev/vda1                 xfs       1.1G  283M   782M   27%  /boot
    /dev/loop0                iso9660   859k  859k      0  100%  /mnt/dvdrom1
    /dev/loop1                iso9660   861k  861k      0  100%  /mnt/dvdrom2
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ ls -lh /mnt/dvdrom[1-2] -> イメージ内を確認
    
    コマンドの実行結果
    --------------------------------------------------
    // dvdrom1 -> ファイル名が「8.3」形式に制限
    -r-xr-xr-x 1 root root 75  6月  5 22:09 12345678.123
    
    // dvdrom2
    -r--r--r-- 1 root root 75  6月  5 22:09 1234567890.12345
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ cat /mnt/dvdrom[1-2]/* -> ファイル内容を確認
    
    コマンドの実行結果
    --------------------------------------------------
    // 12345678.123
    1582年 本能寺の変
    1600年 関ヶ原の戦い
    1615年 大坂夏の陣
    
    // 1234567890.12345
    1582年 本能寺の変
    1600年 関ヶ原の戦い
    1615年 大坂夏の陣
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo umount /mnt/dvdrom1 /mnt/dvdrom2
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ rm -f history-dvdrom[1-2].iso
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[020]
  暗号化デバイス
  
[内容]
  ## 作業内容
    暗号化デバイスを作成する
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Mon Jun  5 22:36:20 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ dd if=/dev/zero of=image0.img bs=10M count=10
    
    コマンドの実行結果
    --------------------------------------------------
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.307474 s, 341 MB/s
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup /dev/loop0 image0.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo cryptsetup create sec0 /dev/loop0 -> デバイスを暗号化デバイスに変換
    
    コマンドの実行結果
    --------------------------------------------------
    /home/makoto/image0.img のパスフレーズを入力してください: (例えば ma0122ma と入力)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkfs -t xfs /dev/mapper/sec0
    
    コマンドの実行結果
    --------------------------------------------------
    meta-data = /dev/mapper/sec0   isize=512    agcount=4, agsize=6400 blks
              =                    sectsz=512   attr=2, projid32bit=1
              =                    crc=1        finobt=1, sparse=1, rmapbt=0
              =                    reflink=1    bigtime=0 inobtcount=0
    data      =                    bsize=4096   blocks=25600, imaxpct=25
              =                    sunit=0      swidth=0 blks
    naming    = version 2          bsize=4096   ascii-ci=0, ftype=1
    log       = internal log       bsize=4096   blocks=1368, version=2
              =                    sectsz=512   sunit=0 blks, lazy-count=1
    realtime  = none               extsz=4096   blocks=0, rtextents=0
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mount -o defaults /dev/mapper/sec0 /mnt
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo umount /mnt
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo cryptsetup remove sec0 -> 暗号化デバイスを元に戻す
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup -D
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ rm -f image0.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[021]
  スーパーブロック
  
[内容]
  ## 作業内容
    ファイルシステム(ext2, ext3, ext4)のスーパーブロック調査
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Tue Jun  6 09:08:27 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ dd if=/dev/zero of=image0.img bs=10M count=10
    
    コマンドの実行結果
    --------------------------------------------------
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.113037 s, 928 MB/s
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup /dev/loop0 image0.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkfs -t ext2 /dev/loop0
    
    コマンドの実行結果
    --------------------------------------------------
    (省略)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo dumpe2fs /dev/loop0 -> スーパーブロック調査
    
    コマンドの実行結果
    --------------------------------------------------
    dumpe2fs 1.45.6 (20-Mar-2020)
    Filesystem volume name:   <none>
    Last mounted on:          <not available>
    Filesystem UUID:          5a942f52-01e0-495e-a247-e6f303ce89d5
    Filesystem magic number:  0xEF53
    Filesystem revision #:    1 (dynamic)
    Filesystem features:      ext_attr resize_inode dir_index filetype sparse_super large_file
    Filesystem flags:         signed_directory_hash 
    Default mount options:    user_xattr acl
    Filesystem state:         clean  // dirty の場合は整合性チェックでエラー検出
    Errors behavior:          Continue
    Filesystem OS type:       Linux
    Inode count:              25688
    Block count:              102400
    Reserved block count:     5120
    Free blocks:              97600
    Free inodes:              25677
    First block:              1
    Block size:               1024
    Fragment size:            1024
    Reserved GDT blocks:      256
    Blocks per group:         8192
    Fragments per group:      8192
    Inodes per group:         1976
    Inode blocks per group:   247
    Filesystem created:       Tue Jun  6 09:18:24 2023
    Last mount time:          n/a
    Last write time:          Tue Jun  6 09:18:24 2023
    Mount count:              0
    Maximum mount count:      -1
    Last checked:             Tue Jun  6 09:18:24 2023
    Check interval:           0 (<none>)
    Reserved blocks uid:      0 (user root)
    Reserved blocks gid:      0 (group root)
    First inode:              11
    Inode size:               128
    Default directory hash:   half_md4
    Directory Hash Seed:      06a93942-fed0-4730-bcbf-0ff14edf5b4e
    
    Group 0: (Blocks 1-8192)
      Primary superblock at 1, Group descriptors at 2-2  // スーパーブロック「1」
      Reserved GDT blocks at 3-258
      Block bitmap at 259 (+258)
      Inode bitmap at 260 (+259)
      Inode table at 261-507 (+260)
      7671 free blocks, 1965 free inodes, 2 directories
      Free blocks: 522-8192
      Free inodes: 12-1976
    Group 1: (Blocks 8193-16384)
      Backup superblock at 8193, Group descriptors at 8194-8194  // バックアップ「8193」
      Reserved GDT blocks at 8195-8450
      Block bitmap at 8451 (+258)
      Inode bitmap at 8452 (+259)
      Inode table at 8453-8699 (+260)
      7685 free blocks, 1976 free inodes, 0 directories
      Free blocks: 8700-16384
      Free inodes: 1977-3952
    Group 2: (Blocks 16385-24576)
      Block bitmap at 16385 (+0)
      Inode bitmap at 16386 (+1)
      Inode table at 16387-16633 (+2)
      7943 free blocks, 1976 free inodes, 0 directories
      Free blocks: 16634-24576
      Free inodes: 3953-5928
    Group 3: (Blocks 24577-32768)
      Backup superblock at 24577, Group descriptors at 24578-24578  // バックアップ「24577」
      Reserved GDT blocks at 24579-24834
      Block bitmap at 24835 (+258)
      Inode bitmap at 24836 (+259)
      Inode table at 24837-25083 (+260)
      7685 free blocks, 1976 free inodes, 0 directories
      Free blocks: 25084-32768
      Free inodes: 5929-7904
    Group 4: (Blocks 32769-40960)
      Block bitmap at 32769 (+0)
      Inode bitmap at 32770 (+1)
      Inode table at 32771-33017 (+2)
      7943 free blocks, 1976 free inodes, 0 directories
      Free blocks: 33018-40960
      Free inodes: 7905-9880
    Group 5: (Blocks 40961-49152)
      Backup superblock at 40961, Group descriptors at 40962-40962  // バックアップ「40961」
      Reserved GDT blocks at 40963-41218
      Block bitmap at 41219 (+258)
      Inode bitmap at 41220 (+259)
      Inode table at 41221-41467 (+260)
      7685 free blocks, 1976 free inodes, 0 directories
      Free blocks: 41468-49152
      Free inodes: 9881-11856
    Group 6: (Blocks 49153-57344)
      Block bitmap at 49153 (+0)
      Inode bitmap at 49154 (+1)
      Inode table at 49155-49401 (+2)
      7943 free blocks, 1976 free inodes, 0 directories
      Free blocks: 49402-57344
      Free inodes: 11857-13832
    Group 7: (Blocks 57345-65536)
      Backup superblock at 57345, Group descriptors at 57346-57346  // バックアップ「57345」
      Reserved GDT blocks at 57347-57602
      Block bitmap at 57603 (+258)
      Inode bitmap at 57604 (+259)
      Inode table at 57605-57851 (+260)
      7685 free blocks, 1976 free inodes, 0 directories
      Free blocks: 57852-65536
      Free inodes: 13833-15808
    Group 8: (Blocks 65537-73728)
      Block bitmap at 65537 (+0)
      Inode bitmap at 65538 (+1)
      Inode table at 65539-65785 (+2)
      7943 free blocks, 1976 free inodes, 0 directories
      Free blocks: 65786-73728
      Free inodes: 15809-17784
    Group 9: (Blocks 73729-81920)
      Backup superblock at 73729, Group descriptors at 73730-73730  // バックアップ「73729」
      Reserved GDT blocks at 73731-73986
      Block bitmap at 73987 (+258)
      Inode bitmap at 73988 (+259)
      Inode table at 73989-74235 (+260)
      7685 free blocks, 1976 free inodes, 0 directories
      Free blocks: 74236-81920
      Free inodes: 17785-19760
    Group 10: (Blocks 81921-90112)
      Block bitmap at 81921 (+0)
      Inode bitmap at 81922 (+1)
      Inode table at 81923-82169 (+2)
      7943 free blocks, 1976 free inodes, 0 directories
      Free blocks: 82170-90112
      Free inodes: 19761-21736
    Group 11: (Blocks 90113-98304)
      Block bitmap at 90113 (+0)
      Inode bitmap at 90114 (+1)
      Inode table at 90115-90361 (+2)
      7943 free blocks, 1976 free inodes, 0 directories
      Free blocks: 90362-98304
      Free inodes: 21737-23712
    Group 12: (Blocks 98305-102399)
      Block bitmap at 98305 (+0)
      Inode bitmap at 98306 (+1)
      Inode table at 98307-98553 (+2)
      3846 free blocks, 1976 free inodes, 0 directories
      Free blocks: 98554-102399
      Free inodes: 23713-25688
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup -D
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ rm -f image0.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[022]
  ファイルシステムチェック - 01 (fsck)
  
[内容]
  ## 作業内容
    ファイルシステムチェックを行う
  
  ## コマンド(fsck)
    fsck -r     : 対話的に修復を実行
    fsck -t XX  : ファイルシステム種類(XX)のみ実行
    fsck -A     : ファイル「/etc/fstab」の全ファイルシステムに実行
    fsck -N     : 動作のシミュレートのみ
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Tue Jun  6 09:17:01 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ dd if=/dev/zero of=image0.img bs=10M count=10
    
    コマンドの実行結果
    --------------------------------------------------
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.118634 s, 884 MB/s
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup /dev/loop0 image0.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkfs -t ext4 /dev/loop0
    
    コマンドの実行結果
    --------------------------------------------------
    (省略)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo fsck -t ext4 /dev/loop0 -> ファイルシステムチェック
    
    コマンドの実行結果
    --------------------------------------------------
    fsck from util-linux 2.32.1
    e2fsck 1.45.6 (20-Mar-2020) -> 内部でコマンド(e2fsck)を実行
    /dev/loop0: clean, 11/25688 files, 8896/102400 blocks -> 異常なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo fsck -r /dev/loop0 -> 対話的にファイルシステムチェック
    
    コマンドの実行結果
    --------------------------------------------------
    fsck from util-linux 2.32.1
    e2fsck 1.45.6 (20-Mar-2020)
    /dev/loop0: clean, 11/25688 files, 8896/102400 blocks
    /dev/loop0: status 0, rss 3344, real 0.034143, user 0.002671, sys 0.001715
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup -D
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ rm -f image0.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[023]
  ファイルシステムチェック - 02 (e2fsck)
  
[内容]
  ## 作業内容
    ファイルシステムチェックを行う
  
  ## コマンド(e2fsck)
    e2fsck -b XX  : スーパーブロックのバックアップ(XX)でファイルシステム復元
    e2fsck -c     : 不良ブロックをチェック
    e2fsck -f     : ファイルシステムが「clean」でもチェック
    e2fsck -p     : 不良ブロックを自動的に修復 -> preen(身だしなみの意味)
    e2fsck -y     : 問合せに「yes」と回答
    e2fsck -n     : 問合せに「no」と回答
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Tue Jun  6 09:53:58 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ dd if=/dev/zero of=image0.img bs=10M count=10
    
    コマンドの実行結果
    --------------------------------------------------
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.112765 s, 930 MB/s
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup /dev/loop0 image0.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkfs -t ext4 /dev/loop0
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> スーパーブロックはあえてメモしない
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo e2fsck /dev/loop0 -> ファイルシステムチェック
    
    コマンドの実行結果
    --------------------------------------------------
    e2fsck 1.45.6 (20-Mar-2020)
    /dev/loop0: clean, 11/25688 files, 8896/102400 blocks
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo e2fsck -y -c /dev/loop0 -> 不良チェック、問合せにYES
    
    コマンドの実行結果
    --------------------------------------------------
    Checking for bad blocks (read-only test):   0.00% done, 0:00 elapsed.
    /dev/loop0: Updating bad block inode.
    
    Pass 1: Checking inodes, blocks, and sizes
    Pass 2: Checking directory structure
    Pass 3: Checking directory connectivity
    Pass 4: Checking reference counts
    Pass 5: Checking group summary information
    
    /dev/loop0: ***** FILE SYSTEM WAS MODIFIED *****
    /dev/loop0: 11/25688 files (0.0% non-contiguous), 8896/102400 blocks
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo e2fsck -p /dev/loop0 -> 自動修復
    
    コマンドの実行結果
    --------------------------------------------------
    /dev/loop0: clean, 11/25688 files, 8896/102400 blocks
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo dumpe2fs /dev/loop0 | grep -i superblock -> スーパーブロック確認
    
    コマンドの実行結果
    --------------------------------------------------
    dumpe2fs 1.45.6 (20-Mar-2020)
      Primary superblock at 1, Group descriptors at 2-2
      Backup superblock at 8193, Group descriptors at 8194-8194
      Backup superblock at 24577, Group descriptors at 24578-24578
      Backup superblock at 40961, Group descriptors at 40962-40962
      Backup superblock at 57345, Group descriptors at 57346-57346
      Backup superblock at 73729, Group descriptors at 73730-73730
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo e2fsck -y -b 8193 /dev/loop0 -> バックアップ(8193)使用、ファイルシステム修復、問合せにYES
    
    コマンドの実行結果
    --------------------------------------------------
    e2fsck 1.45.6 (20-Mar-2020)
    /dev/loop0 was not cleanly unmounted, check forced.
    
    Pass 1: Checking inodes, blocks, and sizes
    Pass 2: Checking directory structure
    Pass 3: Checking directory connectivity
    Pass 4: Checking reference counts
    Pass 5: Checking group summary information
    
    Padding at end of inode bitmap is not set. Fix? yes  // YESが自動入力
    Block bitmap differences: Group 1 block bitmap does not match checksum.
    FIXED.
    
    /dev/loop0: ***** FILE SYSTEM WAS MODIFIED *****
    /dev/loop0: 11/25688 files (0.0% non-contiguous), 8896/102400 blocks
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup -D
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ rm -f image0.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[024]
  ファイルシステムチェック - 03 (xfs_repair)
  
[内容]
  ## 作業内容
    ファイルシステムチェックを行う
  
  ## コマンド(xfs_repair)
    xfs_repair XX     : デバイス(XX)のチェックと修復
    xfs_repair -n XX  : デバイス(XX)のチェックのみ
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Tue Jun  6 10:32:20 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ dd if=/dev/zero of=image0.img bs=10M count=10
    
    コマンドの実行結果
    --------------------------------------------------
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.14858 s, 706 MB/s
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup /dev/loop0 image0.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkfs -t xfs /dev/loop0
    
    コマンドの実行結果
    --------------------------------------------------
    (省略)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo xfs_repair /dev/loop0 -> ファイルシステムチェックと修復
    
    コマンドの実行結果
    --------------------------------------------------
    Phase 1 - find and verify superblock...
    Phase 2 - using internal log
            - zero log...
            - scan filesystem freespace and inode maps...
            - found root inode chunk
    Phase 3 - for each AG...
            - scan and clear agi unlinked lists...
            - process known inodes and perform inode discovery...
            - agno = 0
            - agno = 1
            - agno = 2
            - agno = 3
            - process newly discovered inodes...
    Phase 4 - check for duplicate blocks...
            - setting up duplicate extent list...
            - check for inodes claiming duplicate blocks...
            - agno = 0
            - agno = 1
            - agno = 2
            - agno = 3
    Phase 5 - rebuild AG headers and trees...
            - reset superblock...
    Phase 6 - check inode connectivity...
            - resetting contents of realtime bitmap and summary inodes
            - traversing filesystem ...
            - traversal finished ...
            - moving disconnected inodes to lost+found ...
    Phase 7 - verify and correct link counts...
    done
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup -D
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ rm -f image0.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[025]
  ファイルシステム管理(ext2,ext3,ext4) - 01 (tune2fs)
  
[内容]
  ## 作業内容
    ファイルシステム管理を行う
  
  ## コマンド(tune2fs)
    tune2fs -c XX  : 最大マウント回数(XX)でファイルシステムチェック
    tune2fs -C XX  : 現在のマウント回数を設定
    tune2fs -i XX  : ファイルシステムチェック間隔(XX日)
    tune2fs -j     : ext2からext3に変換
    tune2fs -m XX  : 管理領域の割合
    tune2fs -l     : スーパーブロック内容を表示
    tune2fs -L XX  : ファイルシステムのボリュームラベル(XX)
    tune2fs -U XX  : UUID(XX)
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Tue Jun  6 12:03:16 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ dd if=/dev/zero of=image0.img bs=10M count=10
    
    コマンドの実行結果
    --------------------------------------------------
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.101355 s, 1.0 GB/s
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup /dev/loop0 image0.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkfs -t ext2 /dev/loop0
    
    コマンドの実行結果
    --------------------------------------------------
    (省略)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo tune2fs -j /dev/loop0 -> ファイルシステムのアップグレード
    
    コマンドの実行結果
    --------------------------------------------------
    tune2fs 1.45.6 (20-Mar-2020)
    Creating journal inode: done
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo tune2fs -m 1 /dev/loop0 -> 管理領域の割合を1%に変更
    
    コマンドの実行結果
    --------------------------------------------------
    tune2fs 1.45.6 (20-Mar-2020)
    Setting reserved blocks percentage to 1% (1024 blocks)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo tune2fs -l /dev/loop0 -> スーパーブロックの内容表示
    
    コマンドの実行結果
    --------------------------------------------------
    tune2fs 1.45.6 (20-Mar-2020)
    Filesystem volume name:   <none>
    Last mounted on:          <not available>
    Filesystem UUID:          fd9fb7bc-f919-4e52-beee-93f2a380105f
    Filesystem magic number:  0xEF53
    Filesystem revision #:    1 (dynamic)
    Filesystem features:      has_journal ext_attr resize_inode dir_index filetype sparse_super large_file
    Filesystem flags:         signed_directory_hash 
    Default mount options:    user_xattr acl
    Filesystem state:         clean
    Errors behavior:          Continue
    Filesystem OS type:       Linux
    Inode count:              25688
    Block count:              102400
    Reserved block count:     1024
    Free blocks:              93487
    Free inodes:              25677
    First block:              1
    Block size:               1024
    Fragment size:            1024
    Reserved GDT blocks:      256
    Blocks per group:         8192
    Fragments per group:      8192
    Inodes per group:         1976
    Inode blocks per group:   247
    Filesystem created:       Tue Jun  6 12:28:54 2023
    Last mount time:          n/a
    Last write time:          Tue Jun  6 12:29:33 2023
    Mount count:              0
    Maximum mount count:      -1
    Last checked:             Tue Jun  6 12:28:54 2023
    Check interval:           0 (<none>)
    Reserved blocks uid:      0 (user root)
    Reserved blocks gid:      0 (group root)
    First inode:              11
    Inode size:               128
    Journal inode:            8
    Default directory hash:   half_md4
    Directory Hash Seed:      b0304565-52b1-4ed4-9523-c15e576c5949
    Journal backup:           inode blocks
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo tune2fs -L AAA /dev/loop0 -> ボリュームラベル変更
    
    コマンドの実行結果
    --------------------------------------------------
    tune2fs 1.45.6 (20-Mar-2020)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo tune2fs -l /dev/loop0 | grep 'volume name' -> ボリュームラベル確認
    
    コマンドの実行結果
    --------------------------------------------------
    Filesystem volume name: AAA
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo tune2fs -l /dev/loop0 | grep 'UUID' -> UUID確認
    
    コマンドの実行結果
    --------------------------------------------------
    Filesystem UUID:  fd9fb7bc-f919-4e52-beee-93f2a380105f
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo tune2fs -U $(uuidgen) /dev/loop0 -> UUID変更
    
    コマンドの実行結果
    --------------------------------------------------
    tune2fs 1.45.6 (20-Mar-2020)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo tune2fs -l /dev/loop0 | grep 'UUID' -> UUID確認
    
    コマンドの実行結果
    --------------------------------------------------
    Filesystem UUID:  7d00cd45-4c4f-4857-a359-376b6e3dad58
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup -D
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ rm -f image0.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[026]
  ファイルシステム管理(ext2,ext3,ext4) - 02 (badblocks)
  
[内容]
  ## 作業内容
    ファイルシステム管理を行う
  
  ## コマンド(badblocks)
    badblocks -b XX  : ブロックサイズ(XX)を指定
    badblocks -o XX  : 結果をファイル(XX)に出力
    badblocks -w     : 書込モードでテスト -> ファイルシステム破壊？
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Tue Jun  6 12:27:57 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ dd if=/dev/zero of=image0.img bs=10M count=10
    
    コマンドの実行結果
    --------------------------------------------------
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.11985 s, 875 MB/s
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup /dev/loop0 image0.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkfs -t ext4 /dev/loop0
    
    コマンドの実行結果
    --------------------------------------------------
    (省略)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo tune2fs -l /dev/loop0 | grep -i 'block size' -> ブロックサイズの確認
    
    コマンドの実行結果
    --------------------------------------------------
    Block size: 1024
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo badblocks -b 1024 /dev/loop0 -> 不良ブロックの検索
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup -D
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ rm -f image0.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[027]
  ファイルシステム管理(ext2,ext3,ext4) - 03 (debugfs)
  
[内容]
  ## 作業内容
    ファイルシステム管理を行う
  
  ## コマンド(debugfs)
    debugfs -w     : 書込可能モードで開く(デフォルトは読取専用)
    debugfs -s XX  : スーパーブロック(XX)を指定
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Tue Jun  6 13:03:18 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ dd if=/dev/zero of=image0.img bs=10M count=10
    
    コマンドの実行結果
    --------------------------------------------------
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.113652 s, 923 MB/s
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup /dev/loop0 image0.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkfs -t ext4 /dev/loop0
    
    コマンドの実行結果
    --------------------------------------------------
    (省略)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mount -o defaults /dev/loop0 /mnt
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo vi /mnt/sample.txt
    
    コマンドの実行結果
    --------------------------------------------------
    Hello World
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo debugfs -w /dev/loop0 -> 書込可能モードで実行
    
    コマンドの実行結果
    --------------------------------------------------
    debugfs 1.45.6 (20-Mar-2020)
    
    debugfs: 
    debugfs: ls -l
    
     2   40755 (2)       0       0    1024  6-Jun-2023 13:43 .
     2   40755 (2)       0       0    1024  6-Jun-2023 13:43 ..
    11   40700 (2)       0       0   12288  6-Jun-2023 13:42 lost+found
    13  100644 (1)       0       0      12  6-Jun-2023 13:43 sample.txt  // iノード番号は「13」
    
    debugfs: 
    debugfs: cat sample.txt  // ファイル内容を出力
    
    Hello World
    
    debugfs: 
    debugfs: stat sample.txt  // iノードの内容を表示
    
    Inode: 13   Type: regular   Mode:  0644   Flags: 0x80000
    Generation: 2380734287   Version: 0x00000001
    User: 0   Group: 0   Size: 12
    File ACL: 0
    Links: 1   Blockcount: 2
    Fragment:  Address: 0    Number: 0    Size: 0
    ctime: 0x647eb98f -- Tue Jun  6 13:43:59 2023
    atime: 0x647eb98f -- Tue Jun  6 13:43:59 2023
    mtime: 0x647eb98f -- Tue Jun  6 13:43:59 2023
    Inode checksum: 0x0000ebf5
    EXTENTS:
    (0):8705
    
    debugfs: 
    debugfs:  freei sample.txt  // ファイルのiノードを消去 -> データ部分のみの不整合状態
    
    (消去時にメッセージ等の出力なし)
    
    debugfs: 
    debugfs:  quit
    
    (OSプロンプトに戻る)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo umount /mnt
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> アンマウントまたは読取専用の状態でないとファイルシステムが壊れる
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo dumpe2fs /dev/loop0 | grep -i superblock
    
    コマンドの実行結果
    --------------------------------------------------
    dumpe2fs 1.45.6 (20-Mar-2020)
      Primary superblock at 1, Group descriptors at 2-2
      Backup superblock at 8193, Group descriptors at 8194-8194
      Backup superblock at 24577, Group descriptors at 24578-24578
      Backup superblock at 40961, Group descriptors at 40962-40962
      Backup superblock at 57345, Group descriptors at 57346-57346
      Backup superblock at 73729, Group descriptors at 73730-73730
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo e2fsck -y -b 8193 /dev/loop0 -> バックアップ(8193)使用、ファイルシステム修復、問合せにYES
    
    コマンドの実行結果
    --------------------------------------------------
    e2fsck 1.45.6 (20-Mar-2020)
    /dev/loop0 was not cleanly unmounted, check forced.
    
    Pass 1: Checking inodes, blocks, and sizes
    Pass 2: Checking directory structure
    Pass 3: Checking directory connectivity
    Pass 4: Checking reference counts
    Pass 5: Checking group summary information
    
    Block bitmap differences:  +(24577--24834) +(40961--41218) +(57345--57602) +(73729--73986)
    Fix? yes  // 問合せにYESを自動入力
    
    Free blocks count wrong for group #1 (7934, counted=7933).
    Fix? yes  // 問合せにYESを自動入力
    
    Free blocks count wrong (93504, counted=93503).
    Fix? yes  // 問合せにYESを自動入力
    
    Inode bitmap differences:  +13
    Fix? yes  // 問合せにYESを自動入力
    
    Free inodes count wrong for group #0 (1965, counted=1964).
    Fix? yes  // 問合せにYESを自動入力
    
    Free inodes count wrong (25677, counted=25676).
    Fix? yes  // 問合せにYESを自動入力
    
    Padding at end of inode bitmap is not set.
    Fix? yes  // 問合せにYESを自動入力
    
    /dev/loop0: ***** FILE SYSTEM WAS MODIFIED *****
    /dev/loop0: 12/25688 files (0.0% non-contiguous), 8897/102400 blocks
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mount -o defaults /dev/loop0 /mnt
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ ls -li /mnt
    
    コマンドの実行結果
    --------------------------------------------------
    11 drwx------ 2 root root 12288  6月  6 13:42 lost+found
    13 -rw-r--r-- 1 root root    12  6月  6 13:43 sample.txt
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo cat /mnt/sample.txt
    
    コマンドの実行結果
    --------------------------------------------------
    Hello World
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo umount /mnt
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup -D
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ rm -f image0.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[028]
  S.M.A.R.T
  
[内容]
  ## 作業内容
    ディスクの自己診断
  
  ## コマンド(smartctl)
    smartctl -a  : 自己診断情報を表示
    smartctl -t  : セルフテスト実施
    smartctl -l  : ログタイプ指定
    smartctl -H  : 状態を表示
  
[確認]
  $ cd $HOME
  $ dnf list installed | grep smartmontools
  
  コマンドの実行結果
  --------------------------------------------------
  smartmontools.x86_64  1:7.1-1.el8
  --------------------------------------------------
  
  $ cd $HOME
  $ lsblk
  
  コマンドの実行結果
  --------------------------------------------------
  NAME               MAJ:MIN  RM   SIZE  RO  TYPE  MOUNTPOINT
  sda                  8:0     0   477G   0  disk  
   |-- sda1            8:1     0     1G   0  part  /boot
   |-- sda2            8:2     0   476G   0  part  
        |-- rl-root  253:0     0    70G   0  lvm   /
        |-- rl-swap  253:1     0   3.9G   0  lvm   [SWAP]
        |-- rl-home  253:2     0 402.1G   0  lvm   /home
  --------------------------------------------------
  
  $ cd $HOME
  $ sudo smartctl -a /dev/sda -> 自己診断情報を表示
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 表示項目が理解不能
  --------------------------------------------------
  
  $ cd $HOME
  $ sudo smartctl -H /dev/sda -> 状態を表示
  
  コマンドの実行結果
  --------------------------------------------------
  smartctl 7.1 2020-04-05 r5049 [x86_64-linux-4.18.0-425.19.2.el8_7.x86_64] (local build)
  Copyright (C) 2002-19, Bruce Allen, Christian Franke, www.smartmontools.org
  
  === START OF READ SMART DATA SECTION ===
  SMART overall-health self-assessment test result: PASSED -> テスト合格！
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[029]
  ファイルシステム管理(xfs) - 01 (xfs_admin)
  
[内容]
  ## 作業内容
    ファイルシステム管理を行う
  
  ## コマンド(xfs_admin)
    xfs_admin -u     : UUID表示
    xfs_admin -U XX  : UUID(XX)を設定
    xfs_admin -l     : ラベル表示
    xfs_admin -L XX  : ラベル(XX)を設定
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Tue Jun  6 13:41:47 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ dd if=/dev/zero of=image0.img bs=10M count=10
    
    コマンドの実行結果
    --------------------------------------------------
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.148586 s, 706 MB/s
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup /dev/loop0 image0.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkfs -t xfs /dev/loop0
    
    コマンドの実行結果
    --------------------------------------------------
    (省略)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mount -o defaults /dev/loop0 /mnt
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo xfs_info /dev/loop0
    
    コマンドの実行結果
    --------------------------------------------------
    meta-data = /dev/loop0     isize=512    agcount=4, agsize=6400 blks
              =                sectsz=512   attr=2, projid32bit=1
              =                crc=1        finobt=1, sparse=1, rmapbt=0
              =                reflink=1    bigtime=0 inobtcount=0
    data      =                bsize=4096   blocks=25600, imaxpct=25
              =                sunit=0      swidth=0 blks
    naming    = version 2      bsize=4096   ascii-ci=0, ftype=1
    log       = internal log   bsize=4096   blocks=1368, version=2
              =                sectsz=512   sunit=0 blks, lazy-count=1
    realtime  = none           extsz=4096   blocks=0, rtextents=0
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo umount /mnt
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo xfs_admin -u /dev/loop0 -> UUID表示
    
    コマンドの実行結果
    --------------------------------------------------
    UUID = eb5910a5-b6ec-47d1-9ae0-d1baaf043091
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo xfs_admin -U $(uuidgen) /dev/loop0 -> UUID設定
    
    コマンドの実行結果
    --------------------------------------------------
    Clearing log and setting UUID
    writing all SBs
    new UUID = 0a71404f-a822-48e9-8642-f784ea3d91ce
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo xfs_admin -u /dev/loop0 -> UUID表示
    
    コマンドの実行結果
    --------------------------------------------------
    UUID = 0a71404f-a822-48e9-8642-f784ea3d91ce
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo xfs_admin -l /dev/loop0 -> ラベル表示
    
    コマンドの実行結果
    --------------------------------------------------
    label = ""
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo xfs_admin -L 'AAA' /dev/loop0 -> ラベル設定
    
    コマンドの実行結果
    --------------------------------------------------
    writing all SBs
    new label = "AAA"
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo xfs_admin -l /dev/loop0 -> ラベル表示
    
    コマンドの実行結果
    --------------------------------------------------
    label = "AAA"
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup -D
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ rm -f image0.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[030]
  ファイルシステム管理(xfs) - 02 (xfs_info)
  
[内容]
  ## 作業内容
    ファイルシステム管理を行う
  
[確認]
  上記の「29」を参照
  
================================================================================
[031]
  ファイルシステム管理(xfs) - 03 (xfsdump)
  
[内容]
  ## 作業内容
    ファイルシステム管理を行う
  
  ## コマンド(xfsdump)
    xfsdump -f XX  : 出力ファイル名(XX)を指定
    xfsdump -l XX  : ダンプレベル(XX)を指定
    xfsdump -J     : ダンプ情報データベース更新しない
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Tue Jun  6 15:08:13 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ dd if=/dev/zero of=image0.img bs=10M count=10
    vm11$ dd if=/dev/zero of=image1.img bs=10M count=10
    
    コマンドの実行結果
    --------------------------------------------------
    // image0.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.124907 s, 839 MB/s

    // image1.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.516994 s, 203 MB/s
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup /dev/loop0 image0.img
    vm11$ sudo losetup /dev/loop1 image1.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkfs -t xfs /dev/loop0
    vm11$ sudo mkfs -t xfs /dev/loop1
    
    コマンドの実行結果
    --------------------------------------------------
    (省略)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mount -o defaults /dev/loop0 /mnt/loop0
    vm11$ sudo mount -o defaults /dev/loop1 /mnt/loop1
    
    コマンドの実行結果
    --------------------------------------------------
    (省略)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo vi /mnt/loop0/sample1.txt
    
    コマンドの実行結果
    --------------------------------------------------
    sample1
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo xfsdump         // 全体バックアップ
        > -f loop0-level0.dmp  // バックアップファイル
        > -l 0                 // バックアップレベル
        > /mnt/loop0           // バックアップ対象
    
    コマンドの実行結果
    --------------------------------------------------
    xfsdump: using file dump (drive_simple) strategy
    xfsdump: version 3.1.8 (dump format 3.0) - type ^C for status and control
    
    please enter label for this dump session (timeout in 300 sec)
    -> loop0-level0-sess  // セッションラベル入力
    session label entered: "loop0-level0-sess"
    
    xfsdump: level 0 dump of vm11:/mnt/loop0
    xfsdump: dump date: Tue Jun  6 18:15:26 2023
    xfsdump: session id: 12647fe3-4e3a-4f54-b135-788ab949887f
    xfsdump: session label: "loop0-level0-sess"
    xfsdump: ino map phase 1: constructing initial dump list
    xfsdump: ino map phase 2: skipping (no pruning necessary)
    xfsdump: ino map phase 3: skipping (only one dump stream)
    xfsdump: ino map construction complete
    xfsdump: estimated dump size: 25216 bytes
    
    please enter label for media in drive 0 (timeout in 300 sec)
    -> loop0-level0-media  // メディアラベル入力
    media label entered: "loop0-level0-media"
    
    xfsdump: creating dump session media file 0 (media 0, file 0)
    xfsdump: dumping ino map
    xfsdump: dumping directories
    xfsdump: dumping non-directory files
    xfsdump: ending media file
    xfsdump: media file size 21880 bytes
    xfsdump: dump size (non-dir files) : 544 bytes
    xfsdump: dump complete: 67 seconds elapsed
    xfsdump: Dump Summary:
    xfsdump: stream 0 /home/makoto/loop0-level0.dmp OK (success)
    xfsdump: Dump Status: SUCCESS
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo vi /mnt/loop0/sample2.txt
    
    コマンドの実行結果
    --------------------------------------------------
    sample2
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo xfsdump         // 増分バックアップ
        > -f loop0-level1.dmp  // バックアップファイル
        > -l 1                 // バックアップレベル
        > /mnt/loop0           // バックアップ対象
    
    コマンドの実行結果
    --------------------------------------------------
    xfsdump: using file dump (drive_simple) strategy
    xfsdump: version 3.1.8 (dump format 3.0) - type ^C for status and control
    
    please enter label for this dump session (timeout in 300 sec)
    -> loop0-level1-sess  // セッションラベル入力
    session label entered: "loop0-level1-sess"
    
    xfsdump: level 1 incremental dump of vm11:/mnt/loop0 based on level 0 dump begun Tue Jun  6 18:15:26 2023
    xfsdump: dump date: Tue Jun  6 18:21:46 2023
    xfsdump: session id: 6bf6e7e8-0d44-4e29-880a-5d5567edcfa2
    xfsdump: session label: "loop0-level1-sess"
    xfsdump: ino map phase 1: constructing initial dump list
    xfsdump: ino map phase 2: skipping (no pruning necessary)
    xfsdump: ino map phase 3: skipping (only one dump stream)
    xfsdump: ino map construction complete
    xfsdump: estimated dump size: 25216 bytes
    
    please enter label for media in drive 0 (timeout in 300 sec)
    -> loop0-level1-media  // メディアラベル入力
    media label entered: "loop0-level1-media"
    
    xfsdump: creating dump session media file 0 (media 0, file 0)
    xfsdump: dumping ino map
    xfsdump: dumping directories
    xfsdump: dumping non-directory files
    xfsdump: ending media file
    xfsdump: media file size 21912 bytes
    xfsdump: dump size (non-dir files) : 544 bytes
    xfsdump: dump complete: 23 seconds elapsed
    xfsdump: Dump Summary:
    xfsdump: stream 0 /home/makoto/loop0-level1.dmp OK (success)
    xfsdump: Dump Status: SUCCESS
    --------------------------------------------------
    
    vm11$ cd /mnt/loop0
    vm11$ sudo vi /mnt/loop0/sample3.txt
    
    コマンドの実行結果
    --------------------------------------------------
    sample3
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo xfsdump         // 増分バックアップ
        > -f loop0-level2.dmp  // バックアップファイル
        > -l 2                 // バックアップレベル
        > /mnt/loop0           // バックアップ対象
    
    コマンドの実行結果
    --------------------------------------------------
    xfsdump: using file dump (drive_simple) strategy
    xfsdump: version 3.1.8 (dump format 3.0) - type ^C for status and control
    
    please enter label for this dump session (timeout in 300 sec)
    -> loop0-level2-sess  // セッションラベル入力
    session label entered: "loop0-level2-sess"
    
    xfsdump: level 2 incremental dump of vm11:/mnt/loop0 based on level 1 dump begun Tue Jun  6 18:21:46 2023
    xfsdump: dump date: Tue Jun  6 18:26:00 2023
    xfsdump: session id: e1cda028-d0f5-479b-8930-67840d5cdd13
    xfsdump: session label: "loop0-level2-sess"
    xfsdump: ino map phase 1: constructing initial dump list
    xfsdump: ino map phase 2: skipping (no pruning necessary)
    xfsdump: ino map phase 3: skipping (only one dump stream)
    xfsdump: ino map construction complete
    xfsdump: estimated dump size: 25216 bytes
    
    please enter label for media in drive 0 (timeout in 300 sec)
    -> loop0-level2-media  // メディアラベル入力
    media label entered: "loop0-level2-media"
    
    xfsdump: creating dump session media file 0 (media 0, file 0)
    xfsdump: dumping ino map
    xfsdump: dumping directories
    xfsdump: dumping non-directory files
    xfsdump: ending media file
    xfsdump: media file size 21944 bytes
    xfsdump: dump size (non-dir files) : 544 bytes
    xfsdump: dump complete: 28 seconds elapsed
    xfsdump: Dump Summary:
    xfsdump: stream 0 /home/makoto/loop0-level2.dmp OK (success)
    xfsdump: Dump Status: SUCCESS
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ ls -lh | grep loop0-level -> バックアップファイル確認
    
    コマンドの実行結果
    --------------------------------------------------
    -rw-r--r--  1 root   root    22K  6月  6 18:16 loop0-level0.dmp
    -rw-r--r--  1 root   root    22K  6月  6 18:22 loop0-level1.dmp
    -rw-r--r--  1 root   root    22K  6月  6 18:26 loop0-level2.dmp
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ xfsrestore -I | grep -E 'session|media' -> セッションラベルとメディアラベル
    
    コマンドの実行結果
    --------------------------------------------------
    session 0:
      session label: "loop0-level0-sess"
      session id: 12647fe3-4e3a-4f54-b135-788ab949887f
        media files: 1
        media file 0:
          media label: "loop0-level0-media"
          media id: c9547123-5586-45b3-8f07-73987ca4e96a
    
    session 1:
      session label: "loop0-level1-sess"
      session id: 6bf6e7e8-0d44-4e29-880a-5d5567edcfa2
        media files: 1
        media file 0:
          media label: "loop0-level1-media"
          media id: 4f38ae85-a8d0-484c-9e1d-7687587a19c3
    
    session 2:
      session label: "loop0-level2-sess"
      session id: e1cda028-d0f5-479b-8930-67840d5cdd13
        media files: 1
        media file 0:
          media label: "loop0-level2-media"
          media id: c7e08184-8f09-4802-8325-4d21cbc05a4b
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo xfsrestore       // 完全バックアップをレストア
        > -L loop0-level0-sess  // セッションラベル
        > -f loop0-level0.dmp   // バックアップファイル
        > /mnt/loop1            // レストア先
    
    コマンドの実行結果
    --------------------------------------------------
    xfsrestore: using file dump (drive_simple) strategy
    xfsrestore: version 3.1.8 (dump format 3.0) - type ^C for status and control
    xfsrestore: using online session inventory
    xfsrestore: searching media for directory dump
    xfsrestore: examining media file 0
    xfsrestore: reading directories
    xfsrestore: 1 directories and 1 entries processed
    xfsrestore: directory post-processing
    xfsrestore: restoring non-directory files
    xfsrestore: restore complete: 0 seconds elapsed
    xfsrestore: Restore Summary:
    xfsrestore: stream 0 /home/makoto/loop0-level0.dmp OK (success)
    xfsrestore: Restore Status: SUCCESS
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ ls -lh /mnt/loop1
    
    コマンドの実行結果
    --------------------------------------------------
    -rw-r--r-- 1 root root 8  6月  6 18:14 sample1.txt
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo xfsrestore       // 増分バックアップをレストア
        > -L loop0-level1-sess  // セッションラベル
        > -f loop0-level1.dmp   // バックアップファイル
        > /mnt/loop1            // レストア先
    
    コマンドの実行結果
    --------------------------------------------------
    xfsrestore: using file dump (drive_simple) strategy
    xfsrestore: version 3.1.8 (dump format 3.0) - type ^C for status and control
    xfsrestore: using online session inventory
    xfsrestore: searching media for directory dump
    xfsrestore: examining media file 0
    xfsrestore: reading directories
    xfsrestore: 1 directories and 2 entries processed
    xfsrestore: directory post-processing
    xfsrestore: restoring non-directory files
    xfsrestore: restore complete: 0 seconds elapsed
    xfsrestore: Restore Summary:
    xfsrestore: stream 0 /home/makoto/loop0-level1.dmp OK (success)
    xfsrestore: Restore Status: SUCCESS
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ ls -lh /mnt/loop1
    
    コマンドの実行結果
    --------------------------------------------------
    -rw-r--r-- 1 root root 8  6月  6 18:14 sample1.txt
    -rw-r--r-- 1 root root 8  6月  6 18:21 sample2.txt
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo xfsrestore       // 増分バックアップをレストア
        > -L loop0-level2-sess  // セッションラベル
        > -f loop0-level2.dmp   // バックアップファイル
        > /mnt/loop1            // レストア先
    
    コマンドの実行結果
    --------------------------------------------------
    xfsrestore: using file dump (drive_simple) strategy
    xfsrestore: version 3.1.8 (dump format 3.0) - type ^C for status and control
    xfsrestore: using online session inventory
    xfsrestore: searching media for directory dump
    xfsrestore: examining media file 0
    xfsrestore: reading directories
    xfsrestore: 1 directories and 3 entries processed
    xfsrestore: directory post-processing
    xfsrestore: restoring non-directory files
    xfsrestore: restore complete: 0 seconds elapsed
    xfsrestore: Restore Summary:
    xfsrestore: stream 0 /home/makoto/loop0-level2.dmp OK (success)
    xfsrestore: Restore Status: SUCCESS
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ ls -lh /mnt/loop1
    
    コマンドの実行結果
    --------------------------------------------------
    -rw-r--r-- 1 root root 8  6月  6 18:14 sample1.txt
    -rw-r--r-- 1 root root 8  6月  6 18:21 sample2.txt
    -rw-r--r-- 1 root root 8  6月  6 18:25 sample3.txt
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ diff -r /mnt/loop0 /mnt/loop1
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo umount /mnt/loop0 /mnt/loop1
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup -D
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ rm -f image[0-1].img loop0-level[0-2].dmp
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[032]
  ファイルシステム管理(xfs) - 04 (xfsrestore)
  
[内容]
  ## 作業内容
    ファイルシステム管理を行う
  
  ## コマンド(xfsrestore)
    xfsrestore -f XX  : バックアップファイル(XX)を指定
    xfsrestore -S XX  : セッションID(XX)を指定
    xfsrestore -L XX  : セッションラベル(XX)を指定
    xfsrestore -r     : 増分バックアップからリストア
    xfsrestore -i     : 対話的にリストア
    xfsrestore -I     : 全ダンプのセッションIDとセッションラベルを表示
  
[確認]
  上記の「31」を参照
  
================================================================================
[033]
  ファイルシステム管理(xfs) - 05 (xfs_repair)
  
[内容]
  ## 作業内容
    ファイルシステム管理を行う
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Tue Jun  6 17:50:42 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ dd if=/dev/zero of=image0.img bs=10M count=10
    
    コマンドの実行結果
    --------------------------------------------------
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.188613 s, 556 MB/s
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup /dev/loop0 image0.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkfs -t xfs /dev/loop0
    
    コマンドの実行結果
    --------------------------------------------------
    (省略)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo xfs_repair /dev/loop0
    
    コマンドの実行結果
    --------------------------------------------------
    Phase 1 - find and verify superblock...
    Phase 2 - using internal log
            - zero log...
            - scan filesystem freespace and inode maps...
            - found root inode chunk
    Phase 3 - for each AG...
            - scan and clear agi unlinked lists...
            - process known inodes and perform inode discovery...
            - agno = 0
            - agno = 1
            - agno = 2
            - agno = 3
            - process newly discovered inodes...
    Phase 4 - check for duplicate blocks...
            - setting up duplicate extent list...
            - check for inodes claiming duplicate blocks...
            - agno = 0
            - agno = 1
            - agno = 2
            - agno = 3
    Phase 5 - rebuild AG headers and trees...
            - reset superblock...
    Phase 6 - check inode connectivity...
            - resetting contents of realtime bitmap and summary inodes
            - traversing filesystem ...
            - traversal finished ...
            - moving disconnected inodes to lost+found ...
    Phase 7 - verify and correct link counts...
    done
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup -D
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ rm -f image0.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
[034]
  ファイルシステム管理(btrfs) - 01 (btrfs)
  
[内容]
  ## 作業内容
    ファイルシステム管理を行う => 仮想マシン(vm11)がCentOS7の頃の記録
  
[確認]
  vm11$ cd $HOME
  vm11$ LANG=C dd if=/dev/zero of=image0.img bs=10M count=10
  
  コマンドの実行結果
  --------------------------------------------------
  10+0 records in
  10+0 records out
  104857600 bytes (105 MB) copied, 0.12708 s, 825 MB/s
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo losetup /dev/loop0 image0.img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo mkfs -t btrfs /dev/loop0
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo btrfs filesystem show -> ファイルシステムの情報を表示
  
  コマンドの実行結果
  --------------------------------------------------
  Label: none  uuid: 33d15954-3b5c-4a95-9527-5bdd5a14483e
    Total devices 1 FS bytes used 112.00KiB
    devid 1 size 100.00MiB used 88.00MiB path /dev/loop0
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo mount -o defaults /dev/loop0 /mnt
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo btrfs filesystem df /mnt -> マウントしたファイルシステムの使用状況
  
  コマンドの実行結果
  --------------------------------------------------
  Data, single: total=8.00MiB, used=0.00B
  System, DUP: total=8.00MiB, used=16.00KiB
  Metadata, DUP: total=32.00MiB, used=112.00KiB
  GlobalReserve, single: total=16.00MiB, used=0.00B
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo btrfs subvolume create /mnt/sub1 -> サブボリューム作成
  vm11$ sudo btrfs subvolume create /mnt/sub2 -> サブボリューム作成
  
  コマンドの実行結果
  --------------------------------------------------
  Create subvolume '/mnt/sub1'
  Create subvolume '/mnt/sub2'
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo btrfs subvolume list /mnt -> 作成したサブボリューム確認
  
  コマンドの実行結果
  --------------------------------------------------
  ID 256 gen 7 top level 5 path sub1
  ID 257 gen 8 top level 5 path sub2
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo umount /mnt -> 予めトップレベルのボリュームをアンマウント
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo mount -o defaults,subvolid=256 -t btrfs /dev/loop0 /mnt/loop1 -> サブボリュームを個別にマウント
  vm11$ sudo mount -o defaults,subvolid=257 -t btrfs /dev/loop0 /mnt/loop2 -> サブボリュームを個別にマウント
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo umount /mnt/loop1 /mnt/loop2
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo losetup -D
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ rm -f image0.img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[035]
  ファイルシステム管理(btrfs) - 02 (btrfs-convert)
  
[内容]
  ## 作業内容
    ファイルシステム変換を行う => 仮想マシン(vm11)がCentOS7の頃の記録
  
[確認]
  vm11$ cd $HOME
  vm11$ LANG=C dd if=/dev/zero of=image0.img bs=10M count=10
  
  コマンドの実行結果
  --------------------------------------------------
  10+0 records in
  10+0 records out
  104857600 bytes (105 MB) copied, 0.3301 s, 318 MB/s
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo losetup /dev/loop0 image0.img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo mkfs -t ext4 -b 4096 /dev/loop0
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> ブロックサイズが4096未満の場合、後の「btrfs」への変換時にエラー出力
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo btrfs-convert /dev/loop0 -> ファイルシステム変換
  
  コマンドの実行結果
  --------------------------------------------------
  create btrfs filesystem:
    blocksize: 4096
    nodesize:  16384
    features:  extref, skinny-metadata (default)
  creating ext2 image file
  creating btrfs metadatacopy inodes [o] [   2/  11]
  conversion complete
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo mount -o defaults -t btrfs /dev/loop0 /mnt
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo umount /mnt
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ sudo losetup -D
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm11$ cd $HOME
  vm11$ rm -f image0.img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[036]
  オートマウント
  
[内容]
  ## 作業内容
    ディレクトリ「/mnt/auto/dir0」に移動時にデバイス「/dev/loop0」を自動マウントする
    ディレクトリ「/mnt/auto/dir1」に移動時にデバイス「/dev/loop1」を自動マウントする
  
[確認]
  $ cd $HOME
  $ ssh vm11 -> 公開鍵認証でSSH接続
  
  コマンドの実行結果
  --------------------------------------------------
  Last login: Tue Jun  6 19:04:10 2023 from 192.168.122.1
  --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ dd if=/dev/zero of=loop0.img bs=10M count=10
    vm11$ dd if=/dev/zero of=loop1.img bs=10M count=10
    
    コマンドの実行結果
    --------------------------------------------------
    // loop0.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.168887 s, 621 MB/s
    
    // loop1.img
    10+0 レコード入力
    10+0 レコード出力
    104857600 bytes (105 MB, 100 MiB) copied, 0.482773 s, 217 MB/s
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup /dev/loop0 loop0.img
    vm11$ sudo losetup /dev/loop1 loop1.img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo mkfs -t ext4 /dev/loop0
    vm11$ sudo mkfs -t ext4 /dev/loop1
    
    コマンドの実行結果
    --------------------------------------------------
    (省略)
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo vi /etc/auto.master -> 設定ファイルの修正
    
    コマンドの実行結果
    --------------------------------------------------
    /misc /etc/auto.misc
    /net  -hosts
    +dir:/etc/auto.master.d
    +auto.master
    /mnt/auto /etc/auto.dir  // ディレクトリ「/mnt/auto」移動時に設定ファイル「/etc/auto.dir」の内容でマウント
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo vi /etc/auto.dir -> 設定ファイルの追加
    
    コマンドの実行結果
    --------------------------------------------------
    dir0  -fstype=ext4,rw  :/dev/loop0
    dir1  -fstype=ext4,rw  :/dev/loop1
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo systemctl restart autofs
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ lsblk
    
    コマンドの実行結果
    --------------------------------------------------
    NAME                    MAJ:MIN  RM  SIZE  RO  TYPE  MOUNTPOINT
    loop0                     7:0     0  100M   0  loop  (オートマウント前)
    loop1                     7:1     0  100M   0  loop  (オートマウント前)
    sr0                      11:0     1 1024M   0  rom   
    vda                     252:0     0   30G   0  disk  
     |-- vda1               252:1     0    1G   0  part  /boot
     |-- vda2               252:2     0   29G   0  part  
          |-- rl_vm11-root  253:0     0   26G   0  lvm   /
          |-- rl_vm11-swap  253:1     0    3G   0  lvm   [SWAP]
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ ls -lh /mnt/auto
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ cd /mnt/auto/dir0
    vm11$ cd /mnt/auto/dir1
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ lsblk
    
    コマンドの実行結果
    --------------------------------------------------
    NAME                    MAJ:MIN  RM  SIZE  RO  TYPE  MOUNTPOINT
    loop0                     7:0     0  100M   0  loop  /mnt/auto/dir0
    loop1                     7:1     0  100M   0  loop  /mnt/auto/dir1
    sr0                      11:0     1 1024M   0  rom   
    vda                     252:0     0   30G   0  disk  
     |-- vda1               252:1     0    1G   0  part  /boot
     |-- vda2               252:2     0   29G   0  part  
          |-- rl_vm11-root  253:0     0   26G   0  lvm   /
          |-- rl_vm11-swap  253:1     0    3G   0  lvm   [SWAP]
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo umount /mnt/auto/dir0 /mnt/auto/dir1
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo losetup -D
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ rm -f loop[0-1].img
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo vi /etc/auto.master
    
    コマンドの実行結果
    --------------------------------------------------
    /misc /etc/auto.misc
    /net  -hosts
    +dir:/etc/auto.master.d
    +auto.master
    # /mnt/auto /etc/auto.dir  // コメントアウト
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo rm /etc/auto.dir
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ sudo systemctl restart autofs
    
    コマンドの実行結果
    --------------------------------------------------
    (省略) -> 出力なし
    --------------------------------------------------
    
    vm11$ cd $HOME
    vm11$ exit
    
    コマンドの実行結果
    --------------------------------------------------
    Connection to vm11 closed.
    --------------------------------------------------
    
  以下の確認に続く
  
================================================================================
