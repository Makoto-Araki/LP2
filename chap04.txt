================================================================================
[01] ファイルシステムの情報 - 01 (cat /etc/fstab)
[02] ファイルシステムの情報 - 02 (blkid)
[03] ファイルシステムの情報 - 03 (cat /proc/filesystems)
[04] ファイルシステムの情報 - 04 (cat /etc/mtab)
[05] ファイルシステムの情報 - 05 (cat /proc/mounts)
[06] マウントとアンマウント - 01 (mount)
[07] マウントとアンマウント - 02 (umount)
[08] スワップ - 01 (mkswap)
[09] スワップ - 02 (swapon)
[10] スワップ - 03 (swapoff)
[11] ファイルシステム作成 - 01 (ext2)
[12] ファイルシステム作成 - 02 (ext3)
[13] ファイルシステム作成 - 03 (ext4)
[14] ファイルシステム作成 - 04 (ext3 -> ext4)
[15] ファイルシステム作成 - 05 (xfs)
[16] ファイルシステム作成 - 06 (btrfs)
[17] コマンド(mkfs)
[18] CD/DVD作成 - 01
[19] CD/DVD作成 - 02
[20] 暗号化デバイス
[21] スーパーブロック
[22] ファイルシステムチェック - 01 (fsck)
[23] ファイルシステムチェック - 02 (e2fsck)
[24] ファイルシステムチェック - 03 (xfs_repair)
[25] ファイルシステム管理(ext2,ext3,ext4) - 01 (tune2fs)
[26] ファイルシステム管理(ext2,ext3,ext4) - 02 (badblocks)
[27] ファイルシステム管理(ext2,ext3,ext4) - 03 (debugfs)
[28] S.M.A.R.T
[29] ファイルシステム管理(xfs) - 01 (xfs_admin)
[30] ファイルシステム管理(xfs) - 02 (xfs_info)
[31] ファイルシステム管理(xfs) - 03 (xfsdump)
[32] ファイルシステム管理(xfs) - 04 (xfsrestore)
[33] ファイルシステム管理(xfs) - 05 (xfs_repair)

[07] File System - 07 (自動マウント)
================================================================================
[01]
  ファイルシステムの情報 - 01 (cat /etc/fstab)
  
[内容]
  ## 作業内容
    システムのファイルシステムの情報をコマンド(cat /etc/fstab)から確認
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
  ## 設定ファイル(/etc/fstab)の書式
  --------------------------------------------------
  (デバイス名 or UUID or ラベル名)  (マウントポイント)  (ファイルシステム)  (マウントオプション)  (DUMP対象)  (FSCK順序)
  
  設定例1
    /dev/sda1  /boot  xfs  defaults  0  0
    /dev/sda2  /      xfs  defaults  0  0
  
  設定例2
    UUID=1d5e0998-fe61-4a82-83be-96a01cfbbd31  /boot  xfs  defaults  0  0
    UUID=1d5e0998-fe61-4a82-83be-96a01cfbbd99  /      xfs  defaults  0  0
  
  ファイルシステム
    EXT2      : EXTの拡張版
    EXT3      : ジャーナリング機能付加
    EXT4      : 機能拡張
    ReiserFS  : Linux用ジャーナリングファイルシステム
    JFS       : IBM製ジャーナリングファイルシステム
    XFS       : SGI製ジャーナリングファイルシステム -> CentOS7のデフォルト
    btrfs     : 先進的ファイルシステム
    ISO9660   : CD-ROM用
    UDF       : DVD用
    F2FS      : SSD用
    MSDOS     : MS-DOS用
    FAT/FAT32 : フラッシュメモリ用(USB)
    NTFS      : WindowsNT/2000以降
    HPFS      : OS/2用
    HFS       : MacOS用
    HFS+      : MacOS8.1以降
    NFS       : ファイル共有(Linux)
    CIFS      : ファイル共有(Windows)
    procfs    : プロセス情報を扱う仮想ファイルシステム(/proc)
    sysfs     : デバイス情報を扱う仮想ファイルシステム
    tmpfs     : 仮想メモリを扱う仮想ファイルシステム
    devpts    : 疑似端末制御のための仮想ファイルシステム
    usbfs     : USBデバイス監視用
    cramfs    : 組込システム用
  
  マウントオプション
    async     : 入出力同期  // 非同期
    sync      : 入出力同期  // 同期
    atime     : Iノードアクセス時刻更新  // 更新
    relatime  : Iノードアクセス時刻更新  // 一定時間後に更新
    noatime   : Iノードアクセス時刻更新  // 更新しない(ディスクアクセス高速化)
    auto      : コマンド「mount -a」の実行時の動作  // マウント
    noauto    : コマンド「mount -a」の実行時の動作  // マウントしない
    exec      : バイナリ実行を許可
    noexec    : バイナリ実行を禁止
    suid      : SUID, SGID
    nosuid    : SUID, SGID
    ro        : 読み取り専用
    rw        : 書き込み可能
    user      : 一般ユーザーマウント許可、アンマウントはマウント操作したユーザーのみ
    users     : 一般ユーザーマウント許可、アンマウントもマウント操作したユーザー以外で許可
    nouser    : 一般ユーザーマウント禁止
    owner     : その他  // デバイスファイル所有者のマウント許可
    defaults  : その他  // async, auto, dev, exec, nouser, rw, suid
    dev       : その他  // ファイルシステム上のデバイスファイル使用可
    group     : その他  // 条件「ユーザーのグループ = デバイスファイルの所有グループ」が満たされた場合にマウント許可
    uid=UID   : その他  // 全ファイル所有者を指定UIDにする
    gid=GID   : その他  // 全ファイル所有グループを指定GIDにする
  
  DUMP対象
    0         : バックアップ対象外
    1-9       : バックアップ対象
  
  FSCK順序
    0         : チェック対象外
    1-9       : チェック順序(数字順)
  --------------------------------------------------
  
[確認]
  vm12$ cd $HOME
  vm12$ lsblk (ブロックデバイス表示)
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom  
  vda                     252:0    0   20G  0 disk 
  ├─vda2                252:2    0   19G  0 part 
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm  [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm  /
  └─vda1                252:1    0    1G  0 part /boot
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ cat /etc/fstab | grep -vE '^#|^$' (設定ファイルを確認)
  
  コマンドの実行結果
  --------------------------------------------------
  UUID=1d5e0998-fe61-4a82-83be-96a01cfbbd31  /boot   xfs    defaults   0 0
  /dev/mapper/centos_vm11-root               /       xfs    defaults   0 0
  /dev/mapper/centos_vm11-swap               swap    swap   defaults   0 0
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[02]
  ファイルシステムの情報 - 02 (blkid)
  
[内容]
  ## 作業内容
    デバイスのUUIDを確認
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
[確認]
  vm12$ cd $HOME
  vm12$ lsblk (ブロックデバイス表示)
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom  
  vda                     252:0    0   20G  0 disk 
  ├─vda2                252:2    0   19G  0 part 
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm  [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm  /
  └─vda1                252:1    0    1G  0 part /boot
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo blkid (デバイスのUUIDを確認)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/vda1: UUID="1d5e0998-fe61-4a82-83be-96a01cfbbd31" TYPE="xfs" 
  /dev/vda2: UUID="FK1d1f-u6jH-Qd2L-OSNi-2gZL-os7w-fHojuw" TYPE="LVM2_member" 
  /dev/mapper/centos_vm11-root: UUID="90cf6fa5-58ac-4e14-89d1-909a3f537aa6" TYPE="xfs" 
  /dev/mapper/centos_vm11-swap: UUID="1475fefd-1dec-469a-b0c9-4f6be3f66ba9" TYPE="swap" 
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[03]
  ファイルシステムの情報 - 03 (cat /proc/filesystems)
  
[内容]
  ## 作業内容
    カーネルサポートのファイルシステムを表示
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
[確認]
  vm12$ cd $HOME
  vm12$ lsblk (ブロックデバイス表示)
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom  
  vda                     252:0    0   20G  0 disk 
  ├─vda2                252:2    0   19G  0 part 
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm  [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm  /
  └─vda1                252:1    0    1G  0 part /boot
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ cat /proc/filesystems (カーネルサポートのファイルシステムを表示)
  
  コマンドの実行結果
  --------------------------------------------------
  nodev sysfs
  nodev rootfs
  nodev ramfs
  nodev bdev
  nodev proc
  nodev cpuset
  nodev cgroup
  nodev cgroup2
  nodev tmpfs
  nodev devtmpfs
  nodev configfs
  nodev debugfs
  nodev tracefs
  nodev securityfs
  nodev sockfs
  nodev dax
  nodev bpf
  nodev pipefs
  nodev hugetlbfs
  nodev devpts
  nodev autofs
  nodev pstore
  nodev mqueue
  nodev selinuxfs
        xfs   // システムのデフォルト
        ext3  // ループバックデバイス作成時に使用したファイルシステム
        ext2  // ループバックデバイス作成時に使用したファイルシステム
        ext4  // ループバックデバイス作成時に使用したファイルシステム
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[04]
  ファイルシステムの情報 - 04 (cat /etc/mtab)
  
[内容]
  ## 作業内容
    マウント済みのファイルシステムを表示
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
[確認]
  vm12$ cd $HOME
  vm12$ lsblk (ブロックデバイス表示)
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom  
  vda                     252:0    0   20G  0 disk 
  ├─vda2                252:2    0   19G  0 part 
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm  [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm  /
  └─vda1                252:1    0    1G  0 part /boot
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ cat /etc/mtab | grep vda (マウント済みのファイルシステムを表示)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/vda1 /boot xfs rw,seclabel,relatime,attr2,inode64,noquota 0 0
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[05]
  ファイルシステムの情報 - 05 (cat /proc/mounts)
  
[内容]
  ## 作業内容
    マウント済みのファイルシステムを表示
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
[確認]
  vm12$ cd $HOME
  vm12$ lsblk (ブロックデバイス表示)
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom  
  vda                     252:0    0   20G  0 disk 
  ├─vda2                252:2    0   19G  0 part 
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm  [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm  /
  └─vda1                252:1    0    1G  0 part /boot
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ cat /proc/mounts | grep vda (マウント済みのファイルシステムを表示)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/vda1 /boot xfs rw,seclabel,relatime,attr2,inode64,noquota 0 0
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[06]
  マウントとアンマウント - 01 (mount)
  
[内容]
  ## 作業内容
    指定ファイルシステムでデバイスをマウントする
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
  ## コマンド(mount)
    mount -a      // 設定ファイル(/etc/fstab)の全ファイルシステムをマウント
    mount -o XX   // マウントオプション(XX)を指定
    mount -U XX   // UUID(XX)を指定
    mount -n      // 設定ファイル(/etc/mtab)に書き込まない
    mount -r      // mount -o ro
    mount -w      // mount -o rw
    mount -t XX   // ファイルシステム種類(XX)を指定
  
[確認]
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=1M count=10 (ディスクイメージ作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ losetup -f (使用可能なループバックデバイス名を表示)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/loop0
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img (ディスクイメージとループバックデバイスを紐づけ)
  
  コマンドの実行結果
  --------------------------------------------------
  [16227.921753] loop: module loaded
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkfs.ext4 /dev/loop0 (ループバックデバイスにファイルシステム作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> ブロック割当のメッセージが多数出力されるが成功
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mount -o defaults -t ext4 /dev/loop0 /mnt (マウントオプションはデフォルト、ファイルシステム指定でマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  [16381.302418] EXT4-fs (loop0): mounted filesystem with ordered data mode. Opts: (null)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk (ブロックデバイス確認)
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom  
  loop0                     7:0    0   10M  0 loop /mnt (マウントされたループバックデバイス)
  vda                     252:0    0   20G  0 disk 
  ├─vda2                252:2    0   19G  0 part 
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm  [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm  /
  └─vda1                252:1    0    1G  0 part /boot
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ mount | grep loop0 (マウント状況およびマウントオプションを確認)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/loop0 on /mnt type ext4 (rw,relatime,seclabel,data=ordered)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ cat /etc/mtab | grep loop0 (マウント状況およびマウントオプションを確認)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/loop0 /mnt ext4 rw,seclabel,relatime,data=ordered 0 0
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ cat /proc/mounts | grep loop0 (マウント状況およびマウントオプションを確認)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/loop0 /mnt ext4 rw,seclabel,relatime,data=ordered 0 0
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt (ループバックデバイスをアンマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D (ループバックデバイスとディスクイメージの紐づけ解除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f image0.img (ディスクイメージ削除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[07]
  マウントとアンマウント - 02 (umount)
  
[内容]
  ## 作業内容
    指定ファイルシステムでデバイスをマウントする
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
  ## コマンド(umount)
    umount -a     // 設定ファイル(/etc/mtab)の全ファイルシステムをアンマウント
    umount -t XX  // ファイルシステム種類(XX)を指定
  
[確認]
  上記の「06」を参照
  
================================================================================
[08]
  スワップ - 01 (mkswap)
  
[内容]
  ## 作業内容
    指定デバイスをスワップ領域化する
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
  ## コマンド(mkswap)
    mkswap XX     // スワップ領域(XX)を作成
    mkswap -c     // 不良ブロックをチェック
    mkswap -L XX  // ラベル(XX)を付与
  
[確認]
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=1M count=10 (ディスクイメージ作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ losetup -f (使用可能なループバックデバイス名を表示)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/loop0
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img (ディスクイメージとループバックデバイスを紐づけ)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkswap -c -L swap0 /dev/loop0 (不良ブロックのチェック、ラベル名指定でスワップ領域を作成)
  
  コマンドの実行結果
  --------------------------------------------------
  0 bad pages スワップ空間バージョン1を設定します、サイズ = 10236 KiB
  LABEL=swap0, UUID=e6d531e3-b968-4450-808f-1fc726055ddf
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo swapon /dev/loop0 (スワップ領域の有効化)
  
  コマンドの実行結果
  --------------------------------------------------
  [18730.962465] Adding 10236k swap on /dev/loop0.  Priority:-3 extents:1 across:10236k FS
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ swapon -s (有効なスワップ領域を表示)
  
  コマンドの実行結果
  --------------------------------------------------
  Filename     Type        Size      Used   Priority
  /dev/dm-1    partition   2097148   0      -2
  /dev/loop0   partition   10236     0      -3
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ cat /proc/swaps (仮想ファイルで確認)
  
  コマンドの実行結果
  --------------------------------------------------
  Filename     Type        Size      Used   Priority
  /dev/dm-1    partition   2097148   0      -2
  /dev/loop0   partition   10236     0      -3
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk (ブロックデバイスを表示)
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom  
  loop0                     7:0    0   10M  0 loop [SWAP] (作成したスワップ領域)
  vda                     252:0    0   20G  0 disk 
  ├─vda2                252:2    0   19G  0 part 
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm  [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm  /
  └─vda1                252:1    0    1G  0 part /boot
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo swapoff /dev/loop0 (スワップ領域の無効化)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D (ループバックデバイスとディスクイメージの紐づけ解除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f image0.img (ディスクイメージ削除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[09]
  スワップ - 02 (swapon)
  
[内容]
  ## 作業内容
    指定デバイスをスワップ領域化する
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
  ## コマンド(swapon)
    swapon XX     // スワップ領域(XX)を有効化
    swapon -a     // 設定ファイル(/etc/fstab)の全スワップ領域を有効化
    swapon -s     // 有効なスワップ領域を表示
  
[確認]
  上記の「08」を参照
  
================================================================================
[10]
  スワップ - 03 (swapoff)
  
[内容]
  ## 作業内容
    指定デバイスをスワップ領域化する
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
  ## コマンド(swapoff)
    swapoff XX    // スワップ領域(XX)を無効化
    swapoff -a    // 設定ファイル(/etc/fstab)の全スワップ領域を無効化
  
[確認]
  上記の「08」を参照
  
================================================================================
[11]
  ファイルシステム作成 - 01 (ext2)
  
[内容]
  ## 作業内容
    デバイスにファイルシステム(ext2)をコマンド(mke2fs)で作成してマウントする
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
  ## コマンド(mke2fs)
    mke2fs -b XX    // ブロックサイズ(XX)
    mke2fs -c       // 不良ブロックのチェック
    mke2fs -i XX    // iノードあたりのバイト数
    mke2fs -j       // ファイルシステム(ext3)を作成
    mke2fs -J       // ファイルシステム(ext4)を作成
    mke2fs -m XX %  // root用の管理領域の割合(XX)%
    mke2fs -n       // 動作のシミュレートのみ
    mke2fs -t XX    // ファイルシステムの種類(ext2,ext3,ext4)

[確認]
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=1M count=10 (ディスクイメージ作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ losetup -f (使用可能なループバックデバイス名を表示)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/loop0
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img (ディスクイメージとループバックデバイスを紐づけ)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mke2fs -b 4096 -c -m 1 /dev/loop0 -n (動作のシミュレートのみ)
  
  コマンドの実行結果
  --------------------------------------------------
  mke2fs 1.42.9 (28-Dec-2013)
  Filesystem label=
  OS type: Linux
  Block size=4096 (log=2) // 4096バイト
  Fragment size=4096 (log=2)
  Stride=0 blocks, Stripe width=0 blocks
  2560 inodes, 2560 blocks
  25 blocks (0.98%) reserved for the super user // 管理領域の割合は「1%」
  First data block=0
  1 block group
  32768 blocks per group, 32768 fragments per group
  2560 inodes per group
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mke2fs -b 4096 -c -m 1 /dev/loop0 (ファイルシステム作成)
  
  コマンドの実行結果
  --------------------------------------------------
  mke2fs 1.42.9 (28-Dec-2013)
  Filesystem label=
  OS type: Linux
  Block size=4096 (log=2)
  Fragment size=4096 (log=2) // 4096バイト
  Stride=0 blocks, Stripe width=0 blocks
  2560 inodes, 2560 blocks
  25 blocks (0.98%) reserved for the super user // 管理領域の割合は「1%」
  First data block=0
  1 block group
  32768 blocks per group, 32768 fragments per group
  2560 inodes per group
  
  Checking for bad blocks (read-only test): 0.00% done, 0:00 elapsed. (0/0/0 errdone                                                 
  Allocating group tables: done                            
  Writing inode tables: done                            
  Writing superblocks and filesystem accounting information: done
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mount -o defaults -t ext2 /dev/loop0 /mnt (マウントオプションはデフォルト、ファイルシステム指定でマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  [37126.506249] EXT4-fs (loop0): mounting ext2 file system using the ext4 subsystem
  [37126.605345] EXT4-fs (loop0): mounted filesystem without journal. Opts: (null)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk (ブロックデバイス確認)
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom  
  loop0                     7:0    0   10M  0 loop /mnt (マウントされたループバックデバイス)
  vda                     252:0    0   20G  0 disk 
  ├─vda2                252:2    0   19G  0 part 
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm  [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm  /
  └─vda1                252:1    0    1G  0 part /boot
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ mount | grep loop0 (マウント状況およびマウントオプションを確認)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/loop0 on /mnt type ext2 (rw,relatime,seclabel,block_validity,barrier,user_xattr,acl)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt (ループバックデバイスをアンマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D (ループバックデバイスとディスクイメージの紐づけ解除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f image0.img (ディスクイメージ削除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[12]
  ファイルシステム作成 - 02 (ext3)
  
[内容]
  ## 作業内容
    デバイスにファイルシステム(ext3)をコマンド(mke2fs)で作成してマウントする
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
  ## コマンド(mke2fs)
    mke2fs -b XX    // ブロックサイズ(XX)
    mke2fs -c       // 不良ブロックのチェック
    mke2fs -i XX    // iノードあたりのバイト数
    mke2fs -j       // ファイルシステム(ext3)を作成
    mke2fs -J       // ファイルシステム(ext4)を作成
    mke2fs -m XX %  // root用の管理領域の割合(XX)%
    mke2fs -n       // 動作のシミュレートのみ
    mke2fs -t XX    // ファイルシステムの種類(ext2,ext3,ext4)

[確認]
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=1M count=10 (ディスクイメージ作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ losetup -f (使用可能なループバックデバイス名を表示)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/loop0
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img (ディスクイメージとループバックデバイスを紐づけ)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mke2fs -j -b 4096 -c -m 1 /dev/loop0 -n (動作のシミュレートのみ)
  
  コマンドの実行結果
  --------------------------------------------------
  mke2fs 1.42.9 (28-Dec-2013)
  Filesystem label=
  OS type: Linux
  Block size=4096 (log=2) // 4096バイト
  Fragment size=4096 (log=2)
  Stride=0 blocks, Stripe width=0 blocks
  2560 inodes, 2560 blocks
  25 blocks (0.98%) reserved for the super user // 管理領域の割合は「1%」
  First data block=0
  1 block group
  32768 blocks per group, 32768 fragments per group
  2560 inodes per group
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mke2fs -j -b 4096 -c -m 1 /dev/loop0 (ファイルシステム作成)
  
  コマンドの実行結果
  --------------------------------------------------
  mke2fs 1.42.9 (28-Dec-2013)
  Filesystem label=
  OS type: Linux
  Block size=4096 (log=2)
  Fragment size=4096 (log=2) // 4096バイト
  Stride=0 blocks, Stripe width=0 blocks
  2560 inodes, 2560 blocks
  25 blocks (0.98%) reserved for the super user // 管理領域の割合は「1%」
  First data block=0
  1 block group
  32768 blocks per group, 32768 fragments per group
  2560 inodes per group
  
  Checking for bad blocks (read-only test):   0.00% done, 0:00 elapsed. (0/0/0 errdone                                                 
  Allocating group tables: done                            
  Writing inode tables: done                            
  Creating journal (1024 blocks): done // ジャーナル領域が作成
  Writing superblocks and filesystem accounting information: done
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mount -o defaults -t ext3 /dev/loop0 /mnt (マウントオプションはデフォルト、ファイルシステム指定でマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  [38238.995688] EXT4-fs (loop0): mounting ext3 file system using the ext4 subsystem
  [38239.149263] EXT4-fs (loop0): mounted filesystem with ordered data mode. Opts: (null)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk (ブロックデバイス確認)
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom  
  loop0                     7:0    0   10M  0 loop /mnt (マウントされたループバックデバイス)
  vda                     252:0    0   20G  0 disk 
  ├─vda2                252:2    0   19G  0 part 
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm  [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm  /
  └─vda1                252:1    0    1G  0 part /boot
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ mount | grep loop0 (マウント状況およびマウントオプションを確認)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/loop0 on /mnt type ext3 (rw,relatime,seclabel,data=ordered)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt (ループバックデバイスをアンマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D (ループバックデバイスとディスクイメージの紐づけ解除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f image0.img (ディスクイメージ削除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[13]
  ファイルシステム作成 - 03 (ext4)
  
[内容]
  ## 作業内容
    デバイスにファイルシステム(ext4)をコマンド(mke2fs)で作成してマウントする
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
  ## コマンド(mke2fs)
    mke2fs -b XX    // ブロックサイズ(XX)
    mke2fs -c       // 不良ブロックのチェック
    mke2fs -i XX    // iノードあたりのバイト数
    mke2fs -j       // ファイルシステム(ext3)を作成
    mke2fs -J       // ファイルシステム(ext4)を作成
    mke2fs -m XX %  // root用の管理領域の割合(XX)%
    mke2fs -n       // 動作のシミュレートのみ
    mke2fs -t XX    // ファイルシステムの種類(ext2,ext3,ext4)

[確認]
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=1M count=10 (ディスクイメージ作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ losetup -f (使用可能なループバックデバイス名を表示)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/loop0
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img (ディスクイメージとループバックデバイスを紐づけ)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mke2fs -t ext4 -b 4096 -c -m 1 /dev/loop0 -n (動作のシミュレートのみ)
  
  コマンドの実行結果
  --------------------------------------------------
  mke2fs 1.42.9 (28-Dec-2013)
  Filesystem label=
  OS type: Linux
  Block size=4096 (log=2) // 4096バイト
  Fragment size=4096 (log=2)
  Stride=0 blocks, Stripe width=0 blocks
  2560 inodes, 2560 blocks
  25 blocks (0.98%) reserved for the super user // 管理領域の割合は「1%」
  First data block=0
  Maximum filesystem blocks=4194304
  1 block group
  32768 blocks per group, 32768 fragments per group
  2560 inodes per group
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mke2fs -t ext4 -b 4096 -c -m 1 /dev/loop0 (ファイルシステム作成)
  
  コマンドの実行結果
  --------------------------------------------------
  mke2fs 1.42.9 (28-Dec-2013)
  Filesystem label=
  OS type: Linux
  Block size=4096 (log=2) // 4096バイト
  Fragment size=4096 (log=2)
  Stride=0 blocks, Stripe width=0 blocks
  2560 inodes, 2560 blocks
  25 blocks (0.98%) reserved for the super user // 管理領域の割合は「1%」
  First data block=0
  Maximum filesystem blocks=4194304
  1 block group
  32768 blocks per group, 32768 fragments per group
  2560 inodes per group
  
  Checking for bad blocks (read-only test): 0.00% done, 0:00 elapsed. (0/0/0 errdone                                                 
  Allocating group tables: done                            
  Writing inode tables: done                            
  Creating journal (1024 blocks): done // ジャーナル領域が作成
  Writing superblocks and filesystem accounting information: done
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mount -o defaults -t ext4 /dev/loop0 /mnt (マウントオプションはデフォルト、ファイルシステム指定でマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  [39865.172519] EXT4-fs (loop0): mounted filesystem with ordered data mode. Opts: (null)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk (ブロックデバイス確認)
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom  
  loop0                     7:0    0   10M  0 loop /mnt (マウントされたループバックデバイス)
  vda                     252:0    0   20G  0 disk 
  ├─vda2                252:2    0   19G  0 part 
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm  [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm  /
  └─vda1                252:1    0    1G  0 part /boot
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ mount | grep loop0 (マウント状況およびマウントオプションを確認)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/loop0 on /mnt type ext4 (rw,relatime,seclabel,data=ordered)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt (ループバックデバイスをアンマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D (ループバックデバイスとディスクイメージの紐づけ解除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f image0.img (ディスクイメージ削除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[14]
  ファイルシステム作成 - 04 (ext3 -> ext4)
  
[内容]
  ## 作業内容
    デバイスに作成されたファイルシステム(ext3)をコマンド(tune2fs)でアップグレード(ext4)後にマウントする
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
  ## コマンド(tune2fs)
    tune2fs -c XX		// 最大マウント回数(XX)に達したらファイルシステムチェック -> 0の場合はチェックしない
    tune2fs -C XX		// 現在のマウント回数を設定
    tune2fs -i XX		// ファイルシステムチェック間隔(XX日) -> 0の場合はチェックしない
    tune2fs -j			// ext2 -> ext3
    tune2fs -O      // ext3 -> ext4
    tune2fs -m XX		// root用予約領域(XX%)
    tune2fs -l			// スーパーブロック内容を表示
    tune2fs -L XX		// ファイルシステムのボリュームラベル(XX)
    tune2fs -U XX		// UUID(XX)
  
[確認]
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=1M count=10 (ディスクイメージ作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ losetup -f (使用可能なループバックデバイス名を表示)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/loop0
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img (ディスクイメージとループバックデバイスを紐づけ)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mke2fs -j -b 4096 -c -m 1 /dev/loop0 (ファイルシステム作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> ファイルシステム(ext3)が作成された
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo tune2fs -O extent,dir_index /dev/loop0 (ファイルシステムをアップグレード)
  
  コマンドの実行結果
  --------------------------------------------------
  tune2fs 1.42.9 (28-Dec-2013)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo e2fsck /dev/loop0 (ファイルシステムのチェック)
  
  コマンドの実行結果
  --------------------------------------------------
  e2fsck 1.42.9 (28-Dec-2013)
  /dev/loop0: clean, 11/2560 files, 1115/2560 blocks
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mount -o defaults -t ext4 /dev/loop0 /mnt (マウントオプションはデフォルト、ファイルシステム指定でマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  [42438.927982] EXT4-fs (loop0): mounted filesystem with ordered data mode. Opts: (null)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk (ブロックデバイス確認)
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom  
  loop0                     7:0    0   10M  0 loop /mnt (マウントされたループバックデバイス)
  vda                     252:0    0   20G  0 disk 
  ├─vda2                252:2    0   19G  0 part 
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm  [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm  /
  └─vda1                252:1    0    1G  0 part /boot
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ mount | grep loop0 (マウント状況およびマウントオプションを確認)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/loop0 on /mnt type ext4 (rw,relatime,seclabel,data=ordered)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt (ループバックデバイスをアンマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D (ループバックデバイスとディスクイメージの紐づけ解除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f image0.img (ディスクイメージ削除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[15]
  ファイルシステム作成 - 05 (xfs)
  
[内容]
  ## 作業内容
    デバイスにファイルシステム(xfs)を作成後にマウントする
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
[確認]
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=5M count=10 (ディスクイメージ作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ losetup -f (使用可能なループバックデバイス名を表示)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/loop0
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img (ディスクイメージとループバックデバイスを紐づけ)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkfs.xfs /dev/loop0 (ファイルシステム作成)
  
  コマンドの実行結果
  --------------------------------------------------
  Discarding blocks...Done.
  meta-data=/dev/loop0             isize=512    agcount=2, agsize=6400 blks
           =                       sectsz=512   attr=2, projid32bit=1
           =                       crc=1        finobt=0, sparse=0
  data     =                       bsize=4096   blocks=12800, imaxpct=25
           =                       sunit=0      swidth=0 blks
  naming   =version 2              bsize=4096   ascii-ci=0 ftype=1
  log      =internal log           bsize=4096   blocks=855, version=2
           =                       sectsz=512   sunit=0 blks, lazy-count=1
  realtime =none                   extsz=4096   blocks=0, rtextents=0
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mount -o defaults -t xfs /dev/loop0 /mnt (マウントオプションはデフォルト、ファイルシステム指定でマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  [45187.631185] XFS (loop0): Mounting V5 Filesystem
  [45187.639209] XFS (loop0): Ending clean mount
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk (ブロックデバイス確認)
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom  
  loop0                     7:0    0   10M  0 loop /mnt (マウントされたループバックデバイス)
  vda                     252:0    0   20G  0 disk 
  ├─vda2                252:2    0   19G  0 part 
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm  [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm  /
  └─vda1                252:1    0    1G  0 part /boot
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ mount | grep loop0 (マウント状況およびマウントオプションを確認)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/loop0 on /mnt type xfs (rw,relatime,seclabel,attr2,inode64,noquota)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt (ループバックデバイスをアンマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  [45249.926775] XFS (loop0): Unmounting Filesystem
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D (ループバックデバイスとディスクイメージの紐づけ解除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f image0.img (ディスクイメージ削除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[16]
  ファイルシステム作成 - 06 (btrfs)
  
[内容]
  ## 作業内容
    デバイスにファイルシステム(btrfs)を作成後にマウントする
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
[確認]
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=10M count=10 (ディスクイメージ作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ losetup -f (使用可能なループバックデバイス名を表示)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/loop0
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img (ディスクイメージとループバックデバイスを紐づけ)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkfs.btrfs /dev/loop0 (ファイルシステム作成)
  
  コマンドの実行結果
  --------------------------------------------------
  btrfs-progs v4.9.1
  See http://btrfs.wiki.kernel.org for more information.
  
  Performing full device TRIM /dev/loop0 (100.00MiB) ...
  Label:              (null)
  UUID:               bf621404-8dd1-4b9c-99ba-e74565ccc233
  Node size:          16384
  Sector size:        4096
  Filesystem size:    100.00MiB
  Block group profiles:
    Data:             single            8.00MiB
    Metadata:         DUP              32.00MiB
    System:           DUP               8.00MiB
  SSD detected:       no
  Incompat features:  extref, skinny-metadata
  Number of devices:  1
  Devices:
    ID        SIZE  PATH
    1    100.00MiB  /dev/loop0 // ループバックデバイス
  
  [50949.337981] raid6: sse2x1   gen()  3410 MB/s
  [50949.356966] raid6: sse2x1   xor()  3376 MB/s
  [50949.375930] raid6: sse2x2   gen()  5789 MB/s
  [50949.393917] raid6: sse2x2   xor()  5460 MB/s
  [50949.411923] raid6: sse2x4   gen()  6171 MB/s
  [50949.429939] raid6: sse2x4   xor()  3714 MB/s
  [50949.438023] raid6: using algorithm sse2x4 gen() 6171 MB/s
  [50949.441282] raid6: .... xor() 3714 MB/s, rmw enabled
  [50949.443605] raid6: using ssse3x2 recovery algorithm
  [50949.606774] xor: measuring software checksum speed
  [50949.620941]    prefetch64-sse: 10788.000 MB/sec
  [50949.637917]    generic_sse:  9552.000 MB/sec
  [50949.640479] xor: using function: prefetch64-sse (10788.000 MB/sec)
  [50951.296426] Btrfs loaded, crc32c=crc32c-intel
  [50951.299034] BTRFS: device fsid bf621404-8dd1-4b9c-99ba-e74565ccc233 devid 1 transid 5 /dev/loop0
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mount -o defaults -t btrfs /dev/loop0 /mnt (マウントオプションはデフォルト、ファイルシステム指定でマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  [51118.886280] BTRFS info (device loop0): disk space caching is enabled
  [51118.888872] BTRFS info (device loop0): has skinny extents
  [51118.890939] BTRFS info (device loop0): flagging fs with big metadata feature
  [51118.898333] BTRFS info (device loop0): creating UUID tree
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk (ブロックデバイス確認)
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom  
  loop0                     7:0    0   10M  0 loop /mnt (マウントされたループバックデバイス)
  vda                     252:0    0   20G  0 disk 
  ├─vda2                252:2    0   19G  0 part 
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm  [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm  /
  └─vda1                252:1    0    1G  0 part /boot
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ mount | grep loop0 (マウント状況およびマウントオプションを確認)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/loop0 on /mnt type btrfs (rw,relatime,seclabel,space_cache,subvolid=5,subvol=/)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt (ループバックデバイスをアンマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D (ループバックデバイスとディスクイメージの紐づけ解除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f image0.img (ディスクイメージ削除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[17]
  コマンド(mkfs)
  
[内容]
  ## 作業内容
    デバイスに指定ファイルシステムをコマンド(mkfs)で作成後にマウントする
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
  ## コマンド(mkfs)
    mkfs -t XX  // ファイルシステム(XX)を作成
    mkfs -c     // 不良ブロックをチェック
  
[確認]
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=10M count=10
  vm12$ dd if=/dev/zero of=image1.img bs=10M count=10
  vm12$ dd if=/dev/zero of=image2.img bs=10M count=10
  vm12$ dd if=/dev/zero of=image3.img bs=10M count=10
  vm12$ dd if=/dev/zero of=image4.img bs=10M count=10
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img
  vm12$ sudo losetup /dev/loop1 image1.img
  vm12$ sudo losetup /dev/loop2 image2.img
  vm12$ sudo losetup /dev/loop3 image3.img
  vm12$ sudo losetup /dev/loop4 image4.img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkfs -t ext2 /dev/loop0
  vm12$ sudo mkfs -t ext3 /dev/loop1
  vm12$ sudo mkfs -t ext4 /dev/loop2
  vm12$ sudo mkfs -t xfs /dev/loop3
  vm12$ sudo mkfs -t btrfs /dev/loop4
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd /mnt
  vm12$ sudo mkdir mp0 mp1 mp2 mp3 mp4
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mount -o defaults -t ext2 /dev/loop0 /mnt/mp0
  vm12$ sudo mount -o defaults -t ext3 /dev/loop1 /mnt/mp1
  vm12$ sudo mount -o defaults -t ext4 /dev/loop2 /mnt/mp2
  vm12$ sudo mount -o defaults -t xfs /dev/loop3 /mnt/mp3
  vm12$ sudo mount -o defaults -t btrfs /dev/loop4 /mnt/mp4
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk (ブロックデバイス確認)
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
  loop0                     7:0    0  100M  0 loop /mnt/mp0 (マウントされたループバックデバイス)
  loop1                     7:1    0  100M  0 loop /mnt/mp1 (マウントされたループバックデバイス)
  loop2                     7:2    0  100M  0 loop /mnt/mp2 (マウントされたループバックデバイス)
  loop3                     7:3    0  100M  0 loop /mnt/mp3 (マウントされたループバックデバイス)
  loop4                     7:4    0  100M  0 loop /mnt/mp4 (マウントされたループバックデバイス)
  sr0                      11:0    1 1024M  0 rom  
  vda                     252:0    0   20G  0 disk 
  ├─vda2                252:2    0   19G  0 part 
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm  [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm  /
  └─vda1                252:1    0    1G  0 part /boot
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ df -mT (ブロックデバイス確認)
  
  コマンドの実行結果
  --------------------------------------------------
  ファイルシス                 タイプ   1M-ブロック  使用 使用可 使用% マウント位置
  devtmpfs                     devtmpfs         466     0    466    0% /dev
  tmpfs                        tmpfs            489     0    489    0% /dev/shm
  tmpfs                        tmpfs            489     7    482    2% /run
  tmpfs                        tmpfs            489     0    489    0% /sys/fs/cgroup
  tmpfs                        tmpfs             98     0     98    0% /run/user/1000
  /dev/mapper/centos_vm11-root xfs            17394  5422  11973   32% /
  /dev/vda1                    xfs             1014   188    827   19% /boot
  /dev/loop0                   ext2              97     2     91    2% /mnt/mp0 (マウントされたループバックデバイス)
  /dev/loop1                   ext3              93     2     87    2% /mnt/mp1 (マウントされたループバックデバイス)
  /dev/loop2                   ext4              93     2     85    2% /mnt/mp2 (マウントされたループバックデバイス)
  /dev/loop3                   xfs               97     6     92    6% /mnt/mp3 (マウントされたループバックデバイス)
  /dev/loop4                   btrfs            100    17     19   47% /mnt/mp4 (マウントされたループバックデバイス)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ mount | grep -E 'loop[0-4]' (マウント状況およびマウントオプションを確認)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/loop0 on /mnt/mp0 type ext2 (rw,relatime,seclabel,block_validity,barrier,user_xattr,acl)
  /dev/loop1 on /mnt/mp1 type ext3 (rw,relatime,seclabel,data=ordered)
  /dev/loop2 on /mnt/mp2 type ext4 (rw,relatime,seclabel,data=ordered)
  /dev/loop3 on /mnt/mp3 type xfs (rw,relatime,seclabel,attr2,inode64,noquota)
  /dev/loop4 on /mnt/mp4 type btrfs (rw,relatime,seclabel,space_cache,subvolid=5,subvol=/)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt/mp0
  vm12$ sudo umount /mnt/mp1
  vm12$ sudo umount /mnt/mp2
  vm12$ sudo umount /mnt/mp3
  vm12$ sudo umount /mnt/mp4
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D (ループバックデバイスとディスクイメージの紐づけ解除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f image[0-4].img (ディスクイメージ削除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[18]
  CD/DVD作成 - 01
  
[内容]
  ## 作業内容
    CD-ROMイメージ(ISO9660)の作成を行い、システムにマウント後にチェックする
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
  ## コマンド(mkisofs)
    mkisofs -b     // ブート可能CD
    mkisofs -o XX  // イメージファイル(XX)を作成
    mkisofs -J     // Microsoft用フォーマット
    mkisofs -r(R)  // ロングネーム用フォーマット
    mkisofs -udf   // DVD
  
[確認]
  vm12$ cd $HOME
  vm12$ sudo yum -y install mkisofs (パッケージ追加)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> エラー出力が無ければOK
  --------------------------------------------------
  
  vm12$ cd $HOME/HISTORY -> 先にディレクトリ作成
  vm12$ vi AAA.txt
  
  コマンドの実行結果
  --------------------------------------------------
  1582年 本能寺の変
  1600年 関ヶ原の戦い
  1615年 大坂夏の陣
  --------------------------------------------------
  
  vm12$ cd $HOME/HISTORY
  vm12$ vi BBB.txt
  
  コマンドの実行結果
  --------------------------------------------------
  1894年 日清戦争
  1904年 日露戦争
  1914年 第一次世界大戦
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ mkisofs -o HISTORY-CDROM.iso -r(-R) HISTORY (CD-ROM用イメージ、ロングネーム対応でISOイメージ作成)
  
  コマンドの実行結果
  --------------------------------------------------
  I: -input-charset not specified, using utf-8 (detected in locale settings) // 文字コードはシステムのものを使用
  Total translation table size: 0
  Total rockridge attributes bytes: 327
  Total directory bytes: 0
  Path table size(bytes): 10
  Max brk space used 0
  177 extents written (0 MB)
  --------------------------------------------------
  
  vm12$ cd /mnt
  vm12$ sudo mkdir cdrom (マウントポイント作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mount -r -t iso9660 HISTORY-CDROM.iso /mnt/cdrom (CD-ROM用イメージを読取専用でマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk (ブロックデバイス確認)
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom  
  loop0                     7:0    0  354K  1 loop /mnt/cdrom (CD-ROMイメージ)
  vda                     252:0    0   20G  0 disk 
  ├─vda2                252:2    0   19G  0 part 
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm  [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm  /
  └─vda1                252:1    0    1G  0 part /boot
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ df -mT (ブロックデバイス確認)
  
  コマンドの実行結果
  --------------------------------------------------
  ファイルシス                 タイプ   1M-ブロック  使用 使用可 使用% マウント位置
  devtmpfs                     devtmpfs         466     0    466    0% /dev
  tmpfs                        tmpfs            489     0    489    0% /dev/shm
  tmpfs                        tmpfs            489     7    482    2% /run
  tmpfs                        tmpfs            489     0    489    0% /sys/fs/cgroup
  tmpfs                        tmpfs             98     0     98    0% /run/user/1000
  /dev/mapper/centos_vm11-root xfs            17394  5402  11993   32% /
  /dev/vda1                    xfs             1014   188    827   19% /boot
  /dev/loop0                   iso9660            1     1      0  100% /mnt/cdrom (CD-ROMイメージ)
  --------------------------------------------------

  vm12$ cd /mnt/cdrom
  vm12$ ls -lh (CD-ROMイメージを確認)
  
  コマンドの実行結果
  --------------------------------------------------
  -r--r--r--. 1 root root 75 12月 28 11:10 AAA.txt
  -r--r--r--. 1 root root 72 12月 28 11:11 BBB.txt
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt/cdrom
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f *.iso (ISOイメージファイル削除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[19]
  CD/DVD作成 - 02
  
[内容]
  ## 作業内容
    DVD-ROMイメージ(ISO9660)の作成を行い、システムにマウント後にチェックする
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
  ## コマンド(mkisofs)
    mkisofs -b     // ブート可能CD
    mkisofs -o XX  // イメージファイル(XX)を作成
    mkisofs -J     // Microsoft用フォーマット
    mkisofs -r(R)  // ロングネーム用フォーマット
    mkisofs -udf   // DVD
  
[確認]
  vm12$ cd $HOME
  vm12$ mkisofs -udf -o HISTORY-DVD.iso -r(-R) HISTORY (DVD-ROM用イメージ、ロングネーム対応でISOイメージ作成)
  
  コマンドの実行結果
  --------------------------------------------------
  I: -input-charset not specified, using utf-8 (detected in locale settings) // 文字コードはシステムのものを使用
  Total translation table size: 0
  Total rockridge attributes bytes: 327
  Total directory bytes: 0
  Path table size(bytes): 10
  Max brk space used 0
  422 extents written (0 MB)
  --------------------------------------------------
  
  vm12$ cd /mnt
  vm12$ sudo mkdir dvd (マウントポイント作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mount -r -t iso9660 HISTORY-DVD.iso /mnt/dvd (DVD-ROM用イメージを読取専用でマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk (ブロックデバイス確認)
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom  
  loop0                     7:0    0  844K  1 loop /mnt/dvd (DVD-ROMイメージ)
  vda                     252:0    0   20G  0 disk 
  ├─vda2                252:2    0   19G  0 part 
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm  [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm  /
  └─vda1                252:1    0    1G  0 part /boot
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ df -mT (ブロックデバイス確認)
  
  コマンドの実行結果
  --------------------------------------------------
  ファイルシス                 タイプ   1M-ブロック  使用 使用可 使用% マウント位置
  devtmpfs                     devtmpfs         466     0    466    0% /dev
  tmpfs                        tmpfs            489     0    489    0% /dev/shm
  tmpfs                        tmpfs            489     7    482    2% /run
  tmpfs                        tmpfs            489     0    489    0% /sys/fs/cgroup
  tmpfs                        tmpfs             98     0     98    0% /run/user/1000
  /dev/mapper/centos_vm11-root xfs            17394  5402  11993   32% /
  /dev/vda1                    xfs             1014   188    827   19% /boot
  /dev/loop0                   iso9660            1     1      0  100% /mnt/dvd (DVD-ROMイメージ)
  --------------------------------------------------

  vm12$ cd /mnt/dvd
  vm12$ ls -lh (DVD-ROMイメージを確認)
  
  コマンドの実行結果
  --------------------------------------------------
  -r--r--r--. 1 root root 75 12月 28 11:10 AAA.txt
  -r--r--r--. 1 root root 72 12月 28 11:11 BBB.txt
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt/dvd
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f *.iso (ISOイメージファイル削除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[20]
  暗号化デバイス
  
[内容]
  ## 作業内容
    暗号化デバイスにファイルシステムを作成する
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
[確認]
  vm12$ cd $HOME
  vm12$ sudo yum -y install cryptsetup (パッケージ追加)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> エラー出力が無ければOK
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=10M count=10 (ディスクイメージ作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img (ディスクイメージとループバックデバイスを紐づけ)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo cryptsetup create sec0(暗号化デバイス名) /dev/loop0 (ループバックデバイスを暗号化デバイスに変換)
  
  コマンドの実行結果
  --------------------------------------------------
  Enter passphrase for /home/makoto/image0.img: (mikotoと入力)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk (ブロックデバイス確認)
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE  MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom   
  loop0                     7:0    0  100M  0 loop  
  └─sec0                253:2    0  100M  0 crypt (暗号化デバイス)
  vda                     252:0    0   20G  0 disk  
  ├─vda2                252:2    0   19G  0 part  
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm   [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm   /
  └─vda1                252:1    0    1G  0 part  /boot
  --------------------------------------------------
  
  vm12$ cd /dev/mapper
  vm12$ ls -lh (暗号化デバイスへのアクセスを調査)
  
  コマンドの実行結果
  --------------------------------------------------
  lrwxrwxrwx. 1 root root       7 12月 28 06:57 centos_vm11-root -> ../dm-0
  lrwxrwxrwx. 1 root root       7 12月 28 06:57 centos_vm11-swap -> ../dm-1
  crw-------. 1 root root 10, 236 12月 28 06:57 control
  lrwxrwxrwx. 1 root root       7 12月 28 15:32 sec0 -> ../dm-2 (アクセスは「/dev/mapper/sec0」でOK)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkfs -t xfs /dev/mapper/sec0 (暗号化デバイスにファイルシステム作成)
  
  コマンドの実行結果
  --------------------------------------------------
  meta-data=/dev/mapper/sec0       isize=512    agcount=4, agsize=6400 blks
           =                       sectsz=512   attr=2, projid32bit=1
           =                       crc=1        finobt=0, sparse=0
  data     =                       bsize=4096   blocks=25600, imaxpct=25
           =                       sunit=0      swidth=0 blks
  naming   =version 2              bsize=4096   ascii-ci=0 ftype=1
  log      =internal log           bsize=4096   blocks=855, version=2
           =                       sectsz=512   sunit=0 blks, lazy-count=1
  realtime =none                   extsz=4096   blocks=0, rtextents=0
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mount -o defaults -t xfs /dev/mapper/sec0 /mnt (暗号化デバイスをマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  [31653.681464] XFS (dm-2): Mounting V5 Filesystem
  [31653.738944] XFS (dm-2): Ending clean mount
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk (ブロックデバイス確認)
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE  MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom   
  loop0                     7:0    0  100M  0 loop  
  └─sec0                253:2    0  100M  0 crypt /mnt (暗号化デバイス)
  vda                     252:0    0   20G  0 disk  
  ├─vda2                252:2    0   19G  0 part  
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm   [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm   /
  └─vda1                252:1    0    1G  0 part  /boot
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ df -mT (ブロックデバイス確認)
  
  コマンドの実行結果
  --------------------------------------------------
  ファイルシス                 タイプ   1M-ブロック  使用 使用可 使用% マウント位置
  devtmpfs                     devtmpfs         466     0    466    0% /dev
  tmpfs                        tmpfs            489     0    489    0% /dev/shm
  tmpfs                        tmpfs            489     7    482    2% /run
  tmpfs                        tmpfs            489     0    489    0% /sys/fs/cgroup
  tmpfs                        tmpfs             98     0     98    0% /run/user/1000
  /dev/mapper/centos_vm11-root xfs            17394  5500  11895   32% /
  /dev/vda1                    xfs             1014   188    827   19% /boot
  /dev/mapper/sec0             xfs               97     6     92    6% /mnt (暗号化デバイス)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ mount | grep sec0 (マウント状況およびマウントオプションを確認)
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/mapper/sec0 on /mnt type xfs (rw,relatime,seclabel,attr2,inode64,noquota)
  --------------------------------------------------
  
  vm12$ cd /mnt
  vm12$ sudo cp -p HISTORY/*.txt /mnt/ (前記録で作成したファイルを暗号化デバイスにコピー)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd /mnt
  vm12$ ls -lh (暗号化デバイスにコピーが成功しているか確認)
  
  コマンドの実行結果
  --------------------------------------------------
  -rw-rw-r--. 1 makoto makoto 75 12月 28 11:10 AAA.txt
  -rw-rw-r--. 1 makoto makoto 72 12月 28 11:11 BBB.txt
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt (暗号化デバイスをアンマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  [32478.990896] XFS (dm-2): Unmounting Filesystem
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo cryptsetup remove sec0 (暗号化デバイスからループバックデバイスに戻す)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D (ループバックデバイスとディスクイメージの紐づけ解除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f image0.img (ディスクイメージ削除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[21]
  スーパーブロック
  
[内容]
  ## 作業内容
    ファイルシステム(ext2,ext3,ext4)のスーパーブロックを調査する
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
[確認]
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=10M count=10 (ディスクイメージ作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img (ディスクイメージとループバックデバイスを紐づけ)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkfs -t ext4 /dev/loop0 (ファイルシステム作成)
  
  コマンドの実行結果
  --------------------------------------------------
  mke2fs 1.42.9 (28-Dec-2013)
  Discarding device blocks: done                            
  Filesystem label=
  OS type: Linux
  Block size=1024 (log=0)
  Fragment size=1024 (log=0)
  Stride=0 blocks, Stripe width=0 blocks
  25688 inodes, 102400 blocks
  5120 blocks (5.00%) reserved for the super user
  First data block=1  // スーパーブロック
  Maximum filesystem blocks=33685504
  13 block groups
  8192 blocks per group, 8192 fragments per group
  1976 inodes per group
  Superblock backups stored on blocks: 
	  8193, 24577, 40961, 57345, 73729  // スーパーブロックのバックアップ
  
  Allocating group tables: done                            
  Writing inode tables: done                            
  Creating journal (4096 blocks): done
  Writing superblocks and filesystem accounting information: done 
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo dumpe2fs /dev/loop0 | grep -i superblock (スーパーブロック確認)
  
  コマンドの実行結果
  --------------------------------------------------
  Primary superblock at 1, Group descriptors at 2-2
  Backup superblock at 8193, Group descriptors at 8194-8194
  Backup superblock at 24577, Group descriptors at 24578-24578
  Backup superblock at 40961, Group descriptors at 40962-40962
  Backup superblock at 57345, Group descriptors at 57346-57346
  Backup superblock at 73729, Group descriptors at 73730-73730
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D (ループバックデバイスとディスクイメージの紐づけ解除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f image0.img (ディスクイメージ削除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[22]
  ファイルシステムチェック - 01 (fsck)
  
[内容]
  ## 作業内容
    ファイルシステムチェックを行う (アンマウントまたは読取専用マウントの状態でないとファイルシステムが壊れる)
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
  ## コマンド(fsck)
    fsck -r     // 対話的に修復を実行
    fsck -t XX  // ファイルシステム種類(XX)のみ実行
    fsck -A     // ファイル「/etc/fstab」の全ファイルシステムに実行
    fsck -N     // 動作のシミュレートのみ
  
[確認]
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=10M count=10 (ディスクイメージ作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img (ディスクイメージとループバックデバイスを紐づけ)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkfs -t ext4 /dev/loop0 (ファイルシステム作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo fsck -t ext4 /dev/loop0 (ファイルシステムチェック)
  
  コマンドの実行結果
  --------------------------------------------------
  fsck from util-linux 2.23.2
  e2fsck 1.42.9 (28-Dec-2013)
  /dev/loop0: clean, 11/25688 files, 8896/102400 blocks  // 異常なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D (ループバックデバイスとディスクイメージの紐づけ解除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f image0.img (ディスクイメージ削除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[23]
  ファイルシステムチェック - 02 (e2fsck)
  
[内容]
  ## 作業内容
    ファイルシステムチェックを行う (アンマウントまたは読取専用マウントの状態でないとファイルシステムが壊れる)
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
  ## コマンド(e2fsck)
    e2fsck -b XX  // 指定したスーパーブロックのバックアップ(XX)を使用してファイルシステム復元
		e2fsck -c     // 不良ブロックをチェック
		e2fsck -f     // ファイルシステムが「clean」でもチェック
		e2fsck -p     // 不良ブロックを自動的に修復
		e2fsck -y     // 問合せに「yes」と回答
		e2fsck -n     // 問合せに「no」と回答
  
[確認]
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=10M count=10 (ディスクイメージ作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img (ディスクイメージとループバックデバイスを紐づけ)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkfs -t ext4 /dev/loop0 (ファイルシステム作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo dumpe2fs /dev/loop0 | grep -i superblock (スーパーブロック確認)
  
  コマンドの実行結果
  --------------------------------------------------
  Primary superblock at 1, Group descriptors at 2-2
  Backup superblock at 8193, Group descriptors at 8194-8194
  Backup superblock at 24577, Group descriptors at 24578-24578
  Backup superblock at 40961, Group descriptors at 40962-40962
  Backup superblock at 57345, Group descriptors at 57346-57346
  Backup superblock at 73729, Group descriptors at 73730-73730
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo e2fsck /dev/loop0 (ファイルシステムチェック)
  
  コマンドの実行結果
  --------------------------------------------------
  e2fsck 1.42.9 (28-Dec-2013)
  /dev/loop0: clean, 11/25688 files, 8896/102400 blocks
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo e2fsck -c /dev/loop0 (不良ブロックのチェック)
  
  コマンドの実行結果
  --------------------------------------------------
  e2fsck 1.42.9 (28-Dec-2013)
  Checking for bad blocks (read-only test): 0.00% done, 0:00 elapsed. (0/0/0 errdone                                                 
  /dev/loop0: Updating bad block inode.
  Pass 1: Checking inodes, blocks, and sizes
  Pass 2: Checking directory structure
  Pass 3: Checking directory connectivity
  Pass 4: Checking reference counts
  Pass 5: Checking group summary information
  
  /dev/loop0: ***** FILE SYSTEM WAS MODIFIED *****
  /dev/loop0: 11/25688 files (9.1% non-contiguous), 8896/102400 blocks
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo e2fsck -b 8193 /dev/loop0 (スーパーブロックのバックアップ「8193」を使用してファイルシステム修復)
  
  コマンドの実行結果
  --------------------------------------------------
  e2fsck 1.42.9 (28-Dec-2013)
  /dev/loop0 was not cleanly unmounted, check forced.
  Pass 1: Checking inodes, blocks, and sizes
  Pass 2: Checking directory structure
  Pass 3: Checking directory connectivity
  Pass 4: Checking reference counts
  Pass 5: Checking group summary information
  
  /dev/loop0: ***** FILE SYSTEM WAS MODIFIED *****
  /dev/loop0: 11/25688 files (9.1% non-contiguous), 8896/102400 blocks
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D (ループバックデバイスとディスクイメージの紐づけ解除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f image0.img (ディスクイメージ削除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[24]
  ファイルシステムチェック - 03 (xfs_repair)
  
[内容]
  ## 作業内容
    ファイルシステムチェックを行う (アンマウントまたは読取専用マウントの状態でないとファイルシステムが壊れる)
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
  ## コマンド(xfs_repair)
    xfs_repair XX     // デバイス(XX)のファイルシステムチェックと修復
    xfs_repair -n XX  // デバイス(XX)のファイルシステムチェックのみ
  
[確認]
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=10M count=10 (ディスクイメージ作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img (ディスクイメージとループバックデバイスを紐づけ)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkfs -t xfs /dev/loop0 (ファイルシステム作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo xfs_repair -n /dev/loop0 (ファイルシステムチェック)
  
  コマンドの実行結果
  --------------------------------------------------
  Phase 1 - find and verify superblock...
  Phase 2 - using internal log
          - zero log...
          - scan filesystem freespace and inode maps...
          - found root inode chunk
  Phase 3 - for each AG...
          - scan (but don't clear) agi unlinked lists...
          - process known inodes and perform inode discovery...
          - agno = 0
          - agno = 1
          - agno = 2
          - agno = 3
          - process newly discovered inodes...
  Phase 4 - check for duplicate blocks...
          - setting up duplicate extent list...
          - check for inodes claiming duplicate blocks...
          - agno = 0
          - agno = 1
          - agno = 2
          - agno = 3
  No modify flag set, skipping phase 5
  Phase 6 - check inode connectivity...
          - traversing filesystem ...
          - traversal finished ...
          - moving disconnected inodes to lost+found ...
  Phase 7 - verify link counts...
  No modify flag set, skipping filesystem flush and exiting.
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D (ループバックデバイスとディスクイメージの紐づけ解除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f image0.img (ディスクイメージ削除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[25]
  ファイルシステム管理(ext2,ext3,ext4) - 01 (tune2fs)
  
[内容]
  ## 作業内容
    ファイルシステム管理を行う
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
  ## コマンド(tune2fs)
    tune2fs -c XX  // 最大マウント回数(XX)でファイルシステムチェック -> 0はチェックしない
    tune2fs -C XX  // 現在のマウント回数を設定
    tune2fs -i XX  // ファイルシステムチェック間隔(XX日) -> 0はチェックしない
    tune2fs -j     // ext2からext3に変換
    tune2fs -m XX  // root用の管理領域の割合
    tune2fs -l     // スーパーブロック内容を表示
    tune2fs -L XX  // ファイルシステムのボリュームラベル(XX)
    tune2fs -U XX  // UUID(XX)
  
[確認]
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=10M count=10 (ディスクイメージ作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img (ディスクイメージとループバックデバイスを紐づけ)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkfs -t ext2 /dev/loop0 (ファイルシステム作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo tune2fs -j /dev/loop0 (ext2 -> ext3)
  
  コマンドの実行結果
  --------------------------------------------------
  tune2fs 1.42.9 (28-Dec-2013)
  Creating journal inode: done
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo tune2fs -m 1 /dev/loop0 (管理領域の割合を1%に変更)
  
  コマンドの実行結果
  --------------------------------------------------
  tune2fs 1.42.9 (28-Dec-2013)
  Setting reserved blocks percentage to 1% (1024 blocks)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo tune2fs -l /dev/loop0 (スーパーブロックの内容を表示)
  
  コマンドの実行結果
  --------------------------------------------------
  tune2fs 1.42.9 (28-Dec-2013)
  Filesystem volume name:   <none>
  Last mounted on:          <not available>
  Filesystem UUID:          d91fda70-f127-4299-9973-758a316172c8
  Filesystem magic number:  0xEF53
  Filesystem revision #:    1 (dynamic)
  Filesystem features:      has_journal ext_attr resize_inode dir_index filetype sparse_super
  Filesystem flags:         signed_directory_hash 
  Default mount options:    user_xattr acl
  Filesystem state:         clean
  Errors behavior:          Continue
  Filesystem OS type:       Linux
  Inode count:              25688
  Block count:              102400
  Reserved block count:     1024
  Free blocks:              93487
  Free inodes:              25677
  First block:              1
  Block size:               1024
  Fragment size:            1024
  Reserved GDT blocks:      256
  Blocks per group:         8192
  Fragments per group:      8192
  Inodes per group:         1976
  Inode blocks per group:   247
  Filesystem created:       Tue Dec 28 22:37:45 2021
  Last mount time:          n/a
  Last write time:          Tue Dec 28 22:38:50 2021
  Mount count:              0
  Maximum mount count:      -1
  Last checked:             Tue Dec 28 22:37:45 2021
  Check interval:           0 (<none>)
  Reserved blocks uid:      0 (user root)
  Reserved blocks gid:      0 (group root)
  First inode:              11
  Inode size:	              128
  Journal inode:            8
  Default directory hash:   half_md4
  Directory Hash Seed:      0a04640e-5731-47c5-b94a-ee342dc76647
  Journal backup:           inode blocks
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo tune2fs -L AAA /dev/loop0 (ボリュームラベルを「AAA」に変更)
  
  コマンドの実行結果
  --------------------------------------------------
  tune2fs 1.42.9 (28-Dec-2013) -> 上記スーパーブロックの「Filesystem volume name」に更新された
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D (ループバックデバイスとディスクイメージの紐づけ解除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f image0.img (ディスクイメージ削除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[26]
  ファイルシステム管理(ext2,ext3,ext4) - 02 (badblocks)
  
[内容]
  ## 作業内容
    ファイルシステム管理を行う
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
  ## コマンド(badblocks)
    badblocks -b XX  // ブロックサイズ(XX)を指定
    badblocks -o XX  // 結果をファイル(XX)に出力
    badblocks -w     // 書込モードでテスト -> ファイルシステム破壊？
  
[確認]
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=10M count=10 (ディスクイメージ作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img (ディスクイメージとループバックデバイスを紐づけ)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkfs -t ext4 /dev/loop0 (ファイルシステム作成)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo badblocks -b 1024 /dev/loop0 (不良ブロックの検索)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D (ループバックデバイスとディスクイメージの紐づけ解除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f image0.img (ディスクイメージ削除)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[27]
  ファイルシステム管理(ext2,ext3,ext4) - 03 (debugfs)
  
[内容]
  ## 作業内容
    ファイルシステム管理を行う
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
  ## コマンド(debugfs)
    debugfs -w     // 書込可能モードでファイルシステムを開く(デフォルトは読取専用)
    debugfs -s XX  // スーパーブロック(XX)を指定
  
[確認]
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=10M count=10
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img
  
  コマンドの実行結果
  --------------------------------------------------
  [  374.253452] loop: module loaded
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkfs -t ext4 /dev/loop0
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mount -o defaults -t ext4 /dev/loop0 /mnt
  
  コマンドの実行結果
  --------------------------------------------------
  [  446.666095] EXT4-fs (loop0): mounted filesystem with ordered data mode. Opts: (null)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk (ブロックデバイス確認)
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom  
  loop0                     7:0    0  100M  0 loop /mnt (マウントしたデバイス)
  vda                     252:0    0   20G  0 disk 
  ├─vda2                252:2    0   19G  0 part 
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm  [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm  /
  └─vda1                252:1    0    1G  0 part /boot
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo cp -pr HISTORY /mnt

  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo debugfs -w /dev/loop0 (書込可能モードで実行)
  
  コマンドの実行結果
  --------------------------------------------------
  debugfs 1.42.9 (28-Dec-2013)
  
  ## サブコマンド「ls」
  debugfs:  ls
  2  (12) .    2  (12) ..    11  (20) lost+found    12  (980) HISTORY
  
  ## サブコマンド「cd」
  debugfs:  cd HISTORY
  (出力なし)
  
  ## サブコマンド「ls」
  debugfs:  ls
  12  (12) .    2  (12) ..    13  (16) AAA.txt    14  (984) BBB.txt
  
  ## サブコマンド「cat」
  debugfs:  cat AAA.txt
  
  1582年 本能寺の変
  1600年 関ヶ原の戦い
  1615年 大坂夏の陣
  
  ## サブコマンド「mkdir」
  debugfs:  mkdir CCC
  (出力なし)

  ## サブコマンド「quit」
  debugfs:  quit
  (OSプロンプトに戻る)
  --------------------------------------------------
  
  vm12$ cd /mnt/HISTORY
  vm12$ ls -lh

  コマンドの実行結果
  --------------------------------------------------
  -rw-rw-r--. 1 makoto makoto   75 12月 28 11:10 AAA.txt
  -rw-rw-r--. 1 makoto makoto   72 12月 28 11:11 BBB.txt
  drwxr-xr-x. 2 root   root   1.0K 12月 29 08:02 CCC (コマンド内部で作成されたディレクトリ)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  ディスクイメージ削除
  vm12$ cd $HOME
  vm12$ rm -f loop0.img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[28]
  S.M.A.R.T
  
[内容]
  ## 作業内容
    HDDの自己診断
  
  ## 使用マシン
    HOST : localhost
    IPV4 : 192.168.1.3
    MEMO : ホスト
  
  ## コマンド(smartctl)
    smartctl -a  // 自己診断情報(SMART)を表示
    smartctl -t  // セルフテスト実施
    smartctl -l  // ログタイプ指定
    smartctl -H  // 状態を表示
  
[確認]
  $ cd $HOME
  $ sudo yum -y install smartmontools (パッケージ追加)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> エラー出力が無ければOK
  --------------------------------------------------
  
  $ cd $HOME
  $ lsblk (ブロックデバイス表示)
  
  コマンドの実行結果
  --------------------------------------------------
  NAME              MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
  sda                 8:0    0 465.8G  0 disk 
  ├─sda1            8:1    0     1G  0 part /boot
  └─sda2            8:2    0 464.8G  0 part 
    ├─centos-root 253:0    0    50G  0 lvm  /
    ├─centos-swap 253:1    0   3.6G  0 lvm  [SWAP]
    └─centos-home 253:2    0 411.1G  0 lvm  /home
  sr0                11:0    1  1024M  0 rom  
  loop0               7:0    0  99.4M  1 loop /var/lib/snapd/snap/core/11993
  loop1               7:1    0 104.6M  1 loop /var/lib/snapd/snap/brackets/138
  --------------------------------------------------
  
  $ cd $HOME
  $ sudo smartctl -a /dev/sda (自己診断情報を表示)
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 表示項目が多過ぎて理解不能
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[29]
  ファイルシステム管理(xfs) - 01 (xfs_admin)
  
[内容]
  ## 作業内容
    ファイルシステム管理を行う
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
  ## コマンド(xfs_admin)
    xfs_admin -u     // UUID表示
    xfs_admin -U XX  // UUID(XX)を設定
    xfs_admin -l     // ラベル表示
    xfs_admin -L XX  // ラベル(XX)を設定
  
[確認]
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=10M count=10
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkfs -t xfs /dev/loop0
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mount -o defaults -t xfs /dev/loop0 /mnt
  
  コマンドの実行結果
  --------------------------------------------------
  [12827.378007] XFS (loop0): Mounting V5 Filesystem
  [12827.392257] XFS (loop0): Ending clean mount
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk (ブロックデバイス確認)
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom  
  loop0                     7:0    0  100M  0 loop /mnt (マウントしたデバイス)
  vda                     252:0    0   20G  0 disk 
  ├─vda2                252:2    0   19G  0 part 
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm  [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm  /
  └─vda1                252:1    0    1G  0 part /boot
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo xfs_info /dev/loop0 (ファイルシステムの情報)
  
  コマンドの実行結果
  --------------------------------------------------
  meta-data=/dev/loop0             isize=512    agcount=4, agsize=6400 blks
           =                       sectsz=512   attr=2, projid32bit=1
           =                       crc=1        finobt=0 spinodes=0
  data     =                       bsize=4096   blocks=25600, imaxpct=25
           =                       sunit=0      swidth=0 blks
  naming   =version 2              bsize=4096   ascii-ci=0 ftype=1
  log      =internal               bsize=4096   blocks=855, version=2
           =                       sectsz=512   sunit=0 blks, lazy-count=1
  realtime =none                   extsz=4096   blocks=0, rtextents=0
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo xfs_admin -u /dev/loop0 (UUID表示)
  
  コマンドの実行結果
  --------------------------------------------------
  UUID  = c8a1b744-d0c4-47e0-85bf-410e46e371d4
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo xfs_admin -l /dev/loop0 (ラベル表示)
  
  コマンドの実行結果
  --------------------------------------------------
  label = ""
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  ディスクイメージ削除
  vm12$ cd $HOME
  vm12$ rm -f image0.img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[30]
  ファイルシステム管理(xfs) - 02 (xfs_info)
  
[内容]
  ## 作業内容
    ファイルシステム管理を行う
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
[確認]
  上記の「29」を参照
  
================================================================================
[31]
  ファイルシステム管理(xfs) - 03 (xfsdump)
  
[内容]
  ## 作業内容
    ファイルシステム管理を行う
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
  ## コマンド(xfsdump)
    xfsdump -f XX  // 出力ファイル名(XX)を指定
    xfsdump -l XX  // ダンプレベル(XX 0-9)を指定
    xfsdump -J     // ダンプ情報データベース更新しない
  
[確認]
  vm12$ cd $HOME
  vm12$ sudo yum -y install xfsdump
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> エラー出力が無ければOK
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=10M count=10
  vm12$ dd if=/dev/zero of=image1.img bs=10M count=10
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img
  vm12$ sudo losetup /dev/loop1 image1.img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkfs -t xfs /dev/loop0
  vm12$ sudo mkfs -t xfs /dev/loop1
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mount -o defaults -t xfs /dev/loop0 /mnt/mp0
  vm12$ sudo mount -o defaults -t xfs /dev/loop1 /mnt/mp1
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk (ブロックデバイス確認)
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
  sr0                      11:0    1 1024M  0 rom  
  loop0                     7:0    0  100M  0 loop /mnt/mp0 (マウントしたデバイス)
  loop1                     7:1    0  100M  0 loop /mnt/mp1 (マウントしたデバイス)
  vda                     252:0    0   20G  0 disk 
  ├─vda2                252:2    0   19G  0 part 
  │ ├─centos_vm11-swap 253:1    0    2G  0 lvm  [SWAP]
  │ └─centos_vm11-root 253:0    0   17G  0 lvm  /
  └─vda1                252:1    0    1G  0 part /boot
  --------------------------------------------------
  
  vm12$ cd /mnt/mp0
  vm12$ sudo vi ALPHABET.txt
  
  コマンドの実行結果
  --------------------------------------------------
  AAA AAA AAA
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo xfsdump -f loop0-level0.dmp -l 0 /mnt/mp0 (完全バックアップ)
  
  コマンドの実行結果
  --------------------------------------------------
  xfsdump: using file dump (drive_simple) strategy
  xfsdump: version 3.1.7 (dump format 3.0) - type ^C for status and control
  
  // セッションラベル入力
  please enter label for this dump session (timeout in 300 sec)
  -> AAA
  session label entered: "AAA"
  
  xfsdump: level 0 dump of vm12:/mnt/mp0
  xfsdump: dump date: Wed Dec 29 13:23:40 2021
  xfsdump: session id: 971e925f-14f8-423b-ab09-001efa4275bc
  xfsdump: session label: "AAA"
  xfsdump: ino map phase 1: constructing initial dump list
  xfsdump: ino map phase 2: skipping (no pruning necessary)
  xfsdump: ino map phase 3: skipping (only one dump stream)
  xfsdump: ino map construction complete
  xfsdump: estimated dump size: 25216 bytes
  xfsdump: /var/lib/xfsdump/inventory created
  
  // メディアラベル入力
  please enter label for media in drive 0 (timeout in 300 sec)
  -> AAA
  media label entered: "AAA"
  
  xfsdump: creating dump session media file 0 (media 0, file 0)
  xfsdump: dumping ino map
  xfsdump: dumping directories
  xfsdump: dumping non-directory files
  xfsdump: ending media file
  xfsdump: media file size 22216 bytes
  xfsdump: dump size (non-dir files) : 544 bytes
  xfsdump: dump complete: 50 seconds elapsed
  xfsdump: Dump Summary:
  xfsdump:   stream 0 /home/makoto/loop0-level0.dmp OK (success)
  xfsdump: Dump Status: SUCCESS
  --------------------------------------------------
  
  vm12$ cd /mnt/mp0
  vm12$ sudo vi ALPHABET.txt
  
  コマンドの実行結果
  --------------------------------------------------
  AAA AAA AAA
  BBB BBB BBB (追加)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo xfsdump -f loop0-level1.dmp -l 1 /mnt/mp0 (増分バックアップ)
  
  コマンドの実行結果
  --------------------------------------------------
  xfsdump: using file dump (drive_simple) strategy
  xfsdump: version 3.1.7 (dump format 3.0) - type ^C for status and control
  
  // セッションラベル入力
  please enter label for this dump session (timeout in 300 sec)
  -> BBB
  session label entered: "BBB"
  
  xfsdump: level 1 incremental dump of vm12:/mnt/mp0 based on level 0 dump begun Wed Dec 29 13:23:40 2021
  xfsdump: dump date: Wed Dec 29 13:30:44 2021
  xfsdump: session id: bec38c3b-ac09-471f-8444-e81fbca11cd3
  xfsdump: session label: "BBB"
  xfsdump: ino map phase 1: constructing initial dump list
  xfsdump: ino map phase 2: skipping (no pruning necessary)
  xfsdump: ino map phase 3: skipping (only one dump stream)
  xfsdump: ino map construction complete
  xfsdump: estimated dump size: 25216 bytes
  
  // メディアラベル入力
  please enter label for media in drive 0 (timeout in 300 sec)
  -> BBB
  media label entered: "BBB"
  
  xfsdump: creating dump session media file 0 (media 0, file 0)
  xfsdump: dumping ino map
  xfsdump: dumping directories
  xfsdump: dumping non-directory files
  xfsdump: ending media file
  xfsdump: media file size 22216 bytes
  xfsdump: dump size (non-dir files) : 544 bytes
  xfsdump: dump complete: 8 seconds elapsed
  xfsdump: Dump Summary:
  xfsdump:   stream 0 /home/makoto/loop0-level1.dmp OK (success)
  xfsdump: Dump Status: SUCCESS
  --------------------------------------------------
  
  vm12$ cd /mnt/mp0
  vm12$ sudo vi ALPHABET.txt
  
  コマンドの実行結果
  --------------------------------------------------
  AAA AAA AAA
  BBB BBB BBB
  CCC CCC CCC (追加)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo xfsdump -f loop0-level2.dmp -l 2 /mnt/mp0 (増分バックアップ)
  
  コマンドの実行結果
  --------------------------------------------------
  xfsdump: using file dump (drive_simple) strategy
  xfsdump: version 3.1.7 (dump format 3.0) - type ^C for status and control
  
  // セッションラベル入力
  please enter label for this dump session (timeout in 300 sec)
  -> CCC
  session label entered: "CCC"
  
  xfsdump: level 2 incremental dump of vm12:/mnt/mp0 based on level 1 dump begun Wed Dec 29 13:30:44 2021
  xfsdump: dump date: Wed Dec 29 13:35:16 2021
  xfsdump: session id: f56b1cc9-fc60-4b28-a44f-937a986d4a8f
  xfsdump: session label: "CCC"
  xfsdump: ino map phase 1: constructing initial dump list
  xfsdump: ino map phase 2: skipping (no pruning necessary)
  xfsdump: ino map phase 3: skipping (only one dump stream)
  xfsdump: ino map construction complete
  xfsdump: estimated dump size: 25216 bytes
  
  // メディアラベル入力
  please enter label for media in drive 0 (timeout in 300 sec)
  -> CCC
  media label entered: "CCC"
  
  xfsdump: creating dump session media file 0 (media 0, file 0)
  xfsdump: dumping ino map
  xfsdump: dumping directories
  xfsdump: dumping non-directory files
  xfsdump: ending media file
  xfsdump: media file size 22216 bytes
  xfsdump: dump size (non-dir files) : 544 bytes
  xfsdump: dump complete: 5 seconds elapsed
  xfsdump: Dump Summary:
  xfsdump:   stream 0 /home/makoto/loop0-level2.dmp OK (success)
  xfsdump: Dump Status: SUCCESS
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ ls -lh | grep loop0-level (バックアップファイル確認)
  
  コマンドの実行結果
  --------------------------------------------------
  -rw-r--r--. 1 root   root    22K 12月 29 13:24 loop0-level0.dmp
  -rw-r--r--. 1 root   root    22K 12月 29 13:30 loop0-level1.dmp
  -rw-r--r--. 1 root   root    22K 12月 29 13:35 loop0-level2.dmp
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo xfsrestore -r -f loop0-level0.dmp /mnt/mp1 (完全バックアップを別ファイルシステムにレストア)
  
  コマンドの実行結果
  --------------------------------------------------
  xfsrestore: using file dump (drive_simple) strategy
  xfsrestore: version 3.1.7 (dump format 3.0) - type ^C for status and control
  xfsrestore: searching media for dump
  xfsrestore: examining media file 0
  xfsrestore: dump description: 
  xfsrestore: hostname: vm12
  xfsrestore: mount point: /mnt/mp0
  xfsrestore: volume: /dev/loop0
  xfsrestore: session time: Wed Dec 29 13:23:40 2021
  xfsrestore: level: 0
  xfsrestore: session label: "AAA" // 入力したセッションラベル
  xfsrestore: media label: "AAA" // 入力したメディアラベル
  xfsrestore: file system id: 99362101-932b-407b-9b00-39a7b9a63bb0
  xfsrestore: session id: 971e925f-14f8-423b-ab09-001efa4275bc
  xfsrestore: media id: 6f4f746b-51e8-4cac-acd2-4f366877220d
  xfsrestore: using online session inventory
  xfsrestore: searching media for directory dump
  xfsrestore: reading directories
  xfsrestore: 1 directories and 1 entries processed
  xfsrestore: directory post-processing
  xfsrestore: restoring non-directory files
  xfsrestore: restore complete: 0 seconds elapsed
  xfsrestore: Restore Summary:
  xfsrestore:   stream 0 /home/makoto/loop0-level0.dmp OK (success)
  xfsrestore: Restore Status: SUCCESS
  --------------------------------------------------
  
  vm12$ cd /mnt/mp1
  vm12$ cat ALPHABET.txt
  
  コマンドの実行結果
  --------------------------------------------------
  AAA AAA AAA
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo xfsrestore -r -f loop0-level1.dmp /mnt/mp1 (増分バックアップを別ファイルシステムにレストア)
  
  コマンドの実行結果
  --------------------------------------------------
  xfsrestore: using file dump (drive_simple) strategy
  xfsrestore: version 3.1.7 (dump format 3.0) - type ^C for status and control
  xfsrestore: searching media for dump
  xfsrestore: examining media file 0
  xfsrestore: dump description: 
  xfsrestore: hostname: vm12
  xfsrestore: mount point: /mnt/mp0
  xfsrestore: volume: /dev/loop0
  xfsrestore: session time: Wed Dec 29 13:30:44 2021
  xfsrestore: level: 1
  xfsrestore: session label: "BBB" // 入力したセッションラベル
  xfsrestore: media label: "BBB" // 入力したメディアラベル
  xfsrestore: file system id: 99362101-932b-407b-9b00-39a7b9a63bb0
  xfsrestore: session id: bec38c3b-ac09-471f-8444-e81fbca11cd3
  xfsrestore: media id: 4c4c071b-23a8-43db-9c3b-bfbb25cb8060
  xfsrestore: using online session inventory
  xfsrestore: searching media for directory dump
  xfsrestore: reading directories
  xfsrestore: 1 directories and 1 entries processed
  xfsrestore: directory post-processing
  xfsrestore: restoring non-directory files
  xfsrestore: restore complete: 0 seconds elapsed
  xfsrestore: Restore Summary:
  xfsrestore:   stream 0 /home/makoto/loop0-level1.dmp OK (success)
  xfsrestore: Restore Status: SUCCESS
  --------------------------------------------------
  
  vm12$ cd /mnt/mp1
  vm12$ cat ALPHABET.txt
  
  コマンドの実行結果
  --------------------------------------------------
  AAA AAA AAA
  BBB BBB BBB
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo xfsrestore -r -f loop0-level2.dmp /mnt/mp1 (増分バックアップを別ファイルシステムにレストア)
  
  コマンドの実行結果
  --------------------------------------------------
  xfsrestore: using file dump (drive_simple) strategy
  xfsrestore: version 3.1.7 (dump format 3.0) - type ^C for status and control
  xfsrestore: searching media for dump
  xfsrestore: examining media file 0
  xfsrestore: dump description: 
  xfsrestore: hostname: vm12
  xfsrestore: mount point: /mnt/mp0
  xfsrestore: volume: /dev/loop0
  xfsrestore: session time: Wed Dec 29 13:35:16 2021
  xfsrestore: level: 2
  xfsrestore: session label: "CCC" // 入力したセッションラベル
  xfsrestore: media label: "CCC" // 入力したメディアラベル
  xfsrestore: file system id: 99362101-932b-407b-9b00-39a7b9a63bb0
  xfsrestore: session id: f56b1cc9-fc60-4b28-a44f-937a986d4a8f
  xfsrestore: media id: 31b21bdd-0ed4-4bb2-8438-db565838c6ce
  xfsrestore: using online session inventory
  xfsrestore: searching media for directory dump
  xfsrestore: reading directories
  xfsrestore: 1 directories and 1 entries processed
  xfsrestore: directory post-processing
  xfsrestore: restoring non-directory files
  xfsrestore: restore complete: 1 seconds elapsed
  xfsrestore: Restore Summary:
  xfsrestore:   stream 0 /home/makoto/loop0-level2.dmp OK (success)
  xfsrestore: Restore Status: SUCCESS
  --------------------------------------------------
  
  vm12$ cd /mnt/mp1
  vm12$ cat ALPHABET.txt
  
  コマンドの実行結果
  --------------------------------------------------
  AAA AAA AAA
  BBB BBB BBB
  CCC CCC CCC
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ diff /mnt/mp0/ALPHABET.txt /mnt/mp1/ALPHABET.txt
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt/mp0
  vm12$ sudo umount /mnt/mp1
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  ディスクイメージ削除
  vm12$ cd $HOME
  vm12$ rm -f image[0-1].img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[32]
  ファイルシステム管理(xfs) - 04 (xfsrestore)
  
[内容]
  ## 作業内容
    ファイルシステム管理を行う
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
  ## コマンド(xfsrestore)
    xfsrestore -f XX  // バックアップファイル(XX)を指定
    xfsrestore -S XX  // セッションID(XX)を指定
    xfsrestore -L XX  // セッションラベル(XX)を指定
    xfsrestore -r     // 増分バックアップからリストア
    xfsrestore -i     // 対話的にリストア
    xfsrestore -I     // 全ダンプのセッションIDとセッションラベルを表示
  
[確認]
  上記の「31」を参照
  
================================================================================
[33]
  ファイルシステム管理(xfs) - 05 (xfs_repair)
  
[内容]
  ## 作業内容
    ファイルシステム管理を行う
  
  ## 使用マシン
    HOST : vm12
    IPV4 : 192.168.122.12
    MEMO : 仮想マシン(サーバー用途)
  
[確認]
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=image0.img bs=10M count=10
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 image0.img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkfs -t xfs /dev/loop0
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo xfs_repair /dev/loop0
  
  コマンドの実行結果
  --------------------------------------------------
  Phase 1 - find and verify superblock...
  Phase 2 - using internal log
          - zero log...
          - scan filesystem freespace and inode maps...
          - found root inode chunk
  Phase 3 - for each AG...
          - scan and clear agi unlinked lists...
          - process known inodes and perform inode discovery...
          - agno = 0
          - agno = 1
          - agno = 2
          - agno = 3
          - process newly discovered inodes...
  Phase 4 - check for duplicate blocks...
          - setting up duplicate extent list...
          - check for inodes claiming duplicate blocks...
          - agno = 0
          - agno = 1
          - agno = 2
          - agno = 3
  Phase 5 - rebuild AG headers and trees...
          - reset superblock...
  Phase 6 - check inode connectivity...
          - resetting contents of realtime bitmap and summary inodes
          - traversing filesystem ...
          - traversal finished ...
          - moving disconnected inodes to lost+found ...
  Phase 7 - verify and correct link counts...
  done
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  ディスクイメージ削除
  vm12$ cd $HOME
  vm12$ rm -f image0.img
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 出力なし
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[07]
  File System - 07 (自動マウント)
  
[内容]
  ## 作業内容
    ディレクトリ「/mnt/auto/dir0」に移動時にデバイス「/dev/loop0」を自動マウントする
  
[確認]
  $ cd $HOME
  $ sudo virsh start vm12 --console
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 仮想マシンの起動
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=loop0.img bs=1M count=10 (ディスクイメージ作成)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ losetup -f (使用可能なループバックデバイス名を表示)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 loop0.img (ディスクイメージとループバックデバイスを紐づけ)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkfs.ext4 /dev/loop0 (ループバックデバイスにファイルシステム作成)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo vi /etc/auto.master (設定ファイルの修正)
  
  コマンドの実行結果
  --------------------------------------------------
  /misc	/etc/auto.misc
  /net  -hosts
  +dir:/etc/auto.master.d
  +auto.master
  /mnt/auto	/etc/auto.dir  // 追加 -> ディレクトリ「/mnt/auto」移動時に設定ファイル「/etc/auto.dir」の内容でマウント
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo vi /etc/auto.dir (設定ファイルの追加)
  
  コマンドの実行結果
  --------------------------------------------------
  dir0  -fstype=ext4,rw  :/dev/loop0
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo systemctl restart autofs (サービス再起動)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk (オートマウント前を確認)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ cd /mnt/auto/dir0 (ディレクトリ移動)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk (オートマウント後を確認)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt/auto/dir0 (アンマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D (ループバックデバイスとディスクイメージの紐づけ解除)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f loop0.img (ディスクイメージ削除)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo vi /etc/auto.master (設定ファイル編集)
  
  コマンドの実行結果
  --------------------------------------------------
  /misc	/etc/auto.misc
  /net  -hosts
  +dir:/etc/auto.master.d
  +auto.master
  # /mnt/auto	/etc/auto.dir  // コメントアウト
  --------------------------------------------------
  
  vm12$ cd /etc
  vm12$ sudo rm auto.dir (追加した設定ファイル削除)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd /mnt
  vm12$ sudo rm -rf auto (マウントポイント削除)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo systemctl restart autofs (サービス再起動)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
