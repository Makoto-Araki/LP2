================================================================================
[01] File System - 01 (設定ファイルの書式)
[02] File System - 02 (設定ファイルの確認)
[03] File System - 03 (UUID)
[04] File System - 04 (カーネルサポートのファイルシステム)
[05] File System - 05 (マウント済みのファイルシステム)
[06] File System - 06 (デバイスをマウント)
[07] File System - 07 (自動マウント)
[08] File System - 08 (スワップ領域)
[09] File System - 09 (ファイルシステム作成)
[10] File System - 10 (ISOイメージ作成)
[11] File System - 11 (暗号化ファイルシステム)
================================================================================
[01]
  File System - 01 (設定ファイルの書式)
  
[内容]
  ## 設定ファイル(/etc/fstab)の書式
  --------------------------------------------------
  デバイス名(UUID名)/ラベル名  マウントポイント  ファイルシステム  マウントオプション  DUMP対象  FSCK順序
  
  -- 設定例 --
  /dev/sda1  /boot  ext2  defaults  0  2
  
  ファイルシステム
    EXT2      : EXTの拡張版
    EXT3      : ジャーナリング機能付加
    EXT4      : 機能拡張
    ReiserFS  : Linux用ジャーナリングファイルシステム
    JFS       : IBM製ジャーナリングファイルシステム
    XFS       : SGI製ジャーナリングファイルシステム -> CentOS7のデフォルト
    btrfs     : 先進的ファイルシステム
    ISO9660   : CD-ROM用
    UDF       : DVD用
    F2FS      : SSD用
    MSDOS     : MS-DOS用
    FAT/FAT32 : フラッシュメモリ用(USB)
    NTFS      : WindowsNT/2000以降
    HPFS      : OS/2用
    HFS       : MacOS用
    HFS+      : MacOS8.1以降
    NFS       : ファイル共有(Linux)
    CIFS      : ファイル共有(Windows)
    procfs    : プロセス情報を扱う仮想ファイルシステム(/proc)
    sysfs     : デバイス情報を扱う仮想ファイルシステム
    tmpfs     : 仮想メモリを扱う仮想ファイルシステム
    devpts    : 疑似端末制御のための仮想ファイルシステム
    usbfs     : USBデバイス監視用
    cramfs    : 組込システム用
  
  マウントオプション
    async     : 入出力同期  // 非同期
    sync      : 入出力同期  // 同期
    atime     : Iノードアクセス時刻更新  // 更新
    relatime  : Iノードアクセス時刻更新  // 一定時間後に更新
    noatime   : Iノードアクセス時刻更新  // 更新しない(ディスクアクセス高速化)
    auto      : コマンド「mount -a」の実行時の動作  // マウント
    noauto    : コマンド「mount -a」の実行時の動作  // マウントしない
    exec      : バイナリ実行を許可
    noexec    : バイナリ実行を禁止
    suid      : SUID, SGID
    nosuid    : SUID, SGID
    ro        : 読み取り専用
    rw        : 書き込み可能
    user      : 一般ユーザーのマウント  // 一般ユーザーマウント許可、アンマウントはマウント操作したユーザーのみ
    users     : 一般ユーザーのマウント  // 一般ユーザーマウント許可、アンマウントもマウント操作したユーザー以外で許可
    nouser    : 一般ユーザーのマウント  // 一般ユーザーマウント禁止
    owner     : その他  // デバイスファイル所有者のマウント許可
    defaults  : その他  // async, auto, dev, exec, nouser, rw, suid
    dev       : その他  // ファイルシステム上のデバイスファイル使用可
    group     : その他  // 条件「ユーザーのグループ = デバイスファイルの所有グループ」が満たされた場合にマウント許可
    uid=UID   : その他  // 全ファイル所有者を指定UIDにする
    gid=GID   : その他  // 全ファイル所有グループを指定GIDにする
  
  DUMP対象
    0         : バックアップ対象外
    1-9       : バックアップ対象
  
  FSCK順序
    0         : チェック対象外
    1-9       : チェック順序(数字順)
  --------------------------------------------------
  
[確認]
  なし
  
  以下の確認に続く
  
================================================================================
[02]
  File System - 02 (設定ファイルの確認)
  
[内容]
  ## 仮想マシン
    HOST : vm12
    IPv4 : 192.168.122.12
    GW   : 192.168.122.1
    DNS  : 192.168.122.1
  
  ## 作業内容
    設定ファイル(/etc/fstab)を確認
  
[確認]
  $ cd $HOME
  $ sudo virsh start vm12 --console
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 仮想マシンの起動
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk (ブロックデバイス表示)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ cat /etc/fstab | grep -vE '^#|^$' (設定ファイルを確認)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[03]
  File System - 03 (UUID)
  
[内容]
  ## 仮想マシン
    HOST : vm12
    IPv4 : 192.168.122.12
    GW   : 192.168.122.1
    DNS  : 192.168.122.1
  
  ## 作業内容
    デバイスのUUIDを確認
  
[確認]
  $ cd $HOME
  $ sudo virsh start vm12 --console
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 仮想マシンの起動
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk (ブロックデバイス表示)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  UUID
  ==================================================
  ・デバイスを一意に識別する文字列
  ・コマンド「tune2fs -U」で変更可能
  ・コマンド「uuidgen」で新規UUIDを作成可能
  ==================================================
  
  vm12$ cd $HOME
  vm12$ sudo blkid (デバイスのUUIDを確認)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[04]
  File System - 04 (カーネルサポートのファイルシステム)
  
[内容]
  ## 仮想マシン
    HOST : vm12
    IPv4 : 192.168.122.12
    GW   : 192.168.122.1
    DNS  : 192.168.122.1
  
  ## 作業内容
    カーネルサポートのファイルシステムを表示
  
[確認]
  $ cd $HOME
  $ sudo virsh start vm12 --console
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 仮想マシンの起動
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ cat /proc/filesystems (カーネルサポートのファイルシステムを表示)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[05]
  File System - 05 (マウント済みのファイルシステム)
  
[内容]
  ## 仮想マシン
    HOST : vm12
    IPv4 : 192.168.122.12
    GW   : 192.168.122.1
    DNS  : 192.168.122.1
  
  ## 作業内容
    マウント済みのファイルシステムを表示
  
[確認]
  $ cd $HOME
  $ sudo virsh start vm12 --console
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 仮想マシンの起動
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ cat /etc/mtab | head -n 3 (マウント済みのファイルシステムを表示)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ cat /proc/mounts | head -n 3 (マウント済みのファイルシステムを表示)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[06]
  File System - 06 (デバイスをマウント)
  
[内容]
  ## コマンド(mount)
    mount -a      // 設定ファイル(/etc/fstab)の全ファイルシステムをマウント
    mount -o XX   // マウントオプション(XX)を指定
    mount -U XX   // UUID(XX)を指定
    mount -n      // 設定ファイル(/etc/mtab)に書き込まない
    mount -r      // mount -o ro と同一
    mount -w      // mount -o rw と同一
    mount -t XX   // ファイルシステム種類(XX)を指定
  
  ## コマンド(umount)
    umount -a     // 設定ファイル(/etc/mtab)の全ファイルシステムをアンマウント
    umount -t XX  // ファイルシステム種類(XX)を指定
  
  ## 作業内容
    指定ファイルシステムでデバイスをマウントする
  
[確認]
  $ cd $HOME
  $ sudo virsh start vm12 --console
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 仮想マシンの起動
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=loop0.img bs=1M count=10 (ディスクイメージ作成)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ losetup -f (使用可能なループバックデバイス名を表示)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 loop0.img (ディスクイメージとループバックデバイスを紐づけ)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkfs.ext4 /dev/loop0 (ループバックデバイスにファイルシステム作成)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mount -o defaults -t ext4 /dev/loop0 /mnt (マウントオプションはデフォルト、ファイルシステム指定でマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ mount | grep loop0 (マウント状況およびマウントオプションを確認)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ cat /etc/mtab | grep loop0 (マウント状況およびマウントオプションを確認)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ cat /proc/mounts | grep loop0 (マウント状況およびマウントオプションを確認)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk (ブロックデバイス確認)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt (ループバックデバイスをアンマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D (ループバックデバイスとディスクイメージの紐づけ解除)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f loop0.img (ディスクイメージ削除)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[07]
  File System - 07 (自動マウント)
  
[内容]
  ## 作業内容
    ディレクトリ「/mnt/auto/dir0」に移動時にデバイス「/dev/loop0」を自動マウントする
  
[確認]
  $ cd $HOME
  $ sudo virsh start vm12 --console
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 仮想マシンの起動
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=loop0.img bs=1M count=10 (ディスクイメージ作成)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ losetup -f (使用可能なループバックデバイス名を表示)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 loop0.img (ディスクイメージとループバックデバイスを紐づけ)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkfs.ext4 /dev/loop0 (ループバックデバイスにファイルシステム作成)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo vi /etc/auto.master (設定ファイルの修正)
  
  コマンドの実行結果
  --------------------------------------------------
  /misc	/etc/auto.misc
  /net  -hosts
  +dir:/etc/auto.master.d
  +auto.master
  /mnt/auto	/etc/auto.dir  // 追加 -> ディレクトリ「/mnt/auto」移動時に設定ファイル「/etc/auto.dir」の内容でマウント
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo vi /etc/auto.dir (設定ファイルの追加)
  
  コマンドの実行結果
  --------------------------------------------------
  dir0  -fstype=ext4,rw  :/dev/loop0
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo systemctl restart autofs (サービス再起動)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk (オートマウント前を確認)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ cd /mnt/auto/dir0 (ディレクトリ移動)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk (オートマウント後を確認)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt/auto/dir0 (アンマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D (ループバックデバイスとディスクイメージの紐づけ解除)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f loop0.img (ディスクイメージ削除)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo vi /etc/auto.master (設定ファイル編集)
  
  コマンドの実行結果
  --------------------------------------------------
  /misc	/etc/auto.misc
  /net  -hosts
  +dir:/etc/auto.master.d
  +auto.master
  # /mnt/auto	/etc/auto.dir  // コメントアウト
  --------------------------------------------------
  
  vm12$ cd /etc
  vm12$ sudo rm auto.dir (追加した設定ファイル削除)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd /mnt
  vm12$ sudo rm -rf auto (マウントポイント削除)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo systemctl restart autofs (サービス再起動)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[08]
  File System - 08 (スワップ領域)
  
[内容]
  ## コマンド(mkswap)
    mkswap XX     // スワップ領域(XX)を作成
    mkswap -c     // 不良ブロックをチェック
    mkswap -L XX  // ラベル(XX)を付与
  
  ## コマンド(swapon)
    swapon XX     // スワップ領域(XX)を有効化
    swapon -a     // 設定ファイル(/etc/fstab)の全スワップ領域を有効化
    swapon -s     // 有効なスワップ領域を表示
  
  ## コマンド(swapoff)
    swapoff XX    // スワップ領域(XX)を無効化
    swapoff -a    // 設定ファイル(/etc/fstab)の全スワップ領域を無効化
  
  ## 作業内容
    指定デバイスをスワップ領域化する
  
[確認]
  $ cd $HOME
  $ sudo virsh start vm12 --console
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 仮想マシンの起動
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=loop0.img bs=1M count=10 (ディスクイメージ作成)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ losetup -f (使用可能なループバックデバイス名を表示)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup /dev/loop0 loop0.img (ディスクイメージとループバックデバイスを紐づけ)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo mkswap -c -L swap0 /dev/loop0 (不良ブロックのチェック、ラベル指定の条件でスワップ領域を作成)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo swapon /dev/loop0 (スワップ領域の有効化)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ swapon -s (有効なスワップ領域を表示)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ cat /proc/swaps (仮想ファイルで確認)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk (ブロックデバイスを表示)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ swapoff /dev/loop0 (スワップ領域の無効化)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo losetup -D (ループバックデバイスとディスクイメージの紐づけ解除)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo rm -f loop0.img (ディスクイメージ削除)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[09]
  File System - 09 (ファイルシステム作成)
  
[内容]
  ## コマンド(mkfs)
    mkswap -c     // 不良ブロックをチェック
    mkswap -t XX  // ファイルシステム(XX)を指定
  
  ## 作業内容
    指定デバイスにファイルシステム作成を行う
  
[確認]
  $ cd $HOME
  $ sudo virsh start vm12 --console
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 仮想マシンの起動
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=loop0.img bs=1M count=10 (ディスクイメージ作成)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ losetup /dev/loop0 loop0.img (ディスクイメージとループバックデバイスを紐づけ)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ mkfs -c -t ext3 /dev/loop0 (不良ブロックのチェック、ファイルシステム作成)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ mount -o defaults -t ext3 /dev/loop0 /mnt (マウント)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ mount | grep loop (マウント状況およびマウントオプションを確認)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ blkid | grep loop (デバイスファイルからファイルシステムを確認)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ sudo umount /mnt (アンマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ losetup -D (ループバックデバイスとディスクイメージの紐づけ解除)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f loop0.img (ディスクイメージ削除)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[10]
  File System - 10 (ISOイメージ作成)
  
[内容]
  ## コマンド(mkisofs)
    mkisofs -b     // ブート可能CD
    mkisofs -o XX  // CD(ISO9660)またはDVD(UDF)用イメージ(XX)を作成
    mkisofs -J     // Microsoft用フォーマット
    mkisofs -r(R)  // ロングネーム用フォーマット
    mkisofs -udf   // DVD
  
  ## 作業内容
    ISOイメージ作成を行う
  
[確認]
  $ cd $HOME
  $ sudo virsh start vm12 --console
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 仮想マシンの起動
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ yum -y install mkisofs (パッケージ追加)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ mkdir HISTORY (ISOイメージ化するディレクトリ作成)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME/HISTORY
  vm12$ vi AAA.txt (ディレクトリ内部のファイル作成)
  
  コマンドの実行結果
  --------------------------------------------------
  1582年 本能寺の変
  1600年 関ヶ原の戦い
  1615年 大坂夏の陣
  --------------------------------------------------
  
  vm12$ cd $HOME/HISTORY
  vm12$ vi BBB.txt (ディレクトリ内部のファイル作成)
  
  コマンドの実行結果
  --------------------------------------------------
  1894年 日清戦争
  1904年 日露戦争
  1914年 第一次世界大戦
  --------------------------------------------------
  
  vm12$ cd $HOME/HISTORY
  vm12$ vi CCC.txt (ディレクトリ内部のファイル作成)
  
  コマンドの実行結果
  --------------------------------------------------
  1923年 関東大震災
  1941年 太平洋戦争の開始
  1945年 太平洋戦争の終了
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ mkisofs -o HISTORY-CDROM.iso -r(-R) HISTORY (CD用イメージ、ロングネーム対応でISOイメージ作成)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ mkisofs -udf -o HISTORY-DVD.iso -r(-R) HISTORY (DVD用イメージ、ロングネーム対応でISOイメージ作成)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd /mnt
  vm12$ sudo mkdir cdrom dvd (マウントポイント作成)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ mount -r -t iso9660 HISTORY-CDROM.iso /mnt/cdrom (CD用イメージを読取専用でマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd /mnt/cdrom
  vm12$ ls -lh (CD用イメージを確認)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ mount -r -t udf HISTORY-DVD.iso /mnt/dvd (DVD用イメージを読取専用でマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd /mnt/dvd
  vm12$ ls -lh (DVD用イメージを確認)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ mount | grep -E 'cdrom|dvd' (マウント状況およびマウントオプションを確認)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ blkid | grep loop (デバイスファイル確認)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ lsblk (ブロックデバイス確認)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ umount /mnt/cdrom /mnt/dvd (アンマウント)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd /mnt
  vm12$ sudo rmdir cdrom dvd (マウントポイント削除)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ rm -f *.iso (ISOイメージファイル削除)
  
  コマンドの実行結果
  --------------------------------------------------
  (出力なし)
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
[11]
  File System - 11 (暗号化ファイルシステム)
  
[内容]
  ## 仮想マシン
    HOST : vm12
    IPv4 : 192.168.122.12
    GW   : 192.168.122.1
    DNS  : 192.168.122.1
  
  ## 作業内容
    暗号化ファイルシステムを作成してみる
  
[確認]
  $ cd $HOME
  $ sudo virsh start vm12 --console
  
  コマンドの実行結果
  --------------------------------------------------
  (省略) -> 仮想マシンの起動
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ yum -y install cryptsetup (パッケージ追加)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  vm12$ cd $HOME
  vm12$ dd if=/dev/zero of=loop0.img bs=1M count=10 (ディスクイメージ作成)
  
  コマンドの実行結果
  --------------------------------------------------
  //
  --------------------------------------------------
  
  ディスクイメージとループバックデバイスを紐づけ
  vm12$ cd $HOME
  vm12$ losetup /dev/loop0 loop0.img
  
  コマンドの実行結果
  --------------------------------------------------
  (出力なし)
  --------------------------------------------------
  
  ループバックデバイスを暗号化デバイスに変換
  vm12$ cd $HOME
  vm12$ cryptsetup create sec0 /dev/loop0
  
  コマンドの実行結果
  --------------------------------------------------
  Enter passphrase for /dev/loop0: (mikotoと入力)
  --------------------------------------------------
  
  暗号化デバイス確認
  vm12$ cd $HOME
  vm12$ lsblk
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                 MAJ:MIN RM  SIZE RO TYPE  MOUNTPOINT
  vdd                  252:48   0   10G  0 disk  
  vdb                  252:16   0   10G  0 disk  
  sr0                   11:0    1 1024M  0 rom   
  loop0                  7:0    0   10M  0 loop  // ループバックデバイス
  └─sec0               253:2    0   10M  0 crypt // 暗号化デバイス
  vdc                  252:32   0   10G  0 disk  
  vda                  252:0    0   40G  0 disk  
  ├─vda2               252:2    0   39G  0 part  
  │ ├─centos_ch14-swap 253:1    0    2G  0 lvm   [SWAP]
  │ └─centos_ch14-root 253:0    0   37G  0 lvm   /
  └─vda1               252:1    0    1G  0 part  /boot
  --------------------------------------------------
  
  暗号化デバイスファイル確認
  vm12$ cd /dev/mapper
  vm12$ ls -lh | grep sec0
  
  コマンドの実行結果
  --------------------------------------------------
  lrwxrwxrwx. 1 root root       7  2月 11 14:06 sec0 -> ../dm-2
  
  // 実体ファイルが別にあり、シンボリックリンクとは初めて知った
  --------------------------------------------------
  
  暗号化デバイスにファイルシステム「ext3」作成
  vm12$ cd $HOME
  vm12$ mkfs -t ext3 /dev/mapper/sec0
  
  コマンドの実行結果
  --------------------------------------------------
  (省略)
  --------------------------------------------------
  
  暗号化デバイスファイルをマウント
  vm12$ cd $HOME
  vm12$ mount -o defaults -t ext3 /dev/mapper/sec0 /mnt
  
  コマンドの実行結果
  --------------------------------------------------
  [ 6501.152056] EXT4-fs (dm-2): mounting ext3 file system using the ext4 subsystem
  [ 6501.175262] EXT4-fs (dm-2): mounted filesystem with ordered data mode. Opts: (null)
  [ 6501.177157] ext3 filesystem being mounted at /mnt supports timestamps until 2038 (0x7fffffff)
  --------------------------------------------------
  
  マウント状況およびマウントオプションを確認
  vm12$ cd $HOME
  vm12$ mount | grep sec0
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/mapper/sec0 on /mnt type ext3 (rw,relatime,seclabel)
  --------------------------------------------------
  
  デバイスファイル確認
  vm12$ cd $HOME
  vm12$ blkid | grep sec0
  
  コマンドの実行結果
  --------------------------------------------------
  /dev/mapper/sec0: UUID="27dc0f38-0dd4-47a8-9fcf-bed339f1dc47" TYPE="ext3"
  --------------------------------------------------
  
  ブロックデバイス確認
  vm12$ cd $HOME
  vm12$ lsblk
  
  コマンドの実行結果
  --------------------------------------------------
  NAME                 MAJ:MIN RM  SIZE RO TYPE  MOUNTPOINT
  vdd                  252:48   0   10G  0 disk  
  vdb                  252:16   0   10G  0 disk  
  sr0                   11:0    1 1024M  0 rom   
  loop0                  7:0    0   10M  0 loop  
  └─sec0               253:2    0   10M  0 crypt /mnt	→ 暗号化デバイスがマウント
  vdc                  252:32   0   10G  0 disk  
  vda                  252:0    0   40G  0 disk  
  ├─vda2               252:2    0   39G  0 part  
  │ ├─centos_ch14-swap 253:1    0    2G  0 lvm   [SWAP]
  │ └─centos_ch14-root 253:0    0   37G  0 lvm   /
  └─vda1               252:1    0    1G  0 part  /boot
  --------------------------------------------------
  
  ブロックデバイス確認
  vm12$ cd $HOME
  vm12$ df -lm
  
  コマンドの実行結果
  --------------------------------------------------
  ファイルシス                        1M-ブロック   使用   使用可  使用% マウント位置
  devtmpfs                             466     0    466    0% /dev
  tmpfs                                490     0    490    0% /dev/shm
  tmpfs                                490     1    490    1% /run
  tmpfs                                490     0    490    0% /sys/fs/cgroup
  /dev/mapper/centos_ch14-root       37862 10022  27840   27% /
  /dev/vda1                           1014   236    779   24% /boot
  tmpfs                                 98     0     98    0% /run/user/0
  /dev/mapper/sec0                       9     1      9    2% /mnt → 暗号化デバイスがマウント
  --------------------------------------------------
  
  暗号化デバイスをアンマウント
  vm12$ cd $HOME
  vm12$ umount /mnt
  
  コマンドの実行結果
  --------------------------------------------------
  (出力なし)
  --------------------------------------------------
  
  暗号化デバイスからループバックデバイスに戻す
  vm12$ cd $HOME
  vm12$ cryptsetup remove sec0
  
  コマンドの実行結果
  --------------------------------------------------
  (出力なし)
  --------------------------------------------------
  
  暗号化デバイスファイル確認
  vm12$ cd /dev/mapper
  vm12$ ls -lh | grep sec0
  
  コマンドの実行結果
  --------------------------------------------------
  (出力なし)
  
  // シンボリックリンクが削除されることで紐づけが解除された
  --------------------------------------------------
  
  ループバックデバイスとディスクイメージの紐づけ解除
  vm12$ cd $HOME
  vm12$ losetup -D
  
  コマンドの実行結果
  --------------------------------------------------
  (出力なし)
  --------------------------------------------------
  
  ディスクイメージ削除
  vm12$ cd $HOME
  vm12$ rm -f loop0.img
  
  コマンドの実行結果
  --------------------------------------------------
  (出力なし)
  --------------------------------------------------
  
  以下の確認に続く
  
================================================================================
